var pa=(a,t)=>()=>(t||a((t={exports:{}}).exports,t),t.exports);var ml=pa((Tl,fo)=>{(function(){const t=document.createElement("link").relList;if(t&&t.supports&&t.supports("modulepreload"))return;for(const e of document.querySelectorAll('link[rel="modulepreload"]'))o(e);new MutationObserver(e=>{for(const l of e)if(l.type==="childList")for(const h of l.addedNodes)h.tagName==="LINK"&&h.rel==="modulepreload"&&o(h)}).observe(document,{childList:!0,subtree:!0});function n(e){const l={};return e.integrity&&(l.integrity=e.integrity),e.referrerPolicy&&(l.referrerPolicy=e.referrerPolicy),e.crossOrigin==="use-credentials"?l.credentials="include":e.crossOrigin==="anonymous"?l.credentials="omit":l.credentials="same-origin",l}function o(e){if(e.ep)return;e.ep=!0;const l=n(e);fetch(e.href,l)}})();let tn=null,vn=!1,On=!1,ho=null,Vt=[],zn=[],Xt=[],ln=[];const ge=5,ii=3,ai=2,ci=-4,si=1.5,li=10;async function ri(a=!1){try{if(On&&ho&&await ho,!tn||a){if(Vt.length===0){tn=null,vn=!1;return}if(tn)try{tn.dispose()}catch{}tn=tf.sequential(),tn.add(tf.layers.dense({inputShape:[Vt.length],units:Math.max(16,Vt.length),activation:"relu",kernelRegularizer:tf.regularizers.l2(.001)})),tn.add(tf.layers.dense({units:8,activation:"relu",kernelRegularizer:tf.regularizers.l2(.001)})),tn.add(tf.layers.dense({units:3,activation:"softmax"}));const t=tf.train.adam(.001);tn.compile({optimizer:t,loss:"categoricalCrossentropy",metrics:["accuracy"]}),vn=!1}}catch{vn=!1}}function La(a,t){a&&a.length>0&&(Xt.push([...a]),Xt.length>ge&&Xt.shift()),t&&t.length>0&&(ln.push([...t]),ln.length>ge&&ln.shift());try{localStorage.setItem("modelPreviousTopics",JSON.stringify(Xt)),localStorage.setItem("modelPreviousHashtags",JSON.stringify(ln))}catch(n){console.warn("Could not save model results to localStorage",n)}}async function te(a,t=!0){if(On||Vt.length===0)return;const n=a;if(n.length<li)return;let o;try{await ri(!0),On=!0,ho=new Promise(r=>o=r);const e=n.slice(-100),l=[],h=[];for(const r of e){if(!r.topics||!Array.isArray(r.topics))continue;let A=0;if(r.liked&&(A+=ii),r.interested&&(A+=ai),r.not_interested&&(A+=ci),r.commented&&(A+=si),!r.liked&&!r.interested&&!r.not_interested&&!r.commented){const B=r.timeSpentMs||0,b=r.duration||1e4,D=(B/b-.5)*2;A+=D}let _;A<=-1.5?_=0:A>=1.5?_=2:_=1;const s=Vt.map(B=>(r.topics||[]).includes(B)?1:0),w=[0,0,0];w[_]=1,l.push(s),h.push(w)}if(t&&Xt.length>0)for(const r of Xt){const A=r.map(_=>_.name);for(const _ of r.filter(s=>s.weight>.3)){const s=Vt.map(B=>B===_.name?1:A.includes(B)?.5:0),w=[0,0,0];w[2]=_.weight>.6?1:.8,l.push(s),h.push(w)}}if(l.length>0&&l[0].length>0){const r=tf.tensor2d(l),A=tf.tensor2d(h);try{await tn.fit(r,A,{epochs:25,batchSize:8,validationSplit:.2}),vn=!0}finally{r.dispose(),A.dispose()}}}catch{vn=!1}finally{On=!1,o&&o(),ho=null}}async function di(a,t=!0){const n=a;if(Vt.length===0)return{topics:[],hashtags:[]};if(n.length<li)return{topics:[],hashtags:[]};let o;if(!vn)o=ba(n);else{await ri(!1);const e=Vt.map((F,q)=>Vt.map((x,it)=>q===it?1:0)),l=tf.tensor2d(e),h=tn.predict(l).arraySync();l.dispose();const r=Vt.map((F,q)=>({name:F,weight:h[q][2]-h[q][0]}));r.sort((F,q)=>q.weight-F.weight);const A=ue(r,.1,"weight"),_=r.slice(0,A).filter(F=>F.weight>.1),s=zn.map((F,q)=>Vt.map(x=>n.some(it=>(it.hashtags||[]).includes(F)&&(it.topics||[]).includes(x))?1:0)),w=tf.tensor2d(s),B=tn.predict(w).arraySync();w.dispose();const b=zn.map((F,q)=>({name:F,weight:B[q][2]-B[q][0]}));b.sort((F,q)=>q.weight-F.weight);const k=ue(b,.1,"weight"),D=b.slice(0,k).filter(F=>F.weight>.1);o={topics:_,hashtags:D}}return t&&Xt.length>0&&(o=Aa(o)),La(o.topics,o.hashtags),o}function Aa(a){if(Xt.length===0)return a;const t=[...a.topics],n=[...a.hashtags],o=new Map(t.map(h=>[h.name,h])),e=new Map(n.map(h=>[h.name,h])),l=Array(Xt.length).fill(0).map((h,r)=>.8**(Xt.length-r-1));for(let h=0;h<Xt.length;h++){const r=l[h],A=Xt[h];for(const _ of A)if(o.has(_.name)){const s=o.get(_.name);s.weight=s.weight*.7+_.weight*.3*r}else _.weight>.3&&(t.push({name:_.name,weight:_.weight*.4*r}),o.set(_.name,t[t.length-1]))}if(ln.length>0){const h=Array(ln.length).fill(0).map((r,A)=>.8**(ln.length-A-1));for(let r=0;r<ln.length;r++){const A=h[r],_=ln[r];for(const s of _)if(e.has(s.name)){const w=e.get(s.name);w.weight=w.weight*.7+s.weight*.3*A}else s.weight>.3&&(n.push({name:s.name,weight:s.weight*.4*A}),e.set(s.name,n[n.length-1]))}}return t.sort((h,r)=>r.weight-h.weight),n.sort((h,r)=>r.weight-h.weight),{topics:t.filter(h=>h.weight>.1),hashtags:n.filter(h=>h.weight>.1)}}function ba(a){const t={},n={};Vt.forEach(r=>{t[r]={positive:0,negative:0,count:0}}),zn.forEach(r=>{n[r]={positive:0,negative:0,count:0}});for(const r of a){let A=0;r.liked&&(A+=ii),r.interested&&(A+=ai),r.not_interested&&(A+=ci),r.commented&&(A+=si);const _=r.timeSpentMs/(r.duration||1e4);_>.7&&(A+=1),_<.2&&(A-=1),(r.topics||[]).forEach(s=>{t[s]&&(A>0&&(t[s].positive+=A),A<0&&(t[s].negative+=Math.abs(A)),t[s].count++)}),(r.hashtags||[]).forEach(s=>{n[s]&&(A>0&&(n[s].positive+=A),A<0&&(n[s].negative+=Math.abs(A)),n[s].count++)})}const o=Object.entries(t).map(([r,A])=>{const _=A.count>0?(A.positive-A.negative)/A.count:0,s=A.positive-A.negative;return{name:r,weight:_*.6+s/Math.max(1,a.length)*.4}}).filter(r=>r.weight!==0).sort((r,A)=>A.weight-r.weight),e=Object.entries(n).map(([r,A])=>{const _=A.count>0?(A.positive-A.negative)/A.count:0,s=A.positive-A.negative;return{name:r,weight:_*.6+s/Math.max(1,a.length)*.4}}).filter(r=>r.weight!==0).sort((r,A)=>A.weight-r.weight),l=o.filter(r=>r.weight>.1).slice(0,5),h=e.filter(r=>r.weight>.1).slice(0,5);return{topics:l,hashtags:h}}function ue(a,t=.1,n="score"){if(a.length<=3)return a.length;let o=a.length,e=0,l=Math.max(.1,a[0][n]*.25);for(let h=0;h<Math.min(a.length-1,10);h++){const r=a[h][n]-a[h+1][n],A=r/a[h][n];if((r>e&&r>l||A>.4)&&(e=r,o=h+1,A>.6))break}return o===a.length?Math.min(5,a.filter(h=>h[n]>t).length):o}const Ia=[0,1,2,2,3,3,3,3,4,4,4,4,4,4,4,4];function Io(a,t){if(!t||t==10)return BigInt(a);if(t==16)return a.slice(0,2)=="0x"?BigInt(a):BigInt("0x"+a)}const Ut=Io;function ya(a,t){let n=BigInt(0);t=BigInt(t);for(let o=0;o<a.length;o++)n=n*t+BigInt(a[o]);return n}function no(a){const t=a.toString(16);return(t.length-1)*4+Ia[parseInt(t[0],16)]}function _i(a){return BigInt(a)<BigInt(0)}function gi(a){return!a}function po(a,t){return BigInt(a)<<BigInt(t)}function Tn(a,t){return BigInt(a)>>BigInt(t)}const Ca=po,ma=Tn;function ne(a){return(BigInt(a)&BigInt(1))==BigInt(1)}function wa(a){let t=BigInt(a);const n=[];for(;t;){if(t&BigInt(1)){const o=2-Number(t%BigInt(4));n.push(o),t=t-BigInt(o)}else n.push(0);t=t>>BigInt(1)}return n}function ui(a){let t=BigInt(a);const n=[];for(;t;)t&BigInt(1)?n.push(1):n.push(0),t=t>>BigInt(1);return n}function fi(a){if(a>BigInt(Number.MAX_SAFE_INTEGER))throw new Error("Number too big");return Number(a)}function Ba(a,t){const n=[];let o=BigInt(a);for(t=BigInt(t);o;)n.unshift(Number(o%t)),o=o/t;return n}function oe(a,t){return BigInt(a)+BigInt(t)}function fn(a,t){return BigInt(a)-BigInt(t)}function hi(a){return-BigInt(a)}function pi(a,t){return BigInt(a)*BigInt(t)}function Ea(a){return BigInt(a)*BigInt(a)}function oo(a,t){return BigInt(a)**BigInt(t)}function Fa(a,t){return BigInt(a)**BigInt(t)}function xa(a){return BigInt(a)>=0?BigInt(a):-BigInt(a)}function Dn(a,t){return BigInt(a)/BigInt(t)}function sn(a,t){return BigInt(a)%BigInt(t)}function Fn(a,t){return BigInt(a)==BigInt(t)}function Sa(a,t){return BigInt(a)!=BigInt(t)}function va(a,t){return BigInt(a)<BigInt(t)}function Go(a,t){return BigInt(a)>BigInt(t)}function Oa(a,t){return BigInt(a)<=BigInt(t)}function Li(a,t){return BigInt(a)>=BigInt(t)}function ee(a,t){return BigInt(a)&BigInt(t)}function Pa(a,t){return BigInt(a)|BigInt(t)}function Qa(a,t){return BigInt(a)^BigInt(t)}function Ma(a,t){return BigInt(a)&&BigInt(t)}function qa(a,t){return BigInt(a)||BigInt(t)}function Ua(a){return!BigInt(a)}function Xn(a,t,n,o){const e="0000000"+n.toString(16),l=new Uint32Array(a.buffer,a.byteOffset+t,o/4),h=((e.length-7)*4-1>>5)+1;for(let r=0;r<h;r++)l[r]=parseInt(e.substring(e.length-8*r-8,e.length-8*r),16);for(let r=h;r<l.length;r++)l[r]=0;for(let r=l.length*4;r<o;r++)a[r]=fi(ee(Tn(n,r*8),255))}function Ai(a,t,n,o){const e="0000000"+n.toString(16),l=new DataView(a.buffer,a.byteOffset+t,o),h=((e.length-7)*4-1>>5)+1;for(let r=0;r<h;r++)l.setUint32(o-r*4-4,parseInt(e.substring(e.length-8*r-8,e.length-8*r),16),!1);for(let r=0;r<o/4-h;r++)l[r]=0}function to(a,t,n){n=n||a.byteLength,t=t||0;const o=new Uint32Array(a.buffer,a.byteOffset+t,n/4),e=new Array(n/4);return o.forEach((l,h)=>e[e.length-h-1]=l.toString(16).padStart(8,"0")),Io(e.join(""),16)}function bi(a,t,n){n=n||a.byteLength,t=t||0;const o=new DataView(a.buffer,a.byteOffset+t,n),e=new Array(n/4);for(let l=0;l<n/4;l++)e[l]=o.getUint32(l*4,!1).toString(16).padStart(8,"0");return Io(e.join(""),16)}function Ii(a,t){return a.toString(t)}function Gn(a){const t=new Uint8Array(Math.floor((no(a)-1)/8)+1);return Xn(t,0,a,t.byteLength),t}const yi=Ut(0),xn=Ut(1);var za=Object.freeze({__proto__:null,abs:xa,add:oe,band:ee,bitLength:no,bits:ui,bor:Pa,bxor:Qa,div:Dn,e:Ut,eq:Fn,exp:Fa,fromArray:ya,fromRprBE:bi,fromRprLE:to,fromString:Io,geq:Li,gt:Go,isNegative:_i,isOdd:ne,isZero:gi,land:Ma,leq:Oa,lnot:Ua,lor:qa,lt:va,mod:sn,mul:pi,naf:wa,neg:hi,neq:Sa,one:xn,pow:oo,shiftLeft:po,shiftRight:Tn,shl:Ca,shr:ma,square:Ea,sub:fn,toArray:Ba,toLEBuff:Gn,toNumber:fi,toRprBE:Ai,toRprLE:Xn,toString:Ii,zero:yi});function fe(a,t,n){if(gi(n))return a.one;const o=ui(n);if(o.length==0)return a.one;let e=t;for(let l=o.length-2;l>=0;l--)e=a.square(e),o[l]&&(e=a.mul(e,t));return e}function Ta(a){if(a.m%2==1)if(Fn(sn(a.p,4),1))if(Fn(sn(a.p,8),1))if(Fn(sn(a.p,16),1))ka(a);else if(Fn(sn(a.p,16),9))Da(a);else throw new Error("Field withot sqrt");else if(Fn(sn(a.p,8),5))Ga(a);else throw new Error("Field withot sqrt");else Fn(sn(a.p,4),3)&&Ra(a);else{const t=sn(oo(a.p,a.m/2),4);t==1?Na(a):t==3?Ka(a):Ha(a)}}function ka(a){for(a.sqrt_q=oo(a.p,a.m),a.sqrt_s=0,a.sqrt_t=fn(a.sqrt_q,1);!ne(a.sqrt_t);)a.sqrt_s=a.sqrt_s+1,a.sqrt_t=Dn(a.sqrt_t,2);let t=a.one;for(;a.eq(t,a.one);){const n=a.random();a.sqrt_z=a.pow(n,a.sqrt_t),t=a.pow(a.sqrt_z,2**(a.sqrt_s-1))}a.sqrt_tm1d2=Dn(fn(a.sqrt_t,1),2),a.sqrt=function(n){const o=this;if(o.isZero(n))return o.zero;let e=o.pow(n,o.sqrt_tm1d2);const l=o.pow(o.mul(o.square(e),n),2**(o.sqrt_s-1));if(o.eq(l,o.negone))return null;let h=o.sqrt_s,r=o.mul(n,e),A=o.mul(r,e),_=o.sqrt_z;for(;!o.eq(A,o.one);){let s=o.square(A),w=1;for(;!o.eq(s,o.one);)s=o.square(s),w++;e=_;for(let B=0;B<h-w-1;B++)e=o.square(e);_=o.square(e),A=o.mul(A,_),r=o.mul(r,e),h=w}return o.geq(r,o.zero)?r:o.neg(r)}}function Da(a){a.sqrt=function(){throw new Error("Sqrt alg 4 not implemented")}}function Ga(a){a.sqrt=function(){throw new Error("Sqrt alg 3 not implemented")}}function Ra(a){a.sqrt_q=oo(a.p,a.m),a.sqrt_e1=Dn(fn(a.sqrt_q,3),4),a.sqrt=function(t){if(this.isZero(t))return this.zero;const n=this.pow(t,this.sqrt_e1),o=this.mul(this.square(n),t);if(this.eq(o,this.negone))return null;const e=this.mul(n,t);return a.geq(e,a.zero)?e:a.neg(e)}}function Na(a){a.sqrt=function(){throw new Error("Sqrt alg 10 not implemented")}}function Ka(a){a.sqrt_q=oo(a.p,a.m/2),a.sqrt_e34=Dn(fn(a.sqrt_q,3),4),a.sqrt_e12=Dn(fn(a.sqrt_q,1),2),a.frobenius=function(t,n){return t%2==1?a.conjugate(n):n},a.sqrt=function(t){const n=this,o=n.pow(t,n.sqrt_e34),e=n.mul(n.square(o),t),l=n.mul(n.frobenius(1,e),e);if(n.eq(l,n.negone))return null;const h=n.mul(o,t);let r;if(n.eq(e,n.negone))r=n.mul(h,[n.F.zero,n.F.one]);else{const A=n.pow(n.add(n.one,e),n.sqrt_e12);r=n.mul(A,h)}return n.geq(r,n.zero)?r:n.neg(r)}}function Ha(a){a.sqrt=function(){throw new Error("Sqrt alg 8 not implemented")}}function yn(a,t,n,o,e){a[t]=a[t]+a[n]>>>0,a[e]=(a[e]^a[t])>>>0,a[e]=(a[e]<<16|a[e]>>>16&65535)>>>0,a[o]=a[o]+a[e]>>>0,a[n]=(a[n]^a[o])>>>0,a[n]=(a[n]<<12|a[n]>>>20&4095)>>>0,a[t]=a[t]+a[n]>>>0,a[e]=(a[e]^a[t])>>>0,a[e]=(a[e]<<8|a[e]>>>24&255)>>>0,a[o]=a[o]+a[e]>>>0,a[n]=(a[n]^a[o])>>>0,a[n]=(a[n]<<7|a[n]>>>25&127)>>>0}function Va(a){yn(a,0,4,8,12),yn(a,1,5,9,13),yn(a,2,6,10,14),yn(a,3,7,11,15),yn(a,0,5,10,15),yn(a,1,6,11,12),yn(a,2,7,8,13),yn(a,3,4,9,14)}class $a{constructor(t){t=t||[0,0,0,0,0,0,0,0],this.state=[1634760805,857760878,2036477234,1797285236,t[0],t[1],t[2],t[3],t[4],t[5],t[6],t[7],0,0,0,0],this.idx=16,this.buff=new Array(16)}nextU32(){return this.idx==16&&this.update(),this.buff[this.idx++]}nextU64(){return oe(pi(this.nextU32(),4294967296),this.nextU32())}nextBool(){return(this.nextU32()&1)==1}update(){for(let t=0;t<16;t++)this.buff[t]=this.state[t];for(let t=0;t<10;t++)Va(this.buff);for(let t=0;t<16;t++)this.buff[t]=this.buff[t]+this.state[t]>>>0;this.idx=0,this.state[12]=this.state[12]+1>>>0,this.state[12]==0&&(this.state[13]=this.state[13]+1>>>0,this.state[13]==0&&(this.state[14]=this.state[14]+1>>>0,this.state[14]==0&&(this.state[15]=this.state[15]+1>>>0)))}}function Ci(a){let t=new Uint8Array(a);if(typeof globalThis.crypto<"u")globalThis.crypto.getRandomValues(t);else for(let n=0;n<a;n++)t[n]=Math.random()*4294967296>>>0;return t}function ja(){const a=Ci(32),t=new Uint32Array(a.buffer),n=[];for(let o=0;o<8;o++)n.push(t[o]);return n}let so=null;function ie(){return so||(so=new $a(ja()),so)}class Ya{constructor(t,n,o){this.F=n,this.G=t,this.opMulGF=o;let e=n.sqrt_t||n.t,l=n.sqrt_s||n.s,h=n.one;for(;n.eq(n.pow(h,n.half),n.one);)h=n.add(h,n.one);this.w=new Array(l+1),this.wi=new Array(l+1),this.w[l]=this.F.pow(h,e),this.wi[l]=this.F.inv(this.w[l]);let r=l-1;for(;r>=0;)this.w[r]=this.F.square(this.w[r+1]),this.wi[r]=this.F.square(this.wi[r+1]),r--;this.roots=[],this._setRoots(Math.min(l,15))}_setRoots(t){for(let n=t;n>=0&&!this.roots[n];n--){let o=this.F.one;const e=1<<n,l=new Array(e);for(let h=0;h<e;h++)l[h]=o,o=this.F.mul(o,this.w[n]);this.roots[n]=l}}fft(t){if(t.length<=1)return t;const n=he(t.length-1)+1;this._setRoots(n);const o=1<<n;if(t.length!=o)throw new Error("Size must be multiple of 2");return Lo(this,t,n,0,1)}ifft(t){if(t.length<=1)return t;const n=he(t.length-1)+1;this._setRoots(n);const o=1<<n;if(t.length!=o)throw new Error("Size must be multiple of 2");const e=Lo(this,t,n,0,1),l=this.F.inv(this.F.mulScalar(this.F.one,o)),h=new Array(o);for(let r=0;r<o;r++)h[r]=this.opMulGF(e[(o-r)%o],l);return h}}function he(a){return(a&4294901760?(a&=4294901760,16):0)|(a&4278255360?(a&=4278255360,8):0)|(a&4042322160?(a&=4042322160,4):0)|(a&3435973836?(a&=3435973836,2):0)|(a&2863311530)!==0}function Lo(a,t,n,o,e){const l=1<<n;if(l==1)return[t[o]];if(l==2)return[a.G.add(t[o],t[o+e]),a.G.sub(t[o],t[o+e])];const h=l>>1,r=Lo(a,t,n-1,o,e*2),A=Lo(a,t,n-1,o+e,e*2),_=new Array(l);for(let s=0;s<h;s++)_[s]=a.G.add(r[s],a.opMulGF(A[s],a.roots[n][s])),_[s+h]=a.G.sub(r[s],a.opMulGF(A[s],a.roots[n][s]));return _}class Za{constructor(t){this.type="F1",this.one=BigInt(1),this.zero=BigInt(0),this.p=BigInt(t),this.m=1,this.negone=this.p-this.one,this.two=BigInt(2),this.half=this.p>>this.one,this.bitLength=no(this.p),this.mask=(this.one<<BigInt(this.bitLength))-this.one,this.n64=Math.floor((this.bitLength-1)/64)+1,this.n32=this.n64*2,this.n8=this.n64*8,this.R=this.e(this.one<<BigInt(this.n64*64)),this.Ri=this.inv(this.R);const n=this.negone>>this.one;this.nqr=this.two;let o=this.pow(this.nqr,n);for(;!this.eq(o,this.negone);)this.nqr=this.nqr+this.one,o=this.pow(this.nqr,n);for(this.s=0,this.t=this.negone;(this.t&this.one)==this.zero;)this.s=this.s+1,this.t=this.t>>this.one;this.nqr_to_t=this.pow(this.nqr,this.t),Ta(this),this.FFT=new Ya(this,this,this.mul.bind(this)),this.fft=this.FFT.fft.bind(this.FFT),this.ifft=this.FFT.ifft.bind(this.FFT),this.w=this.FFT.w,this.wi=this.FFT.wi,this.shift=this.square(this.nqr),this.k=this.exp(this.nqr,2**this.s)}e(t,n){let o;if(n?n==16&&(o=BigInt("0x"+t)):o=BigInt(t),o<0){let e=-o;return e>=this.p&&(e=e%this.p),this.p-e}else return o>=this.p?o%this.p:o}add(t,n){const o=t+n;return o>=this.p?o-this.p:o}sub(t,n){return t>=n?t-n:this.p-n+t}neg(t){return t&&this.p-t}mul(t,n){return t*n%this.p}mulScalar(t,n){return t*this.e(n)%this.p}square(t){return t*t%this.p}eq(t,n){return t==n}neq(t,n){return t!=n}lt(t,n){const o=t>this.half?t-this.p:t,e=n>this.half?n-this.p:n;return o<e}gt(t,n){const o=t>this.half?t-this.p:t,e=n>this.half?n-this.p:n;return o>e}leq(t,n){const o=t>this.half?t-this.p:t,e=n>this.half?n-this.p:n;return o<=e}geq(t,n){const o=t>this.half?t-this.p:t,e=n>this.half?n-this.p:n;return o>=e}div(t,n){return this.mul(t,this.inv(n))}idiv(t,n){if(!n)throw new Error("Division by zero");return t/n}inv(t){if(!t)throw new Error("Division by zero");let n=this.zero,o=this.p,e=this.one,l=t%this.p;for(;l;){let h=o/l;[n,e]=[e,n-h*e],[o,l]=[l,o-h*l]}return n<this.zero&&(n+=this.p),n}mod(t,n){return t%n}pow(t,n){return fe(this,t,n)}exp(t,n){return fe(this,t,n)}band(t,n){const o=t&n&this.mask;return o>=this.p?o-this.p:o}bor(t,n){const o=(t|n)&this.mask;return o>=this.p?o-this.p:o}bxor(t,n){const o=(t^n)&this.mask;return o>=this.p?o-this.p:o}bnot(t){const n=t^this.mask;return n>=this.p?n-this.p:n}shl(t,n){if(Number(n)<this.bitLength){const o=t<<n&this.mask;return o>=this.p?o-this.p:o}else{const o=this.p-n;return Number(o)<this.bitLength?t>>o:this.zero}}shr(t,n){if(Number(n)<this.bitLength)return t>>n;{const o=this.p-n;if(Number(o)<this.bitLength){const e=t<<o&this.mask;return e>=this.p?e-this.p:e}else return 0}}land(t,n){return t&&n?this.one:this.zero}lor(t,n){return t||n?this.one:this.zero}lnot(t){return t?this.zero:this.one}sqrt_old(t){if(t==this.zero)return this.zero;if(this.pow(t,this.negone>>this.one)!=this.one)return null;let o=this.s,e=this.nqr_to_t,l=this.pow(t,this.t),h=this.pow(t,this.add(this.t,this.one)>>this.one);for(;l!=this.one;){let r=this.square(l),A=1;for(;r!=this.one;)A++,r=this.square(r);let _=e;for(let s=0;s<o-A-1;s++)_=this.square(_);o=A,e=this.square(_),l=this.mul(l,e),h=this.mul(h,_)}return h>this.p>>this.one&&(h=this.neg(h)),h}normalize(t,n){if(t=BigInt(t,n),t<0){let o=-t;return o>=this.p&&(o=o%this.p),this.p-o}else return t>=this.p?t%this.p:t}random(){const t=this.bitLength*2/8;let n=this.zero;for(let o=0;o<t;o++)n=(n<<BigInt(8))+BigInt(Ci(1)[0]);return n%this.p}toString(t,n){n=n||10;let o;return t>this.half&&n==10?o="-"+(this.p-t).toString(n):o=t.toString(n),o}isZero(t){return t==this.zero}fromRng(t){let n;do{n=this.zero;for(let o=0;o<this.n64;o++)n+=t.nextU64()<<BigInt(64*o);n&=this.mask}while(n>=this.p);return n=n*this.Ri%this.p,n}fft(t){return this.FFT.fft(t)}ifft(t){return this.FFT.ifft(t)}toRprLE(t,n,o){Xn(t,n,o,this.n64*8)}toRprBE(t,n,o){Ai(t,n,o,this.n64*8)}toRprBEM(t,n,o){return this.toRprBE(t,n,this.mul(this.R,o))}toRprLEM(t,n,o){return this.toRprLE(t,n,this.mul(this.R,o))}fromRprLE(t,n){return to(t,n,this.n8)}fromRprBE(t,n){return bi(t,n,this.n8)}fromRprLEM(t,n){return this.mul(this.fromRprLE(t,n),this.Ri)}fromRprBEM(t,n){return this.mul(this.fromRprBE(t,n),this.Ri)}toObject(t){return t}}var wn={};wn.bigInt2BytesLE=function(t,n){const o=Array(n);let e=BigInt(t);for(let l=0;l<n;l++)o[l]=Number(e&0xFFn),e=e>>8n;return o};wn.bigInt2U32LE=function(t,n){const o=Array(n);let e=BigInt(t);for(let l=0;l<n;l++)o[l]=Number(e&0xFFFFFFFFn),e=e>>32n;return o};wn.isOcamNum=function(a){return!(!Array.isArray(a)||a.length!=3||typeof a[0]!="number"||typeof a[1]!="number"||!Array.isArray(a[2]))};var Wa=function(t,n,o){const e=o||"int";if(t.modules[e])return e;t.modules[e]={};const l=n*2,h=n*8;function r(){const E=t.addFunction(e+"_copy");E.addParam("px","i32"),E.addParam("pr","i32");const u=E.getCodeBuilder();for(let L=0;L<n;L++)E.addCode(u.i64_store(u.getLocal("pr"),L*8,u.i64_load(u.getLocal("px"),L*8)))}function A(){const E=t.addFunction(e+"_zero");E.addParam("pr","i32");const u=E.getCodeBuilder();for(let L=0;L<n;L++)E.addCode(u.i64_store(u.getLocal("pr"),L*8,u.i64_const(0)))}function _(){const E=t.addFunction(e+"_one");E.addParam("pr","i32");const u=E.getCodeBuilder();E.addCode(u.i64_store(u.getLocal("pr"),0,u.i64_const(1)));for(let L=1;L<n;L++)E.addCode(u.i64_store(u.getLocal("pr"),L*8,u.i64_const(0)))}function s(){const E=t.addFunction(e+"_isZero");E.addParam("px","i32"),E.setReturnType("i32");const u=E.getCodeBuilder();function L(V){return V==0?u.ret(u.i64_eqz(u.i64_load(u.getLocal("px")))):u.if(u.i64_eqz(u.i64_load(u.getLocal("px"),V*8)),L(V-1),u.ret(u.i32_const(0)))}E.addCode(L(n-1)),E.addCode(u.ret(u.i32_const(0)))}function w(){const E=t.addFunction(e+"_eq");E.addParam("px","i32"),E.addParam("py","i32"),E.setReturnType("i32");const u=E.getCodeBuilder();function L(V){return V==0?u.ret(u.i64_eq(u.i64_load(u.getLocal("px")),u.i64_load(u.getLocal("py")))):u.if(u.i64_eq(u.i64_load(u.getLocal("px"),V*8),u.i64_load(u.getLocal("py"),V*8)),L(V-1),u.ret(u.i32_const(0)))}E.addCode(L(n-1)),E.addCode(u.ret(u.i32_const(0)))}function B(){const E=t.addFunction(e+"_gte");E.addParam("px","i32"),E.addParam("py","i32"),E.setReturnType("i32");const u=E.getCodeBuilder();function L(V){return V==0?u.ret(u.i64_ge_u(u.i64_load(u.getLocal("px")),u.i64_load(u.getLocal("py")))):u.if(u.i64_lt_u(u.i64_load(u.getLocal("px"),V*8),u.i64_load(u.getLocal("py"),V*8)),u.ret(u.i32_const(0)),u.if(u.i64_gt_u(u.i64_load(u.getLocal("px"),V*8),u.i64_load(u.getLocal("py"),V*8)),u.ret(u.i32_const(1)),L(V-1)))}E.addCode(L(n-1)),E.addCode(u.ret(u.i32_const(0)))}function b(){const E=t.addFunction(e+"_add");E.addParam("x","i32"),E.addParam("y","i32"),E.addParam("r","i32"),E.setReturnType("i32"),E.addLocal("c","i64");const u=E.getCodeBuilder();E.addCode(u.setLocal("c",u.i64_add(u.i64_load32_u(u.getLocal("x")),u.i64_load32_u(u.getLocal("y"))))),E.addCode(u.i64_store32(u.getLocal("r"),u.getLocal("c")));for(let L=1;L<l;L++)E.addCode(u.setLocal("c",u.i64_add(u.i64_add(u.i64_load32_u(u.getLocal("x"),4*L),u.i64_load32_u(u.getLocal("y"),4*L)),u.i64_shr_u(u.getLocal("c"),u.i64_const(32))))),E.addCode(u.i64_store32(u.getLocal("r"),L*4,u.getLocal("c")));E.addCode(u.i32_wrap_i64(u.i64_shr_u(u.getLocal("c"),u.i64_const(32))))}function k(){const E=t.addFunction(e+"_sub");E.addParam("x","i32"),E.addParam("y","i32"),E.addParam("r","i32"),E.setReturnType("i32"),E.addLocal("c","i64");const u=E.getCodeBuilder();E.addCode(u.setLocal("c",u.i64_sub(u.i64_load32_u(u.getLocal("x")),u.i64_load32_u(u.getLocal("y"))))),E.addCode(u.i64_store32(u.getLocal("r"),u.i64_and(u.getLocal("c"),u.i64_const("0xFFFFFFFF"))));for(let L=1;L<l;L++)E.addCode(u.setLocal("c",u.i64_add(u.i64_sub(u.i64_load32_u(u.getLocal("x"),4*L),u.i64_load32_u(u.getLocal("y"),4*L)),u.i64_shr_s(u.getLocal("c"),u.i64_const(32))))),E.addCode(u.i64_store32(u.getLocal("r"),L*4,u.i64_and(u.getLocal("c"),u.i64_const("0xFFFFFFFF"))));E.addCode(u.i32_wrap_i64(u.i64_shr_s(u.getLocal("c"),u.i64_const(32))))}function D(){const E=t.addFunction(e+"_mul");E.addParam("x","i32"),E.addParam("y","i32"),E.addParam("r","i32"),E.addLocal("c0","i64"),E.addLocal("c1","i64");for(let I=0;I<l;I++)E.addLocal("x"+I,"i64"),E.addLocal("y"+I,"i64");const u=E.getCodeBuilder(),L=[],V=[];function j(I,v){let T,ot;return L[I]?T=u.getLocal("x"+I):(T=u.teeLocal("x"+I,u.i64_load32_u(u.getLocal("x"),I*4)),L[I]=!0),V[v]?ot=u.getLocal("y"+v):(ot=u.teeLocal("y"+v,u.i64_load32_u(u.getLocal("y"),v*4)),V[v]=!0),u.i64_mul(T,ot)}let X="c0",P="c1";for(let I=0;I<l*2-1;I++){for(let v=Math.max(0,I-l+1);v<=I&&v<l;v++){const T=I-v;E.addCode(u.setLocal(X,u.i64_add(u.i64_and(u.getLocal(X),u.i64_const(4294967295)),j(v,T)))),E.addCode(u.setLocal(P,u.i64_add(u.getLocal(P),u.i64_shr_u(u.getLocal(X),u.i64_const(32)))))}E.addCode(u.i64_store32(u.getLocal("r"),I*4,u.getLocal(X))),[X,P]=[P,X],E.addCode(u.setLocal(P,u.i64_shr_u(u.getLocal(X),u.i64_const(32))))}E.addCode(u.i64_store32(u.getLocal("r"),l*4*2-4,u.getLocal(X)))}function F(){const E=t.addFunction(e+"_square");E.addParam("x","i32"),E.addParam("r","i32"),E.addLocal("c0","i64"),E.addLocal("c1","i64"),E.addLocal("c0_old","i64"),E.addLocal("c1_old","i64");for(let v=0;v<l;v++)E.addLocal("x"+v,"i64");const u=E.getCodeBuilder(),L=[];function V(v,T){let ot,tt;return L[v]?ot=u.getLocal("x"+v):(ot=u.teeLocal("x"+v,u.i64_load32_u(u.getLocal("x"),v*4)),L[v]=!0),L[T]?tt=u.getLocal("x"+T):(tt=u.teeLocal("x"+T,u.i64_load32_u(u.getLocal("x"),T*4)),L[T]=!0),u.i64_mul(ot,tt)}let j="c0",X="c1",P="c0_old",I="c1_old";for(let v=0;v<l*2-1;v++){E.addCode(u.setLocal(j,u.i64_const(0)),u.setLocal(X,u.i64_const(0)));for(let T=Math.max(0,v-l+1);T<v+1>>1&&T<l;T++){const ot=v-T;E.addCode(u.setLocal(j,u.i64_add(u.i64_and(u.getLocal(j),u.i64_const(4294967295)),V(T,ot)))),E.addCode(u.setLocal(X,u.i64_add(u.getLocal(X),u.i64_shr_u(u.getLocal(j),u.i64_const(32)))))}E.addCode(u.setLocal(j,u.i64_shl(u.i64_and(u.getLocal(j),u.i64_const(4294967295)),u.i64_const(1)))),E.addCode(u.setLocal(X,u.i64_add(u.i64_shl(u.getLocal(X),u.i64_const(1)),u.i64_shr_u(u.getLocal(j),u.i64_const(32))))),v%2==0&&(E.addCode(u.setLocal(j,u.i64_add(u.i64_and(u.getLocal(j),u.i64_const(4294967295)),V(v>>1,v>>1)))),E.addCode(u.setLocal(X,u.i64_add(u.getLocal(X),u.i64_shr_u(u.getLocal(j),u.i64_const(32)))))),v>0&&(E.addCode(u.setLocal(j,u.i64_add(u.i64_and(u.getLocal(j),u.i64_const(4294967295)),u.i64_and(u.getLocal(P),u.i64_const(4294967295))))),E.addCode(u.setLocal(X,u.i64_add(u.i64_add(u.getLocal(X),u.i64_shr_u(u.getLocal(j),u.i64_const(32))),u.getLocal(I))))),E.addCode(u.i64_store32(u.getLocal("r"),v*4,u.getLocal(j))),E.addCode(u.setLocal(P,u.getLocal(X)),u.setLocal(I,u.i64_shr_u(u.getLocal(P),u.i64_const(32))))}E.addCode(u.i64_store32(u.getLocal("r"),l*4*2-4,u.getLocal(P)))}function q(){const E=t.addFunction(e+"_squareOld");E.addParam("x","i32"),E.addParam("r","i32");const u=E.getCodeBuilder();E.addCode(u.call(e+"_mul",u.getLocal("x"),u.getLocal("x"),u.getLocal("r")))}function x(){const E=t.addFunction(e+"__mul1");E.addParam("px","i32"),E.addParam("y","i64"),E.addParam("pr","i32"),E.addLocal("c","i64");const u=E.getCodeBuilder();E.addCode(u.setLocal("c",u.i64_mul(u.i64_load32_u(u.getLocal("px"),0,0),u.getLocal("y")))),E.addCode(u.i64_store32(u.getLocal("pr"),0,0,u.getLocal("c")));for(let L=1;L<l;L++)E.addCode(u.setLocal("c",u.i64_add(u.i64_mul(u.i64_load32_u(u.getLocal("px"),4*L,0),u.getLocal("y")),u.i64_shr_u(u.getLocal("c"),u.i64_const(32))))),E.addCode(u.i64_store32(u.getLocal("pr"),L*4,0,u.getLocal("c")))}function it(){const E=t.addFunction(e+"__add1");E.addParam("x","i32"),E.addParam("y","i64"),E.addLocal("c","i64"),E.addLocal("px","i32");const u=E.getCodeBuilder();E.addCode(u.setLocal("px",u.getLocal("x"))),E.addCode(u.setLocal("c",u.i64_add(u.i64_load32_u(u.getLocal("px"),0,0),u.getLocal("y")))),E.addCode(u.i64_store32(u.getLocal("px"),0,0,u.getLocal("c"))),E.addCode(u.setLocal("c",u.i64_shr_u(u.getLocal("c"),u.i64_const(32)))),E.addCode(u.block(u.loop(u.br_if(1,u.i64_eqz(u.getLocal("c"))),u.setLocal("px",u.i32_add(u.getLocal("px"),u.i32_const(4))),u.setLocal("c",u.i64_add(u.i64_load32_u(u.getLocal("px"),0,0),u.getLocal("c"))),u.i64_store32(u.getLocal("px"),0,0,u.getLocal("c")),u.setLocal("c",u.i64_shr_u(u.getLocal("c"),u.i64_const(32))),u.br(0))))}function z(){x(),it();const E=t.addFunction(e+"_div");E.addParam("x","i32"),E.addParam("y","i32"),E.addParam("c","i32"),E.addParam("r","i32"),E.addLocal("rr","i32"),E.addLocal("cc","i32"),E.addLocal("eX","i32"),E.addLocal("eY","i32"),E.addLocal("sy","i64"),E.addLocal("sx","i64"),E.addLocal("ec","i32");const u=E.getCodeBuilder(),L=u.i32_const(t.alloc(h)),V=u.i32_const(t.alloc(h)),j=u.i32_const(t.alloc(h)),X=u.getLocal("cc"),P=u.getLocal("rr"),I=t.alloc(h*2),v=u.i32_const(I),T=u.i32_const(I+h);E.addCode(u.if(u.getLocal("c"),u.setLocal("cc",u.getLocal("c")),u.setLocal("cc",V))),E.addCode(u.if(u.getLocal("r"),u.setLocal("rr",u.getLocal("r")),u.setLocal("rr",j))),E.addCode(u.call(e+"_copy",u.getLocal("x"),P)),E.addCode(u.call(e+"_copy",u.getLocal("y"),L)),E.addCode(u.call(e+"_zero",X)),E.addCode(u.call(e+"_zero",v)),E.addCode(u.setLocal("eX",u.i32_const(h-1))),E.addCode(u.setLocal("eY",u.i32_const(h-1))),E.addCode(u.block(u.loop(u.br_if(1,u.i32_or(u.i32_load8_u(u.i32_add(L,u.getLocal("eY")),0,0),u.i32_eq(u.getLocal("eY"),u.i32_const(3)))),u.setLocal("eY",u.i32_sub(u.getLocal("eY"),u.i32_const(1))),u.br(0)))),E.addCode(u.setLocal("sy",u.i64_add(u.i64_load32_u(u.i32_sub(u.i32_add(L,u.getLocal("eY")),u.i32_const(3)),0,0),u.i64_const(1)))),E.addCode(u.if(u.i64_eq(u.getLocal("sy"),u.i64_const(1)),u.drop(u.i64_div_u(u.i64_const(0),u.i64_const(0))))),E.addCode(u.block(u.loop(u.block(u.loop(u.br_if(1,u.i32_or(u.i32_load8_u(u.i32_add(P,u.getLocal("eX")),0,0),u.i32_eq(u.getLocal("eX"),u.i32_const(7)))),u.setLocal("eX",u.i32_sub(u.getLocal("eX"),u.i32_const(1))),u.br(0))),u.setLocal("sx",u.i64_load(u.i32_sub(u.i32_add(P,u.getLocal("eX")),u.i32_const(7)),0,0)),u.setLocal("sx",u.i64_div_u(u.getLocal("sx"),u.getLocal("sy"))),u.setLocal("ec",u.i32_sub(u.i32_sub(u.getLocal("eX"),u.getLocal("eY")),u.i32_const(4))),u.block(u.loop(u.br_if(1,u.i32_and(u.i64_eqz(u.i64_and(u.getLocal("sx"),u.i64_const("0xFFFFFFFF00000000"))),u.i32_ge_s(u.getLocal("ec"),u.i32_const(0)))),u.setLocal("sx",u.i64_shr_u(u.getLocal("sx"),u.i64_const(8))),u.setLocal("ec",u.i32_add(u.getLocal("ec"),u.i32_const(1))),u.br(0))),u.if(u.i64_eqz(u.getLocal("sx")),[...u.br_if(2,u.i32_eqz(u.call(e+"_gte",P,L))),...u.setLocal("sx",u.i64_const(1)),...u.setLocal("ec",u.i32_const(0))]),u.call(e+"__mul1",L,u.getLocal("sx"),T),u.drop(u.call(e+"_sub",P,u.i32_sub(T,u.getLocal("ec")),P)),u.call(e+"__add1",u.i32_add(X,u.getLocal("ec")),u.getLocal("sx")),u.br(0))))}function lt(){const E=t.addFunction(e+"_inverseMod");E.addParam("px","i32"),E.addParam("pm","i32"),E.addParam("pr","i32"),E.addLocal("t","i32"),E.addLocal("newt","i32"),E.addLocal("r","i32"),E.addLocal("qq","i32"),E.addLocal("qr","i32"),E.addLocal("newr","i32"),E.addLocal("swp","i32"),E.addLocal("x","i32"),E.addLocal("signt","i32"),E.addLocal("signnewt","i32"),E.addLocal("signx","i32");const u=E.getCodeBuilder(),L=u.i32_const(t.alloc(h)),V=u.i32_const(t.alloc(h)),j=u.i32_const(t.alloc(h)),X=u.i32_const(t.alloc(h)),P=u.i32_const(t.alloc(h)),I=u.i32_const(t.alloc(h)),v=u.i32_const(t.alloc(h*2)),T=u.i32_const(t.alloc(h));E.addCode(u.setLocal("t",L),u.call(e+"_zero",L),u.setLocal("signt",u.i32_const(0))),E.addCode(u.setLocal("r",V),u.call(e+"_copy",u.getLocal("pm"),V)),E.addCode(u.setLocal("newt",j),u.call(e+"_one",j),u.setLocal("signnewt",u.i32_const(0))),E.addCode(u.setLocal("newr",X),u.call(e+"_copy",u.getLocal("px"),X)),E.addCode(u.setLocal("qq",P)),E.addCode(u.setLocal("qr",I)),E.addCode(u.setLocal("x",T)),E.addCode(u.block(u.loop(u.br_if(1,u.call(e+"_isZero",u.getLocal("newr"))),u.call(e+"_div",u.getLocal("r"),u.getLocal("newr"),u.getLocal("qq"),u.getLocal("qr")),u.call(e+"_mul",u.getLocal("qq"),u.getLocal("newt"),v),u.if(u.getLocal("signt"),u.if(u.getLocal("signnewt"),u.if(u.call(e+"_gte",v,u.getLocal("t")),[...u.drop(u.call(e+"_sub",v,u.getLocal("t"),u.getLocal("x"))),...u.setLocal("signx",u.i32_const(0))],[...u.drop(u.call(e+"_sub",u.getLocal("t"),v,u.getLocal("x"))),...u.setLocal("signx",u.i32_const(1))]),[...u.drop(u.call(e+"_add",v,u.getLocal("t"),u.getLocal("x"))),...u.setLocal("signx",u.i32_const(1))]),u.if(u.getLocal("signnewt"),[...u.drop(u.call(e+"_add",v,u.getLocal("t"),u.getLocal("x"))),...u.setLocal("signx",u.i32_const(0))],u.if(u.call(e+"_gte",u.getLocal("t"),v),[...u.drop(u.call(e+"_sub",u.getLocal("t"),v,u.getLocal("x"))),...u.setLocal("signx",u.i32_const(0))],[...u.drop(u.call(e+"_sub",v,u.getLocal("t"),u.getLocal("x"))),...u.setLocal("signx",u.i32_const(1))]))),u.setLocal("swp",u.getLocal("t")),u.setLocal("t",u.getLocal("newt")),u.setLocal("newt",u.getLocal("x")),u.setLocal("x",u.getLocal("swp")),u.setLocal("signt",u.getLocal("signnewt")),u.setLocal("signnewt",u.getLocal("signx")),u.setLocal("swp",u.getLocal("r")),u.setLocal("r",u.getLocal("newr")),u.setLocal("newr",u.getLocal("qr")),u.setLocal("qr",u.getLocal("swp")),u.br(0)))),E.addCode(u.if(u.getLocal("signt"),u.drop(u.call(e+"_sub",u.getLocal("pm"),u.getLocal("t"),u.getLocal("pr"))),u.call(e+"_copy",u.getLocal("t"),u.getLocal("pr"))))}return r(),A(),s(),_(),w(),B(),b(),k(),D(),F(),q(),z(),lt(),t.exportFunction(e+"_copy"),t.exportFunction(e+"_zero"),t.exportFunction(e+"_one"),t.exportFunction(e+"_isZero"),t.exportFunction(e+"_eq"),t.exportFunction(e+"_gte"),t.exportFunction(e+"_add"),t.exportFunction(e+"_sub"),t.exportFunction(e+"_mul"),t.exportFunction(e+"_square"),t.exportFunction(e+"_squareOld"),t.exportFunction(e+"_div"),t.exportFunction(e+"_inverseMod"),e},ae=function(t,n,o,e,l,h,r){const A=t.addFunction(n);A.addParam("base","i32"),A.addParam("scalar","i32"),A.addParam("scalarLength","i32"),A.addParam("r","i32"),A.addLocal("i","i32"),A.addLocal("b","i32");const _=A.getCodeBuilder(),s=_.i32_const(t.alloc(o));A.addCode(_.if(_.i32_eqz(_.getLocal("scalarLength")),[..._.call(r,_.getLocal("r")),..._.ret([])])),A.addCode(_.call(h,_.getLocal("base"),s)),A.addCode(_.call(r,_.getLocal("r"))),A.addCode(_.setLocal("i",_.getLocal("scalarLength"))),A.addCode(_.block(_.loop(_.setLocal("i",_.i32_sub(_.getLocal("i"),_.i32_const(1))),_.setLocal("b",_.i32_load8_u(_.i32_add(_.getLocal("scalar"),_.getLocal("i")))),...w(),_.br_if(1,_.i32_eqz(_.getLocal("i"))),_.br(0))));function w(){const B=[];for(let b=0;b<8;b++)B.push(..._.call(l,_.getLocal("r"),_.getLocal("r")),..._.if(_.i32_ge_u(_.getLocal("b"),_.i32_const(128>>b)),[..._.setLocal("b",_.i32_sub(_.getLocal("b"),_.i32_const(128>>b))),..._.call(e,_.getLocal("r"),s,_.getLocal("r"))]));return B}},ce=Ja;function Ja(a,t){const n=a.modules[t].n64*8,o=a.addFunction(t+"_batchInverse");o.addParam("pIn","i32"),o.addParam("inStep","i32"),o.addParam("n","i32"),o.addParam("pOut","i32"),o.addParam("outStep","i32"),o.addLocal("itAux","i32"),o.addLocal("itIn","i32"),o.addLocal("itOut","i32"),o.addLocal("i","i32");const e=o.getCodeBuilder(),l=e.i32_const(a.alloc(n));o.addCode(e.setLocal("itAux",e.i32_load(e.i32_const(0))),e.i32_store(e.i32_const(0),e.i32_add(e.getLocal("itAux"),e.i32_mul(e.i32_add(e.getLocal("n"),e.i32_const(1)),e.i32_const(n))))),o.addCode(e.call(t+"_one",e.getLocal("itAux")),e.setLocal("itIn",e.getLocal("pIn")),e.setLocal("itAux",e.i32_add(e.getLocal("itAux"),e.i32_const(n))),e.setLocal("i",e.i32_const(0)),e.block(e.loop(e.br_if(1,e.i32_eq(e.getLocal("i"),e.getLocal("n"))),e.if(e.call(t+"_isZero",e.getLocal("itIn")),e.call(t+"_copy",e.i32_sub(e.getLocal("itAux"),e.i32_const(n)),e.getLocal("itAux")),e.call(t+"_mul",e.getLocal("itIn"),e.i32_sub(e.getLocal("itAux"),e.i32_const(n)),e.getLocal("itAux"))),e.setLocal("itIn",e.i32_add(e.getLocal("itIn"),e.getLocal("inStep"))),e.setLocal("itAux",e.i32_add(e.getLocal("itAux"),e.i32_const(n))),e.setLocal("i",e.i32_add(e.getLocal("i"),e.i32_const(1))),e.br(0))),e.setLocal("itIn",e.i32_sub(e.getLocal("itIn"),e.getLocal("inStep"))),e.setLocal("itAux",e.i32_sub(e.getLocal("itAux"),e.i32_const(n))),e.setLocal("itOut",e.i32_add(e.getLocal("pOut"),e.i32_mul(e.i32_sub(e.getLocal("n"),e.i32_const(1)),e.getLocal("outStep")))),e.call(t+"_inverse",e.getLocal("itAux"),e.getLocal("itAux")),e.block(e.loop(e.br_if(1,e.i32_eqz(e.getLocal("i"))),e.if(e.call(t+"_isZero",e.getLocal("itIn")),[...e.call(t+"_copy",e.getLocal("itAux"),e.i32_sub(e.getLocal("itAux"),e.i32_const(n))),...e.call(t+"_zero",e.getLocal("itOut"))],[...e.call(t+"_copy",e.i32_sub(e.getLocal("itAux"),e.i32_const(n)),l),...e.call(t+"_mul",e.getLocal("itAux"),e.getLocal("itIn"),e.i32_sub(e.getLocal("itAux"),e.i32_const(n))),...e.call(t+"_mul",e.getLocal("itAux"),l,e.getLocal("itOut"))]),e.setLocal("itIn",e.i32_sub(e.getLocal("itIn"),e.getLocal("inStep"))),e.setLocal("itOut",e.i32_sub(e.getLocal("itOut"),e.getLocal("outStep"))),e.setLocal("itAux",e.i32_sub(e.getLocal("itAux"),e.i32_const(n))),e.setLocal("i",e.i32_sub(e.getLocal("i"),e.i32_const(1))),e.br(0)))),o.addCode(e.i32_store(e.i32_const(0),e.getLocal("itAux")))}var mi=Xa;function Xa(a,t,n,o,e,l){typeof l>"u"&&(o<e?l=!0:l=!1);const h=a.addFunction(t);h.addParam("pIn","i32"),h.addParam("n","i32"),h.addParam("pOut","i32"),h.addLocal("i","i32"),h.addLocal("itIn","i32"),h.addLocal("itOut","i32");const r=h.getCodeBuilder();l?h.addCode(r.setLocal("itIn",r.i32_add(r.getLocal("pIn"),r.i32_mul(r.i32_sub(r.getLocal("n"),r.i32_const(1)),r.i32_const(o)))),r.setLocal("itOut",r.i32_add(r.getLocal("pOut"),r.i32_mul(r.i32_sub(r.getLocal("n"),r.i32_const(1)),r.i32_const(e)))),r.setLocal("i",r.i32_const(0)),r.block(r.loop(r.br_if(1,r.i32_eq(r.getLocal("i"),r.getLocal("n"))),r.call(n,r.getLocal("itIn"),r.getLocal("itOut")),r.setLocal("itIn",r.i32_sub(r.getLocal("itIn"),r.i32_const(o))),r.setLocal("itOut",r.i32_sub(r.getLocal("itOut"),r.i32_const(e))),r.setLocal("i",r.i32_add(r.getLocal("i"),r.i32_const(1))),r.br(0)))):h.addCode(r.setLocal("itIn",r.getLocal("pIn")),r.setLocal("itOut",r.getLocal("pOut")),r.setLocal("i",r.i32_const(0)),r.block(r.loop(r.br_if(1,r.i32_eq(r.getLocal("i"),r.getLocal("n"))),r.call(n,r.getLocal("itIn"),r.getLocal("itOut")),r.setLocal("itIn",r.i32_add(r.getLocal("itIn"),r.i32_const(o))),r.setLocal("itOut",r.i32_add(r.getLocal("itOut"),r.i32_const(e))),r.setLocal("i",r.i32_add(r.getLocal("i"),r.i32_const(1))),r.br(0))))}var tc=nc;function nc(a,t,n,o,e,l){typeof l>"u"&&(o<e?l=!0:l=!1);const h=a.addFunction(t);h.addParam("pIn1","i32"),h.addParam("pIn2","i32"),h.addParam("n","i32"),h.addParam("pOut","i32"),h.addLocal("i","i32"),h.addLocal("itIn1","i32"),h.addLocal("itIn2","i32"),h.addLocal("itOut","i32");const r=h.getCodeBuilder();l?h.addCode(r.setLocal("itIn1",r.i32_add(r.getLocal("pIn1"),r.i32_mul(r.i32_sub(r.getLocal("n"),r.i32_const(1)),r.i32_const(o)))),r.setLocal("itIn2",r.i32_add(r.getLocal("pIn2"),r.i32_mul(r.i32_sub(r.getLocal("n"),r.i32_const(1)),r.i32_const(o)))),r.setLocal("itOut",r.i32_add(r.getLocal("pOut"),r.i32_mul(r.i32_sub(r.getLocal("n"),r.i32_const(1)),r.i32_const(e)))),r.setLocal("i",r.i32_const(0)),r.block(r.loop(r.br_if(1,r.i32_eq(r.getLocal("i"),r.getLocal("n"))),r.call(n,r.getLocal("itIn1"),r.getLocal("itIn2"),r.getLocal("itOut")),r.setLocal("itIn1",r.i32_sub(r.getLocal("itIn1"),r.i32_const(o))),r.setLocal("itIn2",r.i32_sub(r.getLocal("itIn2"),r.i32_const(o))),r.setLocal("itOut",r.i32_sub(r.getLocal("itOut"),r.i32_const(e))),r.setLocal("i",r.i32_add(r.getLocal("i"),r.i32_const(1))),r.br(0)))):h.addCode(r.setLocal("itIn1",r.getLocal("pIn1")),r.setLocal("itIn2",r.getLocal("pIn2")),r.setLocal("itOut",r.getLocal("pOut")),r.setLocal("i",r.i32_const(0)),r.block(r.loop(r.br_if(1,r.i32_eq(r.getLocal("i"),r.getLocal("n"))),r.call(n,r.getLocal("itIn1"),r.getLocal("itIn2"),r.getLocal("itOut")),r.setLocal("itIn1",r.i32_add(r.getLocal("itIn1"),r.i32_const(o))),r.setLocal("itIn2",r.i32_add(r.getLocal("itIn2"),r.i32_const(o))),r.setLocal("itOut",r.i32_add(r.getLocal("itOut"),r.i32_const(e))),r.setLocal("i",r.i32_add(r.getLocal("i"),r.i32_const(1))),r.br(0))))}var jt={};function wi(a,t){return a===t?0:a>t?1:-1}function se(a){return a*a}function Bi(a){return a%2n!==0n}function le(a){return a%2n===0n}function yo(a){return a<0n}function oc(a){return a>0n}function Ei(a){return yo(a)?a.toString(2).length-1:a.toString(2).length}function eo(a){return a<0n?-a:a}function Rn(a){return eo(a)===1n}function Fi(a,t){for(var n=0n,o=1n,e=t,l=eo(a),h,r,A;l!==0n;)h=e/l,r=n,A=e,n=o,e=l,o=r-h*o,l=A-h*l;if(!Rn(e))throw new Error(a.toString()+" and "+t.toString()+" are not co-prime");return wi(n,0n)===-1&&(n=n+t),yo(a)?-n:n}function xi(a,t,n){if(n===0n)throw new Error("Cannot take modPow with modulus 0");var o=1n,e=a%n;for(yo(t)&&(t=t*-1n,e=Fi(e,n));oc(t);){if(e===0n)return 0n;Bi(t)&&(o=o*e%n),t=t/2n,e=se(e)%n}return o}function ec(a,t){return a=a>=0n?a:-a,t=t>=0n?t:-t,a===t?0:a>t?1:-1}function pe(a,t){return t===0n?!1:Rn(t)?!0:ec(t,2n)===0?le(a):a%t===0n}function ic(a){var t=eo(a);if(Rn(t))return!1;if(t===2n||t===3n||t===5n)return!0;if(le(t)||pe(t,3n)||pe(t,5n))return!1;if(t<49n)return!0}function ac(a){return a-1n}function Le(a,t){for(var n=ac(a),o=n,e=0,l,h,r;le(o);)o=o/2n,e++;t:for(h=0;h<t.length;h++)if(!(a<t[h])&&(r=xi(BigInt(t[h]),o,a),!(Rn(r)||r===n))){for(l=e-1;l!=0;l--){if(r=se(r)%a,Rn(r))return!1;if(r===n)continue t}return!1}return!0}function cc(a){var t=ic(a);if(t!==void 0)return t;var n=eo(a),o=Ei(n);if(o<=64)return Le(n,[2,3,5,7,11,13,17,19,23,29,31,37]);for(var e=Math.log(2)*Number(o),l=Math.ceil(e),h=[],r=0;r<l;r++)h.push(BigInt(r+2));return Le(n,h)}jt.bitLength=Ei;jt.isOdd=Bi;jt.isNegative=yo;jt.abs=eo;jt.isUnit=Rn;jt.compare=wi;jt.modInv=Fi;jt.modPow=xi;jt.isPrime=cc;jt.square=se;const sc=Wa,_n=wn,lc=ae,rc=ce,wo=mi,Bo=tc,{bitLength:dc,modInv:Eo,modPow:Ae,isPrime:be,isOdd:_c,square:gc}=jt;var re=function(t,n,o,e){const l=BigInt(n),h=Math.floor((dc(l-1n)-1)/64)+1,r=h*2,A=h*8,_=o||"f1m";if(t.modules[_])return _;const s=sc(t,h,e),w=t.alloc(A,_n.bigInt2BytesLE(l,A)),B=t.alloc(_n.bigInt2BytesLE(gc(1n<<BigInt(h*64))%l,A)),b=t.alloc(_n.bigInt2BytesLE((1n<<BigInt(h*64))%l,A)),k=t.alloc(_n.bigInt2BytesLE(0n,A)),D=l-1n,F=D>>1n,q=t.alloc(A,_n.bigInt2BytesLE(F,A)),x=F+1n,it=t.alloc(A,_n.bigInt2BytesLE(x,A));t.modules[_]={pq:w,pR2:B,n64:h,q:l,pOne:b,pZero:k,pePlusOne:it};function z(){const y=t.addFunction(_+"_one");y.addParam("pr","i32");const f=y.getCodeBuilder();y.addCode(f.call(s+"_copy",f.i32_const(b),f.getLocal("pr")))}function lt(){const y=t.addFunction(_+"_add");y.addParam("x","i32"),y.addParam("y","i32"),y.addParam("r","i32");const f=y.getCodeBuilder();y.addCode(f.if(f.call(s+"_add",f.getLocal("x"),f.getLocal("y"),f.getLocal("r")),f.drop(f.call(s+"_sub",f.getLocal("r"),f.i32_const(w),f.getLocal("r"))),f.if(f.call(s+"_gte",f.getLocal("r"),f.i32_const(w)),f.drop(f.call(s+"_sub",f.getLocal("r"),f.i32_const(w),f.getLocal("r"))))))}function E(){const y=t.addFunction(_+"_sub");y.addParam("x","i32"),y.addParam("y","i32"),y.addParam("r","i32");const f=y.getCodeBuilder();y.addCode(f.if(f.call(s+"_sub",f.getLocal("x"),f.getLocal("y"),f.getLocal("r")),f.drop(f.call(s+"_add",f.getLocal("r"),f.i32_const(w),f.getLocal("r")))))}function u(){const y=t.addFunction(_+"_neg");y.addParam("x","i32"),y.addParam("r","i32");const f=y.getCodeBuilder();y.addCode(f.call(_+"_sub",f.i32_const(k),f.getLocal("x"),f.getLocal("r")))}function L(){const y=t.addFunction(_+"_isNegative");y.addParam("x","i32"),y.setReturnType("i32");const f=y.getCodeBuilder(),S=f.i32_const(t.alloc(A));y.addCode(f.call(_+"_fromMontgomery",f.getLocal("x"),S),f.call(s+"_gte",S,f.i32_const(it)))}function V(){const y=t.addFunction(_+"_sign");y.addParam("x","i32"),y.setReturnType("i32");const f=y.getCodeBuilder(),S=f.i32_const(t.alloc(A));y.addCode(f.if(f.call(s+"_isZero",f.getLocal("x")),f.ret(f.i32_const(0))),f.call(_+"_fromMontgomery",f.getLocal("x"),S),f.if(f.call(s+"_gte",S,f.i32_const(it)),f.ret(f.i32_const(-1))),f.ret(f.i32_const(1)))}function j(){const y=t.alloc(r*r*8),f=t.addFunction(_+"_mReduct");f.addParam("t","i32"),f.addParam("r","i32"),f.addLocal("np32","i64"),f.addLocal("c","i64"),f.addLocal("m","i64");const S=f.getCodeBuilder(),J=Number(0x100000000n-Eo(l,0x100000000n));f.addCode(S.setLocal("np32",S.i64_const(J)));for(let R=0;R<r;R++){f.addCode(S.setLocal("c",S.i64_const(0))),f.addCode(S.setLocal("m",S.i64_and(S.i64_mul(S.i64_load32_u(S.getLocal("t"),R*4),S.getLocal("np32")),S.i64_const("0xFFFFFFFF"))));for(let et=0;et<r;et++)f.addCode(S.setLocal("c",S.i64_add(S.i64_add(S.i64_load32_u(S.getLocal("t"),(R+et)*4),S.i64_shr_u(S.getLocal("c"),S.i64_const(32))),S.i64_mul(S.i64_load32_u(S.i32_const(w),et*4),S.getLocal("m"))))),f.addCode(S.i64_store32(S.getLocal("t"),(R+et)*4,S.getLocal("c")));f.addCode(S.i64_store32(S.i32_const(y),R*4,S.i64_shr_u(S.getLocal("c"),S.i64_const(32))))}f.addCode(S.call(_+"_add",S.i32_const(y),S.i32_add(S.getLocal("t"),S.i32_const(r*4)),S.getLocal("r")))}function X(){const y=t.addFunction(_+"_mul");y.addParam("x","i32"),y.addParam("y","i32"),y.addParam("r","i32"),y.addLocal("c0","i64"),y.addLocal("c1","i64"),y.addLocal("np32","i64");for(let gt=0;gt<r;gt++)y.addLocal("x"+gt,"i64"),y.addLocal("y"+gt,"i64"),y.addLocal("m"+gt,"i64"),y.addLocal("q"+gt,"i64");const f=y.getCodeBuilder(),S=Number(0x100000000n-Eo(l,0x100000000n));y.addCode(f.setLocal("np32",f.i64_const(S)));const J=[],R=[],et=[];function It(gt,rt){let bt,vt;return J[gt]?bt=f.getLocal("x"+gt):(bt=f.teeLocal("x"+gt,f.i64_load32_u(f.getLocal("x"),gt*4)),J[gt]=!0),R[rt]?vt=f.getLocal("y"+rt):(vt=f.teeLocal("y"+rt,f.i64_load32_u(f.getLocal("y"),rt*4)),R[rt]=!0),f.i64_mul(bt,vt)}function dt(gt,rt){let bt,vt;return et[gt]?bt=f.getLocal("q"+gt):(bt=f.teeLocal("q"+gt,f.i64_load32_u(f.i32_const(0),w+gt*4)),et[gt]=!0),vt=f.getLocal("m"+rt),f.i64_mul(bt,vt)}let pt="c0",xt="c1";for(let gt=0;gt<r*2-1;gt++){for(let rt=Math.max(0,gt-r+1);rt<=gt&&rt<r;rt++){const bt=gt-rt;y.addCode(f.setLocal(pt,f.i64_add(f.i64_and(f.getLocal(pt),f.i64_const(4294967295)),It(rt,bt)))),y.addCode(f.setLocal(xt,f.i64_add(f.getLocal(xt),f.i64_shr_u(f.getLocal(pt),f.i64_const(32)))))}for(let rt=Math.max(1,gt-r+1);rt<=gt&&rt<r;rt++){const bt=gt-rt;y.addCode(f.setLocal(pt,f.i64_add(f.i64_and(f.getLocal(pt),f.i64_const(4294967295)),dt(rt,bt)))),y.addCode(f.setLocal(xt,f.i64_add(f.getLocal(xt),f.i64_shr_u(f.getLocal(pt),f.i64_const(32)))))}gt<r&&(y.addCode(f.setLocal("m"+gt,f.i64_and(f.i64_mul(f.i64_and(f.getLocal(pt),f.i64_const(4294967295)),f.getLocal("np32")),f.i64_const("0xFFFFFFFF")))),y.addCode(f.setLocal(pt,f.i64_add(f.i64_and(f.getLocal(pt),f.i64_const(4294967295)),dt(0,gt)))),y.addCode(f.setLocal(xt,f.i64_add(f.getLocal(xt),f.i64_shr_u(f.getLocal(pt),f.i64_const(32)))))),gt>=r&&y.addCode(f.i64_store32(f.getLocal("r"),(gt-r)*4,f.getLocal(pt))),[pt,xt]=[xt,pt],y.addCode(f.setLocal(xt,f.i64_shr_u(f.getLocal(pt),f.i64_const(32))))}y.addCode(f.i64_store32(f.getLocal("r"),r*4-4,f.getLocal(pt))),y.addCode(f.if(f.i32_wrap_i64(f.getLocal(xt)),f.drop(f.call(s+"_sub",f.getLocal("r"),f.i32_const(w),f.getLocal("r"))),f.if(f.call(s+"_gte",f.getLocal("r"),f.i32_const(w)),f.drop(f.call(s+"_sub",f.getLocal("r"),f.i32_const(w),f.getLocal("r"))))))}function P(){const y=t.addFunction(_+"_square");y.addParam("x","i32"),y.addParam("r","i32"),y.addLocal("c0","i64"),y.addLocal("c1","i64"),y.addLocal("c0_old","i64"),y.addLocal("c1_old","i64"),y.addLocal("np32","i64");for(let rt=0;rt<r;rt++)y.addLocal("x"+rt,"i64"),y.addLocal("m"+rt,"i64"),y.addLocal("q"+rt,"i64");const f=y.getCodeBuilder(),S=Number(0x100000000n-Eo(l,0x100000000n));y.addCode(f.setLocal("np32",f.i64_const(S)));const J=[],R=[];function et(rt,bt){let vt,Mt;return J[rt]?vt=f.getLocal("x"+rt):(vt=f.teeLocal("x"+rt,f.i64_load32_u(f.getLocal("x"),rt*4)),J[rt]=!0),J[bt]?Mt=f.getLocal("x"+bt):(Mt=f.teeLocal("x"+bt,f.i64_load32_u(f.getLocal("x"),bt*4)),J[bt]=!0),f.i64_mul(vt,Mt)}function It(rt,bt){let vt,Mt;return R[rt]?vt=f.getLocal("q"+rt):(vt=f.teeLocal("q"+rt,f.i64_load32_u(f.i32_const(0),w+rt*4)),R[rt]=!0),Mt=f.getLocal("m"+bt),f.i64_mul(vt,Mt)}let dt="c0",pt="c1",xt="c0_old",gt="c1_old";for(let rt=0;rt<r*2-1;rt++){y.addCode(f.setLocal(dt,f.i64_const(0)),f.setLocal(pt,f.i64_const(0)));for(let bt=Math.max(0,rt-r+1);bt<rt+1>>1&&bt<r;bt++){const vt=rt-bt;y.addCode(f.setLocal(dt,f.i64_add(f.i64_and(f.getLocal(dt),f.i64_const(4294967295)),et(bt,vt)))),y.addCode(f.setLocal(pt,f.i64_add(f.getLocal(pt),f.i64_shr_u(f.getLocal(dt),f.i64_const(32)))))}y.addCode(f.setLocal(dt,f.i64_shl(f.i64_and(f.getLocal(dt),f.i64_const(4294967295)),f.i64_const(1)))),y.addCode(f.setLocal(pt,f.i64_add(f.i64_shl(f.getLocal(pt),f.i64_const(1)),f.i64_shr_u(f.getLocal(dt),f.i64_const(32))))),rt%2==0&&(y.addCode(f.setLocal(dt,f.i64_add(f.i64_and(f.getLocal(dt),f.i64_const(4294967295)),et(rt>>1,rt>>1)))),y.addCode(f.setLocal(pt,f.i64_add(f.getLocal(pt),f.i64_shr_u(f.getLocal(dt),f.i64_const(32)))))),rt>0&&(y.addCode(f.setLocal(dt,f.i64_add(f.i64_and(f.getLocal(dt),f.i64_const(4294967295)),f.i64_and(f.getLocal(xt),f.i64_const(4294967295))))),y.addCode(f.setLocal(pt,f.i64_add(f.i64_add(f.getLocal(pt),f.i64_shr_u(f.getLocal(dt),f.i64_const(32))),f.getLocal(gt)))));for(let bt=Math.max(1,rt-r+1);bt<=rt&&bt<r;bt++){const vt=rt-bt;y.addCode(f.setLocal(dt,f.i64_add(f.i64_and(f.getLocal(dt),f.i64_const(4294967295)),It(bt,vt)))),y.addCode(f.setLocal(pt,f.i64_add(f.getLocal(pt),f.i64_shr_u(f.getLocal(dt),f.i64_const(32)))))}rt<r&&(y.addCode(f.setLocal("m"+rt,f.i64_and(f.i64_mul(f.i64_and(f.getLocal(dt),f.i64_const(4294967295)),f.getLocal("np32")),f.i64_const("0xFFFFFFFF")))),y.addCode(f.setLocal(dt,f.i64_add(f.i64_and(f.getLocal(dt),f.i64_const(4294967295)),It(0,rt)))),y.addCode(f.setLocal(pt,f.i64_add(f.getLocal(pt),f.i64_shr_u(f.getLocal(dt),f.i64_const(32)))))),rt>=r&&y.addCode(f.i64_store32(f.getLocal("r"),(rt-r)*4,f.getLocal(dt))),y.addCode(f.setLocal(xt,f.getLocal(pt)),f.setLocal(gt,f.i64_shr_u(f.getLocal(xt),f.i64_const(32))))}y.addCode(f.i64_store32(f.getLocal("r"),r*4-4,f.getLocal(xt))),y.addCode(f.if(f.i32_wrap_i64(f.getLocal(gt)),f.drop(f.call(s+"_sub",f.getLocal("r"),f.i32_const(w),f.getLocal("r"))),f.if(f.call(s+"_gte",f.getLocal("r"),f.i32_const(w)),f.drop(f.call(s+"_sub",f.getLocal("r"),f.i32_const(w),f.getLocal("r"))))))}function I(){const y=t.addFunction(_+"_squareOld");y.addParam("x","i32"),y.addParam("r","i32");const f=y.getCodeBuilder();y.addCode(f.call(_+"_mul",f.getLocal("x"),f.getLocal("x"),f.getLocal("r")))}function v(){const y=t.addFunction(_+"_toMontgomery");y.addParam("x","i32"),y.addParam("r","i32");const f=y.getCodeBuilder();y.addCode(f.call(_+"_mul",f.getLocal("x"),f.i32_const(B),f.getLocal("r")))}function T(){const y=t.alloc(A*2),f=t.addFunction(_+"_fromMontgomery");f.addParam("x","i32"),f.addParam("r","i32");const S=f.getCodeBuilder();f.addCode(S.call(s+"_copy",S.getLocal("x"),S.i32_const(y))),f.addCode(S.call(s+"_zero",S.i32_const(y+A))),f.addCode(S.call(_+"_mReduct",S.i32_const(y),S.getLocal("r")))}function ot(){const y=t.addFunction(_+"_inverse");y.addParam("x","i32"),y.addParam("r","i32");const f=y.getCodeBuilder();y.addCode(f.call(_+"_fromMontgomery",f.getLocal("x"),f.getLocal("r"))),y.addCode(f.call(s+"_inverseMod",f.getLocal("r"),f.i32_const(w),f.getLocal("r"))),y.addCode(f.call(_+"_toMontgomery",f.getLocal("r"),f.getLocal("r")))}let tt=2n;if(be(l))for(;Ae(tt,F,l)!==D;)tt=tt+1n;let K=0,at=D;for(;!_c(at)&&at!==0n;)K++,at=at>>1n;const W=t.alloc(A,_n.bigInt2BytesLE(at,A)),ct=Ae(tt,at,l),Lt=t.alloc(_n.bigInt2BytesLE((ct<<BigInt(h*64))%l,A)),wt=at+1n>>1n,ht=t.alloc(A,_n.bigInt2BytesLE(wt,A));function p(){const y=t.addFunction(_+"_sqrt");y.addParam("n","i32"),y.addParam("r","i32"),y.addLocal("m","i32"),y.addLocal("i","i32"),y.addLocal("j","i32");const f=y.getCodeBuilder(),S=f.i32_const(b),J=f.i32_const(t.alloc(A)),R=f.i32_const(t.alloc(A)),et=f.i32_const(t.alloc(A)),It=f.i32_const(t.alloc(A)),dt=f.i32_const(t.alloc(A));y.addCode(f.if(f.call(_+"_isZero",f.getLocal("n")),f.ret(f.call(_+"_zero",f.getLocal("r")))),f.setLocal("m",f.i32_const(K)),f.call(_+"_copy",f.i32_const(Lt),J),f.call(_+"_exp",f.getLocal("n"),f.i32_const(W),f.i32_const(A),R),f.call(_+"_exp",f.getLocal("n"),f.i32_const(ht),f.i32_const(A),et),f.block(f.loop(f.br_if(1,f.call(_+"_eq",R,S)),f.call(_+"_square",R,It),f.setLocal("i",f.i32_const(1)),f.block(f.loop(f.br_if(1,f.call(_+"_eq",It,S)),f.call(_+"_square",It,It),f.setLocal("i",f.i32_add(f.getLocal("i"),f.i32_const(1))),f.br(0))),f.call(_+"_copy",J,dt),f.setLocal("j",f.i32_sub(f.i32_sub(f.getLocal("m"),f.getLocal("i")),f.i32_const(1))),f.block(f.loop(f.br_if(1,f.i32_eqz(f.getLocal("j"))),f.call(_+"_square",dt,dt),f.setLocal("j",f.i32_sub(f.getLocal("j"),f.i32_const(1))),f.br(0))),f.setLocal("m",f.getLocal("i")),f.call(_+"_square",dt,J),f.call(_+"_mul",R,J,R),f.call(_+"_mul",et,dt,et),f.br(0))),f.if(f.call(_+"_isNegative",et),f.call(_+"_neg",et,f.getLocal("r")),f.call(_+"_copy",et,f.getLocal("r"))))}function i(){const y=t.addFunction(_+"_isSquare");y.addParam("n","i32"),y.setReturnType("i32");const f=y.getCodeBuilder(),S=f.i32_const(b),J=f.i32_const(t.alloc(A));y.addCode(f.if(f.call(_+"_isZero",f.getLocal("n")),f.ret(f.i32_const(1))),f.call(_+"_exp",f.getLocal("n"),f.i32_const(q),f.i32_const(A),J),f.call(_+"_eq",J,S))}function C(){const y=t.addFunction(_+"_load");y.addParam("scalar","i32"),y.addParam("scalarLen","i32"),y.addParam("r","i32"),y.addLocal("p","i32"),y.addLocal("l","i32"),y.addLocal("i","i32"),y.addLocal("j","i32");const f=y.getCodeBuilder(),S=f.i32_const(t.alloc(A)),J=t.alloc(A),R=f.i32_const(J);y.addCode(f.call(s+"_zero",f.getLocal("r")),f.setLocal("i",f.i32_const(A)),f.setLocal("p",f.getLocal("scalar")),f.block(f.loop(f.br_if(1,f.i32_gt_u(f.getLocal("i"),f.getLocal("scalarLen"))),f.if(f.i32_eq(f.getLocal("i"),f.i32_const(A)),f.call(_+"_one",S),f.call(_+"_mul",S,f.i32_const(B),S)),f.call(_+"_mul",f.getLocal("p"),S,R),f.call(_+"_add",f.getLocal("r"),R,f.getLocal("r")),f.setLocal("p",f.i32_add(f.getLocal("p"),f.i32_const(A))),f.setLocal("i",f.i32_add(f.getLocal("i"),f.i32_const(A))),f.br(0))),f.setLocal("l",f.i32_rem_u(f.getLocal("scalarLen"),f.i32_const(A))),f.if(f.i32_eqz(f.getLocal("l")),f.ret([])),f.call(s+"_zero",R),f.setLocal("j",f.i32_const(0)),f.block(f.loop(f.br_if(1,f.i32_eq(f.getLocal("j"),f.getLocal("l"))),f.i32_store8(f.getLocal("j"),J,f.i32_load8_u(f.getLocal("p"))),f.setLocal("p",f.i32_add(f.getLocal("p"),f.i32_const(1))),f.setLocal("j",f.i32_add(f.getLocal("j"),f.i32_const(1))),f.br(0))),f.if(f.i32_eq(f.getLocal("i"),f.i32_const(A)),f.call(_+"_one",S),f.call(_+"_mul",S,f.i32_const(B),S)),f.call(_+"_mul",R,S,R),f.call(_+"_add",f.getLocal("r"),R,f.getLocal("r")))}function c(){const y=t.addFunction(_+"_timesScalar");y.addParam("x","i32"),y.addParam("scalar","i32"),y.addParam("scalarLen","i32"),y.addParam("r","i32");const f=y.getCodeBuilder(),S=f.i32_const(t.alloc(A));y.addCode(f.call(_+"_load",f.getLocal("scalar"),f.getLocal("scalarLen"),S),f.call(_+"_toMontgomery",S,S),f.call(_+"_mul",f.getLocal("x"),S,f.getLocal("r")))}function m(){const y=t.addFunction(_+"_isOne");y.addParam("x","i32"),y.setReturnType("i32");const f=y.getCodeBuilder();y.addCode(f.ret(f.call(s+"_eq",f.getLocal("x"),f.i32_const(b))))}return t.exportFunction(s+"_copy",_+"_copy"),t.exportFunction(s+"_zero",_+"_zero"),t.exportFunction(s+"_isZero",_+"_isZero"),t.exportFunction(s+"_eq",_+"_eq"),m(),lt(),E(),u(),j(),X(),P(),I(),v(),T(),L(),V(),ot(),z(),C(),c(),rc(t,_),wo(t,_+"_batchToMontgomery",_+"_toMontgomery",A,A),wo(t,_+"_batchFromMontgomery",_+"_fromMontgomery",A,A),wo(t,_+"_batchNeg",_+"_neg",A,A),Bo(t,_+"_batchAdd",_+"_add",A,A),Bo(t,_+"_batchSub",_+"_sub",A,A),Bo(t,_+"_batchMul",_+"_mul",A,A),t.exportFunction(_+"_add"),t.exportFunction(_+"_sub"),t.exportFunction(_+"_neg"),t.exportFunction(_+"_isNegative"),t.exportFunction(_+"_isOne"),t.exportFunction(_+"_sign"),t.exportFunction(_+"_mReduct"),t.exportFunction(_+"_mul"),t.exportFunction(_+"_square"),t.exportFunction(_+"_squareOld"),t.exportFunction(_+"_fromMontgomery"),t.exportFunction(_+"_toMontgomery"),t.exportFunction(_+"_inverse"),t.exportFunction(_+"_one"),t.exportFunction(_+"_load"),t.exportFunction(_+"_timesScalar"),lc(t,_+"_exp",A,_+"_mul",_+"_square",s+"_copy",_+"_one"),t.exportFunction(_+"_exp"),t.exportFunction(_+"_batchInverse"),be(l)&&(p(),i(),t.exportFunction(_+"_sqrt"),t.exportFunction(_+"_isSquare")),t.exportFunction(_+"_batchToMontgomery"),t.exportFunction(_+"_batchFromMontgomery"),_};const uc=re,{bitLength:fc}=jt;var Si=function(t,n,o,e,l){const h=BigInt(n),r=Math.floor((fc(h-1n)-1)/64)+1,A=r*8,_=o||"f1";if(t.modules[_])return _;t.modules[_]={n64:r};const s=l||"int",w=uc(t,h,e,s),B=t.modules[w].pR2,b=t.modules[w].pq,k=t.modules[w].pePlusOne;function D(){const it=t.alloc(A),z=t.addFunction(_+"_mul");z.addParam("x","i32"),z.addParam("y","i32"),z.addParam("r","i32");const lt=z.getCodeBuilder();z.addCode(lt.call(w+"_mul",lt.getLocal("x"),lt.getLocal("y"),lt.i32_const(it))),z.addCode(lt.call(w+"_mul",lt.i32_const(it),lt.i32_const(B),lt.getLocal("r")))}function F(){const it=t.addFunction(_+"_square");it.addParam("x","i32"),it.addParam("r","i32");const z=it.getCodeBuilder();it.addCode(z.call(_+"_mul",z.getLocal("x"),z.getLocal("x"),z.getLocal("r")))}function q(){const it=t.addFunction(_+"_inverse");it.addParam("x","i32"),it.addParam("r","i32");const z=it.getCodeBuilder();it.addCode(z.call(s+"_inverseMod",z.getLocal("x"),z.i32_const(b),z.getLocal("r")))}function x(){const it=t.addFunction(_+"_isNegative");it.addParam("x","i32"),it.setReturnType("i32");const z=it.getCodeBuilder();it.addCode(z.call(s+"_gte",z.getLocal("x"),z.i32_const(k)))}return D(),F(),q(),x(),t.exportFunction(w+"_add",_+"_add"),t.exportFunction(w+"_sub",_+"_sub"),t.exportFunction(w+"_neg",_+"_neg"),t.exportFunction(_+"_mul"),t.exportFunction(_+"_square"),t.exportFunction(_+"_inverse"),t.exportFunction(_+"_isNegative"),t.exportFunction(w+"_copy",_+"_copy"),t.exportFunction(w+"_zero",_+"_zero"),t.exportFunction(w+"_one",_+"_one"),t.exportFunction(w+"_isZero",_+"_isZero"),t.exportFunction(w+"_eq",_+"_eq"),_};const hc=ae,pc=ce,Fo=wn;var vi=function(t,n,o,e){if(t.modules[o])return o;const l=t.modules[e].n64*8,h=t.modules[e].q;t.modules[o]={n64:t.modules[e].n64*2};function r(){const P=t.addFunction(o+"_add");P.addParam("x","i32"),P.addParam("y","i32"),P.addParam("r","i32");const I=P.getCodeBuilder(),v=I.getLocal("x"),T=I.i32_add(I.getLocal("x"),I.i32_const(l)),ot=I.getLocal("y"),tt=I.i32_add(I.getLocal("y"),I.i32_const(l)),K=I.getLocal("r"),at=I.i32_add(I.getLocal("r"),I.i32_const(l));P.addCode(I.call(e+"_add",v,ot,K),I.call(e+"_add",T,tt,at))}function A(){const P=t.addFunction(o+"_timesScalar");P.addParam("x","i32"),P.addParam("scalar","i32"),P.addParam("scalarLen","i32"),P.addParam("r","i32");const I=P.getCodeBuilder(),v=I.getLocal("x"),T=I.i32_add(I.getLocal("x"),I.i32_const(l)),ot=I.getLocal("r"),tt=I.i32_add(I.getLocal("r"),I.i32_const(l));P.addCode(I.call(e+"_timesScalar",v,I.getLocal("scalar"),I.getLocal("scalarLen"),ot),I.call(e+"_timesScalar",T,I.getLocal("scalar"),I.getLocal("scalarLen"),tt))}function _(){const P=t.addFunction(o+"_sub");P.addParam("x","i32"),P.addParam("y","i32"),P.addParam("r","i32");const I=P.getCodeBuilder(),v=I.getLocal("x"),T=I.i32_add(I.getLocal("x"),I.i32_const(l)),ot=I.getLocal("y"),tt=I.i32_add(I.getLocal("y"),I.i32_const(l)),K=I.getLocal("r"),at=I.i32_add(I.getLocal("r"),I.i32_const(l));P.addCode(I.call(e+"_sub",v,ot,K),I.call(e+"_sub",T,tt,at))}function s(){const P=t.addFunction(o+"_neg");P.addParam("x","i32"),P.addParam("r","i32");const I=P.getCodeBuilder(),v=I.getLocal("x"),T=I.i32_add(I.getLocal("x"),I.i32_const(l)),ot=I.getLocal("r"),tt=I.i32_add(I.getLocal("r"),I.i32_const(l));P.addCode(I.call(e+"_neg",v,ot),I.call(e+"_neg",T,tt))}function w(){const P=t.addFunction(o+"_conjugate");P.addParam("x","i32"),P.addParam("r","i32");const I=P.getCodeBuilder(),v=I.getLocal("x"),T=I.i32_add(I.getLocal("x"),I.i32_const(l)),ot=I.getLocal("r"),tt=I.i32_add(I.getLocal("r"),I.i32_const(l));P.addCode(I.call(e+"_copy",v,ot),I.call(e+"_neg",T,tt))}function B(){const P=t.addFunction(o+"_isNegative");P.addParam("x","i32"),P.setReturnType("i32");const I=P.getCodeBuilder(),v=I.getLocal("x"),T=I.i32_add(I.getLocal("x"),I.i32_const(l));P.addCode(I.if(I.call(e+"_isZero",T),I.ret(I.call(e+"_isNegative",v))),I.ret(I.call(e+"_isNegative",T)))}function b(){const P=t.addFunction(o+"_mul");P.addParam("x","i32"),P.addParam("y","i32"),P.addParam("r","i32");const I=P.getCodeBuilder(),v=I.getLocal("x"),T=I.i32_add(I.getLocal("x"),I.i32_const(l)),ot=I.getLocal("y"),tt=I.i32_add(I.getLocal("y"),I.i32_const(l)),K=I.getLocal("r"),at=I.i32_add(I.getLocal("r"),I.i32_const(l)),W=I.i32_const(t.alloc(l)),ct=I.i32_const(t.alloc(l)),Lt=I.i32_const(t.alloc(l)),wt=I.i32_const(t.alloc(l));P.addCode(I.call(e+"_mul",v,ot,W),I.call(e+"_mul",T,tt,ct),I.call(e+"_add",v,T,Lt),I.call(e+"_add",ot,tt,wt),I.call(e+"_mul",Lt,wt,Lt),I.call(n,ct,K),I.call(e+"_add",W,K,K),I.call(e+"_add",W,ct,at),I.call(e+"_sub",Lt,at,at))}function k(){const P=t.addFunction(o+"_mul1");P.addParam("x","i32"),P.addParam("y","i32"),P.addParam("r","i32");const I=P.getCodeBuilder(),v=I.getLocal("x"),T=I.i32_add(I.getLocal("x"),I.i32_const(l)),ot=I.getLocal("y"),tt=I.getLocal("r"),K=I.i32_add(I.getLocal("r"),I.i32_const(l));P.addCode(I.call(e+"_mul",v,ot,tt),I.call(e+"_mul",T,ot,K))}function D(){const P=t.addFunction(o+"_square");P.addParam("x","i32"),P.addParam("r","i32");const I=P.getCodeBuilder(),v=I.getLocal("x"),T=I.i32_add(I.getLocal("x"),I.i32_const(l)),ot=I.getLocal("r"),tt=I.i32_add(I.getLocal("r"),I.i32_const(l)),K=I.i32_const(t.alloc(l)),at=I.i32_const(t.alloc(l)),W=I.i32_const(t.alloc(l)),ct=I.i32_const(t.alloc(l));P.addCode(I.call(e+"_mul",v,T,K),I.call(e+"_add",v,T,at),I.call(n,T,W),I.call(e+"_add",v,W,W),I.call(n,K,ct),I.call(e+"_add",ct,K,ct),I.call(e+"_mul",at,W,ot),I.call(e+"_sub",ot,ct,ot),I.call(e+"_add",K,K,tt))}function F(){const P=t.addFunction(o+"_toMontgomery");P.addParam("x","i32"),P.addParam("r","i32");const I=P.getCodeBuilder(),v=I.getLocal("x"),T=I.i32_add(I.getLocal("x"),I.i32_const(l)),ot=I.getLocal("r"),tt=I.i32_add(I.getLocal("r"),I.i32_const(l));P.addCode(I.call(e+"_toMontgomery",v,ot),I.call(e+"_toMontgomery",T,tt))}function q(){const P=t.addFunction(o+"_fromMontgomery");P.addParam("x","i32"),P.addParam("r","i32");const I=P.getCodeBuilder(),v=I.getLocal("x"),T=I.i32_add(I.getLocal("x"),I.i32_const(l)),ot=I.getLocal("r"),tt=I.i32_add(I.getLocal("r"),I.i32_const(l));P.addCode(I.call(e+"_fromMontgomery",v,ot),I.call(e+"_fromMontgomery",T,tt))}function x(){const P=t.addFunction(o+"_copy");P.addParam("x","i32"),P.addParam("r","i32");const I=P.getCodeBuilder(),v=I.getLocal("x"),T=I.i32_add(I.getLocal("x"),I.i32_const(l)),ot=I.getLocal("r"),tt=I.i32_add(I.getLocal("r"),I.i32_const(l));P.addCode(I.call(e+"_copy",v,ot),I.call(e+"_copy",T,tt))}function it(){const P=t.addFunction(o+"_zero");P.addParam("x","i32");const I=P.getCodeBuilder(),v=I.getLocal("x"),T=I.i32_add(I.getLocal("x"),I.i32_const(l));P.addCode(I.call(e+"_zero",v),I.call(e+"_zero",T))}function z(){const P=t.addFunction(o+"_one");P.addParam("x","i32");const I=P.getCodeBuilder(),v=I.getLocal("x"),T=I.i32_add(I.getLocal("x"),I.i32_const(l));P.addCode(I.call(e+"_one",v),I.call(e+"_zero",T))}function lt(){const P=t.addFunction(o+"_eq");P.addParam("x","i32"),P.addParam("y","i32"),P.setReturnType("i32");const I=P.getCodeBuilder(),v=I.getLocal("x"),T=I.i32_add(I.getLocal("x"),I.i32_const(l)),ot=I.getLocal("y"),tt=I.i32_add(I.getLocal("y"),I.i32_const(l));P.addCode(I.i32_and(I.call(e+"_eq",v,ot),I.call(e+"_eq",T,tt)))}function E(){const P=t.addFunction(o+"_isZero");P.addParam("x","i32"),P.setReturnType("i32");const I=P.getCodeBuilder(),v=I.getLocal("x"),T=I.i32_add(I.getLocal("x"),I.i32_const(l));P.addCode(I.i32_and(I.call(e+"_isZero",v),I.call(e+"_isZero",T)))}function u(){const P=t.addFunction(o+"_inverse");P.addParam("x","i32"),P.addParam("r","i32");const I=P.getCodeBuilder(),v=I.getLocal("x"),T=I.i32_add(I.getLocal("x"),I.i32_const(l)),ot=I.getLocal("r"),tt=I.i32_add(I.getLocal("r"),I.i32_const(l)),K=I.i32_const(t.alloc(l)),at=I.i32_const(t.alloc(l)),W=I.i32_const(t.alloc(l)),ct=I.i32_const(t.alloc(l));P.addCode(I.call(e+"_square",v,K),I.call(e+"_square",T,at),I.call(n,at,W),I.call(e+"_sub",K,W,W),I.call(e+"_inverse",W,ct),I.call(e+"_mul",v,ct,ot),I.call(e+"_mul",T,ct,tt),I.call(e+"_neg",tt,tt))}function L(){const P=t.addFunction(o+"_sign");P.addParam("x","i32"),P.addLocal("s","i32"),P.setReturnType("i32");const I=P.getCodeBuilder(),v=I.getLocal("x"),T=I.i32_add(I.getLocal("x"),I.i32_const(l));P.addCode(I.setLocal("s",I.call(e+"_sign",T)),I.if(I.getLocal("s"),I.ret(I.getLocal("s"))),I.ret(I.call(e+"_sign",v)))}function V(){const P=t.addFunction(o+"_isOne");P.addParam("x","i32"),P.setReturnType("i32");const I=P.getCodeBuilder(),v=I.getLocal("x"),T=I.i32_add(I.getLocal("x"),I.i32_const(l));P.addCode(I.ret(I.i32_and(I.call(e+"_isOne",v),I.call(e+"_isZero",T))))}function j(){const P=t.addFunction(o+"_sqrt");P.addParam("a","i32"),P.addParam("pr","i32");const I=P.getCodeBuilder(),v=I.i32_const(t.alloc(Fo.bigInt2BytesLE((BigInt(h||0)-3n)/4n,l))),T=I.i32_const(t.alloc(Fo.bigInt2BytesLE((BigInt(h||0)-1n)/2n,l))),ot=I.getLocal("a"),tt=I.i32_const(t.alloc(l*2)),K=I.i32_const(t.alloc(l*2)),at=I.i32_const(t.alloc(l*2)),W=t.alloc(l*2),ct=I.i32_const(W),Lt=I.i32_const(W),wt=I.i32_const(W+l),ht=I.i32_const(t.alloc(l*2)),p=I.i32_const(t.alloc(l*2));P.addCode(I.call(o+"_one",ct),I.call(o+"_neg",ct,ct),I.call(o+"_exp",ot,v,I.i32_const(l),tt),I.call(o+"_square",tt,K),I.call(o+"_mul",ot,K,K),I.call(o+"_conjugate",K,at),I.call(o+"_mul",at,K,at),I.if(I.call(o+"_eq",at,ct),I.unreachable()),I.call(o+"_mul",tt,ot,ht),I.if(I.call(o+"_eq",K,ct),[...I.call(e+"_zero",Lt),...I.call(e+"_one",wt),...I.call(o+"_mul",ct,ht,I.getLocal("pr"))],[...I.call(o+"_one",p),...I.call(o+"_add",p,K,p),...I.call(o+"_exp",p,T,I.i32_const(l),p),...I.call(o+"_mul",p,ht,I.getLocal("pr"))]))}function X(){const P=t.addFunction(o+"_isSquare");P.addParam("a","i32"),P.setReturnType("i32");const I=P.getCodeBuilder(),v=I.i32_const(t.alloc(Fo.bigInt2BytesLE((BigInt(h||0)-3n)/4n,l))),T=I.getLocal("a"),ot=I.i32_const(t.alloc(l*2)),tt=I.i32_const(t.alloc(l*2)),K=I.i32_const(t.alloc(l*2)),at=t.alloc(l*2),W=I.i32_const(at);P.addCode(I.call(o+"_one",W),I.call(o+"_neg",W,W),I.call(o+"_exp",T,v,I.i32_const(l),ot),I.call(o+"_square",ot,tt),I.call(o+"_mul",T,tt,tt),I.call(o+"_conjugate",tt,K),I.call(o+"_mul",K,tt,K),I.if(I.call(o+"_eq",K,W),I.ret(I.i32_const(0))),I.ret(I.i32_const(1)))}return E(),V(),it(),z(),x(),b(),k(),D(),r(),_(),s(),w(),F(),q(),lt(),u(),A(),L(),B(),t.exportFunction(o+"_isZero"),t.exportFunction(o+"_isOne"),t.exportFunction(o+"_zero"),t.exportFunction(o+"_one"),t.exportFunction(o+"_copy"),t.exportFunction(o+"_mul"),t.exportFunction(o+"_mul1"),t.exportFunction(o+"_square"),t.exportFunction(o+"_add"),t.exportFunction(o+"_sub"),t.exportFunction(o+"_neg"),t.exportFunction(o+"_sign"),t.exportFunction(o+"_conjugate"),t.exportFunction(o+"_fromMontgomery"),t.exportFunction(o+"_toMontgomery"),t.exportFunction(o+"_eq"),t.exportFunction(o+"_inverse"),pc(t,o),hc(t,o+"_exp",l*2,o+"_mul",o+"_square",o+"_copy",o+"_one"),j(),X(),t.exportFunction(o+"_exp"),t.exportFunction(o+"_timesScalar"),t.exportFunction(o+"_batchInverse"),t.exportFunction(o+"_sqrt"),t.exportFunction(o+"_isSquare"),t.exportFunction(o+"_isNegative"),o};const Lc=ae,Ac=ce;var Oi=function(t,n,o,e){if(t.modules[o])return o;const l=t.modules[e].n64*8;t.modules[o]={n64:t.modules[e].n64*3};function h(){const u=t.addFunction(o+"_add");u.addParam("x","i32"),u.addParam("y","i32"),u.addParam("r","i32");const L=u.getCodeBuilder(),V=L.getLocal("x"),j=L.i32_add(L.getLocal("x"),L.i32_const(l)),X=L.i32_add(L.getLocal("x"),L.i32_const(2*l)),P=L.getLocal("y"),I=L.i32_add(L.getLocal("y"),L.i32_const(l)),v=L.i32_add(L.getLocal("y"),L.i32_const(2*l)),T=L.getLocal("r"),ot=L.i32_add(L.getLocal("r"),L.i32_const(l)),tt=L.i32_add(L.getLocal("r"),L.i32_const(2*l));u.addCode(L.call(e+"_add",V,P,T),L.call(e+"_add",j,I,ot),L.call(e+"_add",X,v,tt))}function r(){const u=t.addFunction(o+"_timesScalar");u.addParam("x","i32"),u.addParam("scalar","i32"),u.addParam("scalarLen","i32"),u.addParam("r","i32");const L=u.getCodeBuilder(),V=L.getLocal("x"),j=L.i32_add(L.getLocal("x"),L.i32_const(l)),X=L.i32_add(L.getLocal("x"),L.i32_const(2*l)),P=L.getLocal("r"),I=L.i32_add(L.getLocal("r"),L.i32_const(l)),v=L.i32_add(L.getLocal("r"),L.i32_const(2*l));u.addCode(L.call(e+"_timesScalar",V,L.getLocal("scalar"),L.getLocal("scalarLen"),P),L.call(e+"_timesScalar",j,L.getLocal("scalar"),L.getLocal("scalarLen"),I),L.call(e+"_timesScalar",X,L.getLocal("scalar"),L.getLocal("scalarLen"),v))}function A(){const u=t.addFunction(o+"_sub");u.addParam("x","i32"),u.addParam("y","i32"),u.addParam("r","i32");const L=u.getCodeBuilder(),V=L.getLocal("x"),j=L.i32_add(L.getLocal("x"),L.i32_const(l)),X=L.i32_add(L.getLocal("x"),L.i32_const(2*l)),P=L.getLocal("y"),I=L.i32_add(L.getLocal("y"),L.i32_const(l)),v=L.i32_add(L.getLocal("y"),L.i32_const(2*l)),T=L.getLocal("r"),ot=L.i32_add(L.getLocal("r"),L.i32_const(l)),tt=L.i32_add(L.getLocal("r"),L.i32_const(2*l));u.addCode(L.call(e+"_sub",V,P,T),L.call(e+"_sub",j,I,ot),L.call(e+"_sub",X,v,tt))}function _(){const u=t.addFunction(o+"_neg");u.addParam("x","i32"),u.addParam("r","i32");const L=u.getCodeBuilder(),V=L.getLocal("x"),j=L.i32_add(L.getLocal("x"),L.i32_const(l)),X=L.i32_add(L.getLocal("x"),L.i32_const(2*l)),P=L.getLocal("r"),I=L.i32_add(L.getLocal("r"),L.i32_const(l)),v=L.i32_add(L.getLocal("r"),L.i32_const(2*l));u.addCode(L.call(e+"_neg",V,P),L.call(e+"_neg",j,I),L.call(e+"_neg",X,v))}function s(){const u=t.addFunction(o+"_isNegative");u.addParam("x","i32"),u.setReturnType("i32");const L=u.getCodeBuilder(),V=L.getLocal("x"),j=L.i32_add(L.getLocal("x"),L.i32_const(l)),X=L.i32_add(L.getLocal("x"),L.i32_const(2*l));u.addCode(L.if(L.call(e+"_isZero",X),L.if(L.call(e+"_isZero",j),L.ret(L.call(e+"_isNegative",V)),L.ret(L.call(e+"_isNegative",j)))),L.ret(L.call(e+"_isNegative",X)))}function w(){const u=t.addFunction(o+"_mul");u.addParam("x","i32"),u.addParam("y","i32"),u.addParam("r","i32");const L=u.getCodeBuilder(),V=L.getLocal("x"),j=L.i32_add(L.getLocal("x"),L.i32_const(l)),X=L.i32_add(L.getLocal("x"),L.i32_const(2*l)),P=L.getLocal("y"),I=L.i32_add(L.getLocal("y"),L.i32_const(l)),v=L.i32_add(L.getLocal("y"),L.i32_const(2*l)),T=L.getLocal("r"),ot=L.i32_add(L.getLocal("r"),L.i32_const(l)),tt=L.i32_add(L.getLocal("r"),L.i32_const(2*l)),K=L.i32_const(t.alloc(l)),at=L.i32_const(t.alloc(l)),W=L.i32_const(t.alloc(l)),ct=L.i32_const(t.alloc(l)),Lt=L.i32_const(t.alloc(l)),wt=L.i32_const(t.alloc(l)),ht=L.i32_const(t.alloc(l)),p=L.i32_const(t.alloc(l)),i=L.i32_const(t.alloc(l)),C=L.i32_const(t.alloc(l)),c=L.i32_const(t.alloc(l)),m=L.i32_const(t.alloc(l)),y=L.i32_const(t.alloc(l));u.addCode(L.call(e+"_mul",V,P,K),L.call(e+"_mul",j,I,at),L.call(e+"_mul",X,v,W),L.call(e+"_add",V,j,ct),L.call(e+"_add",P,I,Lt),L.call(e+"_add",V,X,wt),L.call(e+"_add",P,v,ht),L.call(e+"_add",j,X,p),L.call(e+"_add",I,v,i),L.call(e+"_add",K,at,C),L.call(e+"_add",K,W,c),L.call(e+"_add",at,W,m),L.call(e+"_mul",p,i,T),L.call(e+"_sub",T,m,T),L.call(n,T,T),L.call(e+"_add",K,T,T),L.call(e+"_mul",ct,Lt,ot),L.call(e+"_sub",ot,C,ot),L.call(n,W,y),L.call(e+"_add",ot,y,ot),L.call(e+"_mul",wt,ht,tt),L.call(e+"_sub",tt,c,tt),L.call(e+"_add",tt,at,tt))}function B(){const u=t.addFunction(o+"_square");u.addParam("x","i32"),u.addParam("r","i32");const L=u.getCodeBuilder(),V=L.getLocal("x"),j=L.i32_add(L.getLocal("x"),L.i32_const(l)),X=L.i32_add(L.getLocal("x"),L.i32_const(2*l)),P=L.getLocal("r"),I=L.i32_add(L.getLocal("r"),L.i32_const(l)),v=L.i32_add(L.getLocal("r"),L.i32_const(2*l)),T=L.i32_const(t.alloc(l)),ot=L.i32_const(t.alloc(l)),tt=L.i32_const(t.alloc(l)),K=L.i32_const(t.alloc(l)),at=L.i32_const(t.alloc(l)),W=L.i32_const(t.alloc(l)),ct=L.i32_const(t.alloc(l));u.addCode(L.call(e+"_square",V,T),L.call(e+"_mul",V,j,ot),L.call(e+"_add",ot,ot,tt),L.call(e+"_sub",V,j,K),L.call(e+"_add",K,X,K),L.call(e+"_square",K,K),L.call(e+"_mul",j,X,at),L.call(e+"_add",at,at,W),L.call(e+"_square",X,ct),L.call(n,W,P),L.call(e+"_add",T,P,P),L.call(n,ct,I),L.call(e+"_add",tt,I,I),L.call(e+"_add",T,ct,v),L.call(e+"_sub",W,v,v),L.call(e+"_add",K,v,v),L.call(e+"_add",tt,v,v))}function b(){const u=t.addFunction(o+"_toMontgomery");u.addParam("x","i32"),u.addParam("r","i32");const L=u.getCodeBuilder(),V=L.getLocal("x"),j=L.i32_add(L.getLocal("x"),L.i32_const(l)),X=L.i32_add(L.getLocal("x"),L.i32_const(2*l)),P=L.getLocal("r"),I=L.i32_add(L.getLocal("r"),L.i32_const(l)),v=L.i32_add(L.getLocal("r"),L.i32_const(2*l));u.addCode(L.call(e+"_toMontgomery",V,P),L.call(e+"_toMontgomery",j,I),L.call(e+"_toMontgomery",X,v))}function k(){const u=t.addFunction(o+"_fromMontgomery");u.addParam("x","i32"),u.addParam("r","i32");const L=u.getCodeBuilder(),V=L.getLocal("x"),j=L.i32_add(L.getLocal("x"),L.i32_const(l)),X=L.i32_add(L.getLocal("x"),L.i32_const(2*l)),P=L.getLocal("r"),I=L.i32_add(L.getLocal("r"),L.i32_const(l)),v=L.i32_add(L.getLocal("r"),L.i32_const(2*l));u.addCode(L.call(e+"_fromMontgomery",V,P),L.call(e+"_fromMontgomery",j,I),L.call(e+"_fromMontgomery",X,v))}function D(){const u=t.addFunction(o+"_copy");u.addParam("x","i32"),u.addParam("r","i32");const L=u.getCodeBuilder(),V=L.getLocal("x"),j=L.i32_add(L.getLocal("x"),L.i32_const(l)),X=L.i32_add(L.getLocal("x"),L.i32_const(2*l)),P=L.getLocal("r"),I=L.i32_add(L.getLocal("r"),L.i32_const(l)),v=L.i32_add(L.getLocal("r"),L.i32_const(2*l));u.addCode(L.call(e+"_copy",V,P),L.call(e+"_copy",j,I),L.call(e+"_copy",X,v))}function F(){const u=t.addFunction(o+"_zero");u.addParam("x","i32");const L=u.getCodeBuilder(),V=L.getLocal("x"),j=L.i32_add(L.getLocal("x"),L.i32_const(l)),X=L.i32_add(L.getLocal("x"),L.i32_const(2*l));u.addCode(L.call(e+"_zero",V),L.call(e+"_zero",j),L.call(e+"_zero",X))}function q(){const u=t.addFunction(o+"_one");u.addParam("x","i32");const L=u.getCodeBuilder(),V=L.getLocal("x"),j=L.i32_add(L.getLocal("x"),L.i32_const(l)),X=L.i32_add(L.getLocal("x"),L.i32_const(2*l));u.addCode(L.call(e+"_one",V),L.call(e+"_zero",j),L.call(e+"_zero",X))}function x(){const u=t.addFunction(o+"_eq");u.addParam("x","i32"),u.addParam("y","i32"),u.setReturnType("i32");const L=u.getCodeBuilder(),V=L.getLocal("x"),j=L.i32_add(L.getLocal("x"),L.i32_const(l)),X=L.i32_add(L.getLocal("x"),L.i32_const(2*l)),P=L.getLocal("y"),I=L.i32_add(L.getLocal("y"),L.i32_const(l)),v=L.i32_add(L.getLocal("y"),L.i32_const(2*l));u.addCode(L.i32_and(L.i32_and(L.call(e+"_eq",V,P),L.call(e+"_eq",j,I)),L.call(e+"_eq",X,v)))}function it(){const u=t.addFunction(o+"_isZero");u.addParam("x","i32"),u.setReturnType("i32");const L=u.getCodeBuilder(),V=L.getLocal("x"),j=L.i32_add(L.getLocal("x"),L.i32_const(l)),X=L.i32_add(L.getLocal("x"),L.i32_const(2*l));u.addCode(L.i32_and(L.i32_and(L.call(e+"_isZero",V),L.call(e+"_isZero",j)),L.call(e+"_isZero",X)))}function z(){const u=t.addFunction(o+"_inverse");u.addParam("x","i32"),u.addParam("r","i32");const L=u.getCodeBuilder(),V=L.getLocal("x"),j=L.i32_add(L.getLocal("x"),L.i32_const(l)),X=L.i32_add(L.getLocal("x"),L.i32_const(2*l)),P=L.getLocal("r"),I=L.i32_add(L.getLocal("r"),L.i32_const(l)),v=L.i32_add(L.getLocal("r"),L.i32_const(2*l)),T=L.i32_const(t.alloc(l)),ot=L.i32_const(t.alloc(l)),tt=L.i32_const(t.alloc(l)),K=L.i32_const(t.alloc(l)),at=L.i32_const(t.alloc(l)),W=L.i32_const(t.alloc(l)),ct=L.i32_const(t.alloc(l)),Lt=L.i32_const(t.alloc(l)),wt=L.i32_const(t.alloc(l)),ht=L.i32_const(t.alloc(l)),p=L.i32_const(t.alloc(l));u.addCode(L.call(e+"_square",V,T),L.call(e+"_square",j,ot),L.call(e+"_square",X,tt),L.call(e+"_mul",V,j,K),L.call(e+"_mul",V,X,at),L.call(e+"_mul",j,X,W),L.call(n,W,ct),L.call(e+"_sub",T,ct,ct),L.call(n,tt,Lt),L.call(e+"_sub",Lt,K,Lt),L.call(e+"_sub",ot,at,wt),L.call(e+"_mul",X,Lt,ht),L.call(e+"_mul",j,wt,p),L.call(e+"_add",ht,p,ht),L.call(n,ht,ht),L.call(e+"_mul",V,ct,p),L.call(e+"_add",p,ht,ht),L.call(e+"_inverse",ht,ht),L.call(e+"_mul",ht,ct,P),L.call(e+"_mul",ht,Lt,I),L.call(e+"_mul",ht,wt,v))}function lt(){const u=t.addFunction(o+"_sign");u.addParam("x","i32"),u.addLocal("s","i32"),u.setReturnType("i32");const L=u.getCodeBuilder(),V=L.getLocal("x"),j=L.i32_add(L.getLocal("x"),L.i32_const(l)),X=L.i32_add(L.getLocal("x"),L.i32_const(2*l));u.addCode(L.setLocal("s",L.call(e+"_sign",X)),L.if(L.getLocal("s"),L.ret(L.getLocal("s"))),L.setLocal("s",L.call(e+"_sign",j)),L.if(L.getLocal("s"),L.ret(L.getLocal("s"))),L.ret(L.call(e+"_sign",V)))}function E(){const u=t.addFunction(o+"_isOne");u.addParam("x","i32"),u.setReturnType("i32");const L=u.getCodeBuilder(),V=L.getLocal("x"),j=L.i32_add(L.getLocal("x"),L.i32_const(l)),X=L.i32_add(L.getLocal("x"),L.i32_const(l*2));u.addCode(L.ret(L.i32_and(L.i32_and(L.call(e+"_isOne",V),L.call(e+"_isZero",j)),L.call(e+"_isZero",X))))}return it(),E(),F(),q(),D(),w(),B(),h(),A(),_(),lt(),b(),k(),x(),z(),r(),s(),t.exportFunction(o+"_isZero"),t.exportFunction(o+"_isOne"),t.exportFunction(o+"_zero"),t.exportFunction(o+"_one"),t.exportFunction(o+"_copy"),t.exportFunction(o+"_mul"),t.exportFunction(o+"_square"),t.exportFunction(o+"_add"),t.exportFunction(o+"_sub"),t.exportFunction(o+"_neg"),t.exportFunction(o+"_sign"),t.exportFunction(o+"_fromMontgomery"),t.exportFunction(o+"_toMontgomery"),t.exportFunction(o+"_eq"),t.exportFunction(o+"_inverse"),Ac(t,o),Lc(t,o+"_exp",l*3,o+"_mul",o+"_square",o+"_copy",o+"_one"),t.exportFunction(o+"_exp"),t.exportFunction(o+"_timesScalar"),t.exportFunction(o+"_batchInverse"),t.exportFunction(o+"_isNegative"),o},bc=function(t,n,o,e,l,h,r,A){const _=t.addFunction(n);_.addParam("base","i32"),_.addParam("scalar","i32"),_.addParam("scalarLength","i32"),_.addParam("r","i32"),_.addLocal("old0","i32"),_.addLocal("nbits","i32"),_.addLocal("i","i32"),_.addLocal("last","i32"),_.addLocal("cur","i32"),_.addLocal("carry","i32"),_.addLocal("p","i32");const s=_.getCodeBuilder(),w=s.i32_const(t.alloc(o));function B(k){return s.i32_and(s.i32_shr_u(s.i32_load(s.i32_add(s.getLocal("scalar"),s.i32_and(s.i32_shr_u(k,s.i32_const(3)),s.i32_const(4294967292)))),s.i32_and(k,s.i32_const(31))),s.i32_const(1))}function b(k){return[...s.i32_store8(s.getLocal("p"),s.i32_const(k)),...s.setLocal("p",s.i32_add(s.getLocal("p"),s.i32_const(1)))]}_.addCode(s.if(s.i32_eqz(s.getLocal("scalarLength")),[...s.call(A,s.getLocal("r")),...s.ret([])]),s.setLocal("nbits",s.i32_shl(s.getLocal("scalarLength"),s.i32_const(3))),s.setLocal("old0",s.i32_load(s.i32_const(0))),s.setLocal("p",s.getLocal("old0")),s.i32_store(s.i32_const(0),s.i32_and(s.i32_add(s.i32_add(s.getLocal("old0"),s.i32_const(32)),s.getLocal("nbits")),s.i32_const(4294967288))),s.setLocal("i",s.i32_const(1)),s.setLocal("last",B(s.i32_const(0))),s.setLocal("carry",s.i32_const(0)),s.block(s.loop(s.br_if(1,s.i32_eq(s.getLocal("i"),s.getLocal("nbits"))),s.setLocal("cur",B(s.getLocal("i"))),s.if(s.getLocal("last"),s.if(s.getLocal("cur"),s.if(s.getLocal("carry"),[...s.setLocal("last",s.i32_const(0)),...s.setLocal("carry",s.i32_const(1)),...b(1)],[...s.setLocal("last",s.i32_const(0)),...s.setLocal("carry",s.i32_const(1)),...b(255)]),s.if(s.getLocal("carry"),[...s.setLocal("last",s.i32_const(0)),...s.setLocal("carry",s.i32_const(1)),...b(255)],[...s.setLocal("last",s.i32_const(0)),...s.setLocal("carry",s.i32_const(0)),...b(1)])),s.if(s.getLocal("cur"),s.if(s.getLocal("carry"),[...s.setLocal("last",s.i32_const(0)),...s.setLocal("carry",s.i32_const(1)),...b(0)],[...s.setLocal("last",s.i32_const(1)),...s.setLocal("carry",s.i32_const(0)),...b(0)]),s.if(s.getLocal("carry"),[...s.setLocal("last",s.i32_const(1)),...s.setLocal("carry",s.i32_const(0)),...b(0)],[...s.setLocal("last",s.i32_const(0)),...s.setLocal("carry",s.i32_const(0)),...b(0)]))),s.setLocal("i",s.i32_add(s.getLocal("i"),s.i32_const(1))),s.br(0))),s.if(s.getLocal("last"),s.if(s.getLocal("carry"),[...b(255),...b(0),...b(1)],[...b(1)]),s.if(s.getLocal("carry"),[...b(0),...b(1)])),s.setLocal("p",s.i32_sub(s.getLocal("p"),s.i32_const(1))),s.call(r,s.getLocal("base"),w),s.call(A,s.getLocal("r")),s.block(s.loop(s.call(l,s.getLocal("r"),s.getLocal("r")),s.setLocal("cur",s.i32_load8_u(s.getLocal("p"))),s.if(s.getLocal("cur"),s.if(s.i32_eq(s.getLocal("cur"),s.i32_const(1)),s.call(e,s.getLocal("r"),w,s.getLocal("r")),s.call(h,s.getLocal("r"),w,s.getLocal("r")))),s.br_if(1,s.i32_eq(s.getLocal("old0"),s.getLocal("p"))),s.setLocal("p",s.i32_sub(s.getLocal("p"),s.i32_const(1))),s.br(0))),s.i32_store(s.i32_const(0),s.getLocal("old0")))},Ic=function(t,n,o,e,l){const r=t.modules[n].n64*8;function A(){const B=t.addFunction(o+"_getChunk");B.addParam("pScalar","i32"),B.addParam("scalarSize","i32"),B.addParam("startBit","i32"),B.addParam("chunkSize","i32"),B.addLocal("bitsToEnd","i32"),B.addLocal("mask","i32"),B.setReturnType("i32");const b=B.getCodeBuilder();B.addCode(b.setLocal("bitsToEnd",b.i32_sub(b.i32_mul(b.getLocal("scalarSize"),b.i32_const(8)),b.getLocal("startBit"))),b.if(b.i32_gt_s(b.getLocal("chunkSize"),b.getLocal("bitsToEnd")),b.setLocal("mask",b.i32_sub(b.i32_shl(b.i32_const(1),b.getLocal("bitsToEnd")),b.i32_const(1))),b.setLocal("mask",b.i32_sub(b.i32_shl(b.i32_const(1),b.getLocal("chunkSize")),b.i32_const(1)))),b.i32_and(b.i32_shr_u(b.i32_load(b.i32_add(b.getLocal("pScalar"),b.i32_shr_u(b.getLocal("startBit"),b.i32_const(3))),0,0),b.i32_and(b.getLocal("startBit"),b.i32_const(7))),b.getLocal("mask")))}function _(){const B=t.addFunction(o+"_chunk");B.addParam("pBases","i32"),B.addParam("pScalars","i32"),B.addParam("scalarSize","i32"),B.addParam("n","i32"),B.addParam("startBit","i32"),B.addParam("chunkSize","i32"),B.addParam("pr","i32"),B.addLocal("nChunks","i32"),B.addLocal("itScalar","i32"),B.addLocal("endScalar","i32"),B.addLocal("itBase","i32"),B.addLocal("i","i32"),B.addLocal("j","i32"),B.addLocal("nTable","i32"),B.addLocal("pTable","i32"),B.addLocal("idx","i32"),B.addLocal("pIdxTable","i32");const b=B.getCodeBuilder();B.addCode(b.if(b.i32_eqz(b.getLocal("n")),[...b.call(n+"_zero",b.getLocal("pr")),...b.ret([])]),b.setLocal("nTable",b.i32_shl(b.i32_const(1),b.getLocal("chunkSize"))),b.setLocal("pTable",b.i32_load(b.i32_const(0))),b.i32_store(b.i32_const(0),b.i32_add(b.getLocal("pTable"),b.i32_mul(b.getLocal("nTable"),b.i32_const(r)))),b.setLocal("j",b.i32_const(0)),b.block(b.loop(b.br_if(1,b.i32_eq(b.getLocal("j"),b.getLocal("nTable"))),b.call(n+"_zero",b.i32_add(b.getLocal("pTable"),b.i32_mul(b.getLocal("j"),b.i32_const(r)))),b.setLocal("j",b.i32_add(b.getLocal("j"),b.i32_const(1))),b.br(0))),b.setLocal("itBase",b.getLocal("pBases")),b.setLocal("itScalar",b.getLocal("pScalars")),b.setLocal("endScalar",b.i32_add(b.getLocal("pScalars"),b.i32_mul(b.getLocal("n"),b.getLocal("scalarSize")))),b.block(b.loop(b.br_if(1,b.i32_eq(b.getLocal("itScalar"),b.getLocal("endScalar"))),b.setLocal("idx",b.call(o+"_getChunk",b.getLocal("itScalar"),b.getLocal("scalarSize"),b.getLocal("startBit"),b.getLocal("chunkSize"))),b.if(b.getLocal("idx"),[...b.setLocal("pIdxTable",b.i32_add(b.getLocal("pTable"),b.i32_mul(b.i32_sub(b.getLocal("idx"),b.i32_const(1)),b.i32_const(r)))),...b.call(e,b.getLocal("pIdxTable"),b.getLocal("itBase"),b.getLocal("pIdxTable"))]),b.setLocal("itScalar",b.i32_add(b.getLocal("itScalar"),b.getLocal("scalarSize"))),b.setLocal("itBase",b.i32_add(b.getLocal("itBase"),b.i32_const(l))),b.br(0))),b.call(o+"_reduceTable",b.getLocal("pTable"),b.getLocal("chunkSize")),b.call(n+"_copy",b.getLocal("pTable"),b.getLocal("pr")),b.i32_store(b.i32_const(0),b.getLocal("pTable")))}function s(){const B=t.addFunction(o);B.addParam("pBases","i32"),B.addParam("pScalars","i32"),B.addParam("scalarSize","i32"),B.addParam("n","i32"),B.addParam("pr","i32"),B.addLocal("chunkSize","i32"),B.addLocal("nChunks","i32"),B.addLocal("itScalar","i32"),B.addLocal("endScalar","i32"),B.addLocal("itBase","i32"),B.addLocal("itBit","i32"),B.addLocal("i","i32"),B.addLocal("j","i32"),B.addLocal("nTable","i32"),B.addLocal("pTable","i32"),B.addLocal("idx","i32"),B.addLocal("pIdxTable","i32");const b=B.getCodeBuilder(),k=b.i32_const(t.alloc(r)),D=t.alloc([17,17,17,17,17,17,17,17,17,17,16,16,15,14,13,13,12,11,10,9,8,7,7,6,5,4,3,2,1,1,1,1]);B.addCode(b.call(n+"_zero",b.getLocal("pr")),b.if(b.i32_eqz(b.getLocal("n")),b.ret([])),b.setLocal("chunkSize",b.i32_load8_u(b.i32_clz(b.getLocal("n")),D)),b.setLocal("nChunks",b.i32_add(b.i32_div_u(b.i32_sub(b.i32_shl(b.getLocal("scalarSize"),b.i32_const(3)),b.i32_const(1)),b.getLocal("chunkSize")),b.i32_const(1))),b.setLocal("itBit",b.i32_mul(b.i32_sub(b.getLocal("nChunks"),b.i32_const(1)),b.getLocal("chunkSize"))),b.block(b.loop(b.br_if(1,b.i32_lt_s(b.getLocal("itBit"),b.i32_const(0))),b.if(b.i32_eqz(b.call(n+"_isZero",b.getLocal("pr"))),[...b.setLocal("j",b.i32_const(0)),...b.block(b.loop(b.br_if(1,b.i32_eq(b.getLocal("j"),b.getLocal("chunkSize"))),b.call(n+"_double",b.getLocal("pr"),b.getLocal("pr")),b.setLocal("j",b.i32_add(b.getLocal("j"),b.i32_const(1))),b.br(0)))]),b.call(o+"_chunk",b.getLocal("pBases"),b.getLocal("pScalars"),b.getLocal("scalarSize"),b.getLocal("n"),b.getLocal("itBit"),b.getLocal("chunkSize"),k),b.call(n+"_add",b.getLocal("pr"),k,b.getLocal("pr")),b.setLocal("itBit",b.i32_sub(b.getLocal("itBit"),b.getLocal("chunkSize"))),b.br(0))))}function w(){const B=t.addFunction(o+"_reduceTable");B.addParam("pTable","i32"),B.addParam("p","i32"),B.addLocal("half","i32"),B.addLocal("it1","i32"),B.addLocal("it2","i32"),B.addLocal("pAcc","i32");const b=B.getCodeBuilder();B.addCode(b.if(b.i32_eq(b.getLocal("p"),b.i32_const(1)),b.ret([])),b.setLocal("half",b.i32_shl(b.i32_const(1),b.i32_sub(b.getLocal("p"),b.i32_const(1)))),b.setLocal("it1",b.getLocal("pTable")),b.setLocal("it2",b.i32_add(b.getLocal("pTable"),b.i32_mul(b.getLocal("half"),b.i32_const(r)))),b.setLocal("pAcc",b.i32_sub(b.getLocal("it2"),b.i32_const(r))),b.block(b.loop(b.br_if(1,b.i32_eq(b.getLocal("it1"),b.getLocal("pAcc"))),b.call(n+"_add",b.getLocal("it1"),b.getLocal("it2"),b.getLocal("it1")),b.call(n+"_add",b.getLocal("pAcc"),b.getLocal("it2"),b.getLocal("pAcc")),b.setLocal("it1",b.i32_add(b.getLocal("it1"),b.i32_const(r))),b.setLocal("it2",b.i32_add(b.getLocal("it2"),b.i32_const(r))),b.br(0))),b.call(o+"_reduceTable",b.getLocal("pTable"),b.i32_sub(b.getLocal("p"),b.i32_const(1))),b.setLocal("p",b.i32_sub(b.getLocal("p"),b.i32_const(1))),b.block(b.loop(b.br_if(1,b.i32_eqz(b.getLocal("p"))),b.call(n+"_double",b.getLocal("pAcc"),b.getLocal("pAcc")),b.setLocal("p",b.i32_sub(b.getLocal("p"),b.i32_const(1))),b.br(0))),b.call(n+"_add",b.getLocal("pTable"),b.getLocal("pAcc"),b.getLocal("pTable")))}A(),w(),_(),s(),t.exportFunction(o),t.exportFunction(o+"_chunk")};const Ie=bc,Kn=mi,ye=Ic;var Pi=function(t,n,o,e){const l=t.modules[o].n64,h=l*8;if(t.modules[n])return n;t.modules[n]={n64:l*3};function r(){const p=t.addFunction(n+"_isZero");p.addParam("p1","i32"),p.setReturnType("i32");const i=p.getCodeBuilder();p.addCode(i.call(o+"_isZero",i.i32_add(i.getLocal("p1"),i.i32_const(h*2))))}function A(){const p=t.addFunction(n+"_isZeroAffine");p.addParam("p1","i32"),p.setReturnType("i32");const i=p.getCodeBuilder();p.addCode(i.i32_and(i.call(o+"_isZero",i.getLocal("p1")),i.call(o+"_isZero",i.i32_add(i.getLocal("p1"),i.i32_const(h)))))}function _(){const p=t.addFunction(n+"_copy");p.addParam("ps","i32"),p.addParam("pd","i32");const i=p.getCodeBuilder();for(let C=0;C<l*3;C++)p.addCode(i.i64_store(i.getLocal("pd"),C*8,i.i64_load(i.getLocal("ps"),C*8)))}function s(){const p=t.addFunction(n+"_copyAffine");p.addParam("ps","i32"),p.addParam("pd","i32");const i=p.getCodeBuilder();for(let C=0;C<l*2;C++)p.addCode(i.i64_store(i.getLocal("pd"),C*8,i.i64_load(i.getLocal("ps"),C*8)))}function w(){const p=t.addFunction(n+"_zero");p.addParam("pr","i32");const i=p.getCodeBuilder();p.addCode(i.call(o+"_zero",i.getLocal("pr"))),p.addCode(i.call(o+"_one",i.i32_add(i.getLocal("pr"),i.i32_const(h)))),p.addCode(i.call(o+"_zero",i.i32_add(i.getLocal("pr"),i.i32_const(h*2))))}function B(){const p=t.addFunction(n+"_zeroAffine");p.addParam("pr","i32");const i=p.getCodeBuilder();p.addCode(i.call(o+"_zero",i.getLocal("pr"))),p.addCode(i.call(o+"_zero",i.i32_add(i.getLocal("pr"),i.i32_const(h))))}function b(){const p=t.addFunction(n+"_eq");p.addParam("p1","i32"),p.addParam("p2","i32"),p.setReturnType("i32"),p.addLocal("z1","i32"),p.addLocal("z2","i32");const i=p.getCodeBuilder(),C=i.getLocal("p1"),c=i.i32_add(i.getLocal("p1"),i.i32_const(h));p.addCode(i.setLocal("z1",i.i32_add(i.getLocal("p1"),i.i32_const(h*2))));const m=i.getLocal("z1"),y=i.getLocal("p2"),f=i.i32_add(i.getLocal("p2"),i.i32_const(h));p.addCode(i.setLocal("z2",i.i32_add(i.getLocal("p2"),i.i32_const(h*2))));const S=i.getLocal("z2"),J=i.i32_const(t.alloc(h)),R=i.i32_const(t.alloc(h)),et=i.i32_const(t.alloc(h)),It=i.i32_const(t.alloc(h)),dt=i.i32_const(t.alloc(h)),pt=i.i32_const(t.alloc(h)),xt=i.i32_const(t.alloc(h)),gt=i.i32_const(t.alloc(h));p.addCode(i.if(i.call(n+"_isZero",i.getLocal("p1")),i.ret(i.call(n+"_isZero",i.getLocal("p2")))),i.if(i.call(n+"_isZero",i.getLocal("p2")),i.ret(i.i32_const(0))),i.if(i.call(o+"_isOne",m),i.ret(i.call(n+"_eqMixed",i.getLocal("p2"),i.getLocal("p1")))),i.if(i.call(o+"_isOne",S),i.ret(i.call(n+"_eqMixed",i.getLocal("p1"),i.getLocal("p2")))),i.call(o+"_square",m,J),i.call(o+"_square",S,R),i.call(o+"_mul",C,R,et),i.call(o+"_mul",y,J,It),i.call(o+"_mul",m,J,dt),i.call(o+"_mul",S,R,pt),i.call(o+"_mul",c,pt,xt),i.call(o+"_mul",f,dt,gt),i.if(i.call(o+"_eq",et,It),i.if(i.call(o+"_eq",xt,gt),i.ret(i.i32_const(1)))),i.ret(i.i32_const(0)))}function k(){const p=t.addFunction(n+"_eqMixed");p.addParam("p1","i32"),p.addParam("p2","i32"),p.setReturnType("i32"),p.addLocal("z1","i32");const i=p.getCodeBuilder(),C=i.getLocal("p1"),c=i.i32_add(i.getLocal("p1"),i.i32_const(h));p.addCode(i.setLocal("z1",i.i32_add(i.getLocal("p1"),i.i32_const(h*2))));const m=i.getLocal("z1"),y=i.getLocal("p2"),f=i.i32_add(i.getLocal("p2"),i.i32_const(h)),S=i.i32_const(t.alloc(h)),J=i.i32_const(t.alloc(h)),R=i.i32_const(t.alloc(h)),et=i.i32_const(t.alloc(h));p.addCode(i.if(i.call(n+"_isZero",i.getLocal("p1")),i.ret(i.call(n+"_isZeroAffine",i.getLocal("p2")))),i.if(i.call(n+"_isZeroAffine",i.getLocal("p2")),i.ret(i.i32_const(0))),i.if(i.call(o+"_isOne",m),i.ret(i.call(n+"_eqAffine",i.getLocal("p1"),i.getLocal("p2")))),i.call(o+"_square",m,S),i.call(o+"_mul",y,S,J),i.call(o+"_mul",m,S,R),i.call(o+"_mul",f,R,et),i.if(i.call(o+"_eq",C,J),i.if(i.call(o+"_eq",c,et),i.ret(i.i32_const(1)))),i.ret(i.i32_const(0)))}function D(){const p=t.addFunction(n+"_double");p.addParam("p1","i32"),p.addParam("pr","i32");const i=p.getCodeBuilder(),C=i.getLocal("p1"),c=i.i32_add(i.getLocal("p1"),i.i32_const(h)),m=i.i32_add(i.getLocal("p1"),i.i32_const(h*2)),y=i.getLocal("pr"),f=i.i32_add(i.getLocal("pr"),i.i32_const(h)),S=i.i32_add(i.getLocal("pr"),i.i32_const(h*2)),J=i.i32_const(t.alloc(h)),R=i.i32_const(t.alloc(h)),et=i.i32_const(t.alloc(h)),It=i.i32_const(t.alloc(h)),dt=i.i32_const(t.alloc(h)),pt=i.i32_const(t.alloc(h)),xt=i.i32_const(t.alloc(h)),gt=i.i32_const(t.alloc(h));p.addCode(i.if(i.call(n+"_isZero",i.getLocal("p1")),[...i.call(n+"_copy",i.getLocal("p1"),i.getLocal("pr")),...i.ret([])]),i.if(i.call(o+"_isOne",m),[...i.ret(i.call(n+"_doubleAffine",i.getLocal("p1"),i.getLocal("pr"))),...i.ret([])]),i.call(o+"_square",C,J),i.call(o+"_square",c,R),i.call(o+"_square",R,et),i.call(o+"_add",C,R,It),i.call(o+"_square",It,It),i.call(o+"_sub",It,J,It),i.call(o+"_sub",It,et,It),i.call(o+"_add",It,It,It),i.call(o+"_add",J,J,dt),i.call(o+"_add",dt,J,dt),i.call(o+"_square",dt,pt),i.call(o+"_mul",c,m,xt),i.call(o+"_add",It,It,y),i.call(o+"_sub",pt,y,y),i.call(o+"_add",et,et,gt),i.call(o+"_add",gt,gt,gt),i.call(o+"_add",gt,gt,gt),i.call(o+"_sub",It,y,f),i.call(o+"_mul",f,dt,f),i.call(o+"_sub",f,gt,f),i.call(o+"_add",xt,xt,S))}function F(){const p=t.addFunction(n+"_doubleAffine");p.addParam("p1","i32"),p.addParam("pr","i32");const i=p.getCodeBuilder(),C=i.getLocal("p1"),c=i.i32_add(i.getLocal("p1"),i.i32_const(h)),m=i.getLocal("pr"),y=i.i32_add(i.getLocal("pr"),i.i32_const(h)),f=i.i32_add(i.getLocal("pr"),i.i32_const(h*2)),S=i.i32_const(t.alloc(h)),J=i.i32_const(t.alloc(h)),R=i.i32_const(t.alloc(h)),et=i.i32_const(t.alloc(h)),It=i.i32_const(t.alloc(h)),dt=i.i32_const(t.alloc(h));p.addCode(i.if(i.call(n+"_isZeroAffine",i.getLocal("p1")),[...i.call(n+"_toJacobian",i.getLocal("p1"),i.getLocal("pr")),...i.ret([])]),i.call(o+"_square",C,S),i.call(o+"_square",c,J),i.call(o+"_square",J,R),i.call(o+"_add",C,J,et),i.call(o+"_square",et,et),i.call(o+"_sub",et,S,et),i.call(o+"_sub",et,R,et),i.call(o+"_add",et,et,et),i.call(o+"_add",S,S,It),i.call(o+"_add",It,S,It),i.call(o+"_add",c,c,f),i.call(o+"_square",It,m),i.call(o+"_sub",m,et,m),i.call(o+"_sub",m,et,m),i.call(o+"_add",R,R,dt),i.call(o+"_add",dt,dt,dt),i.call(o+"_add",dt,dt,dt),i.call(o+"_sub",et,m,y),i.call(o+"_mul",y,It,y),i.call(o+"_sub",y,dt,y))}function q(){const p=t.addFunction(n+"_eqAffine");p.addParam("p1","i32"),p.addParam("p2","i32"),p.setReturnType("i32"),p.addLocal("z1","i32");const i=p.getCodeBuilder();p.addCode(i.ret(i.i32_and(i.call(o+"_eq",i.getLocal("p1"),i.getLocal("p2")),i.call(o+"_eq",i.i32_add(i.getLocal("p1"),i.i32_const(h)),i.i32_add(i.getLocal("p2"),i.i32_const(h))))))}function x(){const p=t.addFunction(n+"_toMontgomery");p.addParam("p1","i32"),p.addParam("pr","i32");const i=p.getCodeBuilder();p.addCode(i.call(o+"_toMontgomery",i.getLocal("p1"),i.getLocal("pr")));for(let C=1;C<3;C++)p.addCode(i.call(o+"_toMontgomery",i.i32_add(i.getLocal("p1"),i.i32_const(C*h)),i.i32_add(i.getLocal("pr"),i.i32_const(C*h))))}function it(){const p=t.addFunction(n+"_toMontgomeryAffine");p.addParam("p1","i32"),p.addParam("pr","i32");const i=p.getCodeBuilder();p.addCode(i.call(o+"_toMontgomery",i.getLocal("p1"),i.getLocal("pr")));for(let C=1;C<2;C++)p.addCode(i.call(o+"_toMontgomery",i.i32_add(i.getLocal("p1"),i.i32_const(C*h)),i.i32_add(i.getLocal("pr"),i.i32_const(C*h))))}function z(){const p=t.addFunction(n+"_fromMontgomery");p.addParam("p1","i32"),p.addParam("pr","i32");const i=p.getCodeBuilder();p.addCode(i.call(o+"_fromMontgomery",i.getLocal("p1"),i.getLocal("pr")));for(let C=1;C<3;C++)p.addCode(i.call(o+"_fromMontgomery",i.i32_add(i.getLocal("p1"),i.i32_const(C*h)),i.i32_add(i.getLocal("pr"),i.i32_const(C*h))))}function lt(){const p=t.addFunction(n+"_fromMontgomeryAffine");p.addParam("p1","i32"),p.addParam("pr","i32");const i=p.getCodeBuilder();p.addCode(i.call(o+"_fromMontgomery",i.getLocal("p1"),i.getLocal("pr")));for(let C=1;C<2;C++)p.addCode(i.call(o+"_fromMontgomery",i.i32_add(i.getLocal("p1"),i.i32_const(C*h)),i.i32_add(i.getLocal("pr"),i.i32_const(C*h))))}function E(){const p=t.addFunction(n+"_add");p.addParam("p1","i32"),p.addParam("p2","i32"),p.addParam("pr","i32"),p.addLocal("z1","i32"),p.addLocal("z2","i32");const i=p.getCodeBuilder(),C=i.getLocal("p1"),c=i.i32_add(i.getLocal("p1"),i.i32_const(h));p.addCode(i.setLocal("z1",i.i32_add(i.getLocal("p1"),i.i32_const(h*2))));const m=i.getLocal("z1"),y=i.getLocal("p2"),f=i.i32_add(i.getLocal("p2"),i.i32_const(h));p.addCode(i.setLocal("z2",i.i32_add(i.getLocal("p2"),i.i32_const(h*2))));const S=i.getLocal("z2"),J=i.getLocal("pr"),R=i.i32_add(i.getLocal("pr"),i.i32_const(h)),et=i.i32_add(i.getLocal("pr"),i.i32_const(h*2)),It=i.i32_const(t.alloc(h)),dt=i.i32_const(t.alloc(h)),pt=i.i32_const(t.alloc(h)),xt=i.i32_const(t.alloc(h)),gt=i.i32_const(t.alloc(h)),rt=i.i32_const(t.alloc(h)),bt=i.i32_const(t.alloc(h)),vt=i.i32_const(t.alloc(h)),Mt=i.i32_const(t.alloc(h)),Kt=i.i32_const(t.alloc(h)),zt=i.i32_const(t.alloc(h)),Ht=i.i32_const(t.alloc(h)),qt=i.i32_const(t.alloc(h)),kt=i.i32_const(t.alloc(h)),Gt=i.i32_const(t.alloc(h)),an=i.i32_const(t.alloc(h)),Yt=i.i32_const(t.alloc(h));p.addCode(i.if(i.call(n+"_isZero",i.getLocal("p1")),[...i.call(n+"_copy",i.getLocal("p2"),i.getLocal("pr")),...i.ret([])]),i.if(i.call(n+"_isZero",i.getLocal("p2")),[...i.call(n+"_copy",i.getLocal("p1"),i.getLocal("pr")),...i.ret([])]),i.if(i.call(o+"_isOne",m),[...i.call(n+"_addMixed",y,C,J),...i.ret([])]),i.if(i.call(o+"_isOne",S),[...i.call(n+"_addMixed",C,y,J),...i.ret([])]),i.call(o+"_square",m,It),i.call(o+"_square",S,dt),i.call(o+"_mul",C,dt,pt),i.call(o+"_mul",y,It,xt),i.call(o+"_mul",m,It,gt),i.call(o+"_mul",S,dt,rt),i.call(o+"_mul",c,rt,bt),i.call(o+"_mul",f,gt,vt),i.if(i.call(o+"_eq",pt,xt),i.if(i.call(o+"_eq",bt,vt),[...i.call(n+"_double",i.getLocal("p1"),i.getLocal("pr")),...i.ret([])])),i.call(o+"_sub",xt,pt,Mt),i.call(o+"_sub",vt,bt,Kt),i.call(o+"_add",Mt,Mt,zt),i.call(o+"_square",zt,zt),i.call(o+"_mul",Mt,zt,Ht),i.call(o+"_add",Kt,Kt,qt),i.call(o+"_mul",pt,zt,Gt),i.call(o+"_square",qt,kt),i.call(o+"_add",Gt,Gt,an),i.call(o+"_sub",kt,Ht,J),i.call(o+"_sub",J,an,J),i.call(o+"_mul",bt,Ht,Yt),i.call(o+"_add",Yt,Yt,Yt),i.call(o+"_sub",Gt,J,R),i.call(o+"_mul",R,qt,R),i.call(o+"_sub",R,Yt,R),i.call(o+"_add",m,S,et),i.call(o+"_square",et,et),i.call(o+"_sub",et,It,et),i.call(o+"_sub",et,dt,et),i.call(o+"_mul",et,Mt,et))}function u(){const p=t.addFunction(n+"_addMixed");p.addParam("p1","i32"),p.addParam("p2","i32"),p.addParam("pr","i32"),p.addLocal("z1","i32");const i=p.getCodeBuilder(),C=i.getLocal("p1"),c=i.i32_add(i.getLocal("p1"),i.i32_const(h));p.addCode(i.setLocal("z1",i.i32_add(i.getLocal("p1"),i.i32_const(h*2))));const m=i.getLocal("z1"),y=i.getLocal("p2"),f=i.i32_add(i.getLocal("p2"),i.i32_const(h)),S=i.getLocal("pr"),J=i.i32_add(i.getLocal("pr"),i.i32_const(h)),R=i.i32_add(i.getLocal("pr"),i.i32_const(h*2)),et=i.i32_const(t.alloc(h)),It=i.i32_const(t.alloc(h)),dt=i.i32_const(t.alloc(h)),pt=i.i32_const(t.alloc(h)),xt=i.i32_const(t.alloc(h)),gt=i.i32_const(t.alloc(h)),rt=i.i32_const(t.alloc(h)),bt=i.i32_const(t.alloc(h)),vt=i.i32_const(t.alloc(h)),Mt=i.i32_const(t.alloc(h)),Kt=i.i32_const(t.alloc(h)),zt=i.i32_const(t.alloc(h)),Ht=i.i32_const(t.alloc(h)),qt=i.i32_const(t.alloc(h));p.addCode(i.if(i.call(n+"_isZero",i.getLocal("p1")),[...i.call(n+"_copyAffine",i.getLocal("p2"),i.getLocal("pr")),...i.call(o+"_one",i.i32_add(i.getLocal("pr"),i.i32_const(h*2))),...i.ret([])]),i.if(i.call(n+"_isZeroAffine",i.getLocal("p2")),[...i.call(n+"_copy",i.getLocal("p1"),i.getLocal("pr")),...i.ret([])]),i.if(i.call(o+"_isOne",m),[...i.call(n+"_addAffine",C,y,S),...i.ret([])]),i.call(o+"_square",m,et),i.call(o+"_mul",y,et,It),i.call(o+"_mul",m,et,dt),i.call(o+"_mul",f,dt,pt),i.if(i.call(o+"_eq",C,It),i.if(i.call(o+"_eq",c,pt),[...i.call(n+"_doubleAffine",i.getLocal("p2"),i.getLocal("pr")),...i.ret([])])),i.call(o+"_sub",It,C,xt),i.call(o+"_sub",pt,c,rt),i.call(o+"_square",xt,gt),i.call(o+"_add",gt,gt,bt),i.call(o+"_add",bt,bt,bt),i.call(o+"_mul",xt,bt,vt),i.call(o+"_add",rt,rt,Mt),i.call(o+"_mul",C,bt,zt),i.call(o+"_square",Mt,Kt),i.call(o+"_add",zt,zt,Ht),i.call(o+"_sub",Kt,vt,S),i.call(o+"_sub",S,Ht,S),i.call(o+"_mul",c,vt,qt),i.call(o+"_add",qt,qt,qt),i.call(o+"_sub",zt,S,J),i.call(o+"_mul",J,Mt,J),i.call(o+"_sub",J,qt,J),i.call(o+"_add",m,xt,R),i.call(o+"_square",R,R),i.call(o+"_sub",R,et,R),i.call(o+"_sub",R,gt,R))}function L(){const p=t.addFunction(n+"_addAffine");p.addParam("p1","i32"),p.addParam("p2","i32"),p.addParam("pr","i32"),p.addLocal("z1","i32");const i=p.getCodeBuilder(),C=i.getLocal("p1"),c=i.i32_add(i.getLocal("p1"),i.i32_const(h));p.addCode(i.setLocal("z1",i.i32_add(i.getLocal("p1"),i.i32_const(h*2))));const m=i.getLocal("p2"),y=i.i32_add(i.getLocal("p2"),i.i32_const(h)),f=i.getLocal("pr"),S=i.i32_add(i.getLocal("pr"),i.i32_const(h)),J=i.i32_add(i.getLocal("pr"),i.i32_const(h*2)),R=i.i32_const(t.alloc(h)),et=i.i32_const(t.alloc(h)),It=i.i32_const(t.alloc(h)),dt=i.i32_const(t.alloc(h)),pt=i.i32_const(t.alloc(h)),xt=i.i32_const(t.alloc(h)),gt=i.i32_const(t.alloc(h)),rt=i.i32_const(t.alloc(h)),bt=i.i32_const(t.alloc(h)),vt=i.i32_const(t.alloc(h));p.addCode(i.if(i.call(n+"_isZeroAffine",i.getLocal("p1")),[...i.call(n+"_copyAffine",i.getLocal("p2"),i.getLocal("pr")),...i.call(o+"_one",i.i32_add(i.getLocal("pr"),i.i32_const(h*2))),...i.ret([])]),i.if(i.call(n+"_isZeroAffine",i.getLocal("p2")),[...i.call(n+"_copyAffine",i.getLocal("p1"),i.getLocal("pr")),...i.call(o+"_one",i.i32_add(i.getLocal("pr"),i.i32_const(h*2))),...i.ret([])]),i.if(i.call(o+"_eq",C,m),i.if(i.call(o+"_eq",c,y),[...i.call(n+"_doubleAffine",i.getLocal("p2"),i.getLocal("pr")),...i.ret([])])),i.call(o+"_sub",m,C,R),i.call(o+"_sub",y,c,It),i.call(o+"_square",R,et),i.call(o+"_add",et,et,dt),i.call(o+"_add",dt,dt,dt),i.call(o+"_mul",R,dt,pt),i.call(o+"_add",It,It,xt),i.call(o+"_mul",C,dt,rt),i.call(o+"_square",xt,gt),i.call(o+"_add",rt,rt,bt),i.call(o+"_sub",gt,pt,f),i.call(o+"_sub",f,bt,f),i.call(o+"_mul",c,pt,vt),i.call(o+"_add",vt,vt,vt),i.call(o+"_sub",rt,f,S),i.call(o+"_mul",S,xt,S),i.call(o+"_sub",S,vt,S),i.call(o+"_add",R,R,J))}function V(){const p=t.addFunction(n+"_neg");p.addParam("p1","i32"),p.addParam("pr","i32");const i=p.getCodeBuilder(),C=i.getLocal("p1"),c=i.i32_add(i.getLocal("p1"),i.i32_const(h)),m=i.i32_add(i.getLocal("p1"),i.i32_const(h*2)),y=i.getLocal("pr"),f=i.i32_add(i.getLocal("pr"),i.i32_const(h)),S=i.i32_add(i.getLocal("pr"),i.i32_const(h*2));p.addCode(i.call(o+"_copy",C,y),i.call(o+"_neg",c,f),i.call(o+"_copy",m,S))}function j(){const p=t.addFunction(n+"_negAffine");p.addParam("p1","i32"),p.addParam("pr","i32");const i=p.getCodeBuilder(),C=i.getLocal("p1"),c=i.i32_add(i.getLocal("p1"),i.i32_const(h)),m=i.getLocal("pr"),y=i.i32_add(i.getLocal("pr"),i.i32_const(h));p.addCode(i.call(o+"_copy",C,m),i.call(o+"_neg",c,y))}function X(){const p=t.addFunction(n+"_sub");p.addParam("p1","i32"),p.addParam("p2","i32"),p.addParam("pr","i32");const i=p.getCodeBuilder(),C=i.i32_const(t.alloc(h*3));p.addCode(i.call(n+"_neg",i.getLocal("p2"),C),i.call(n+"_add",i.getLocal("p1"),C,i.getLocal("pr")))}function P(){const p=t.addFunction(n+"_subMixed");p.addParam("p1","i32"),p.addParam("p2","i32"),p.addParam("pr","i32");const i=p.getCodeBuilder(),C=i.i32_const(t.alloc(h*3));p.addCode(i.call(n+"_negAffine",i.getLocal("p2"),C),i.call(n+"_addMixed",i.getLocal("p1"),C,i.getLocal("pr")))}function I(){const p=t.addFunction(n+"_subAffine");p.addParam("p1","i32"),p.addParam("p2","i32"),p.addParam("pr","i32");const i=p.getCodeBuilder(),C=i.i32_const(t.alloc(h*3));p.addCode(i.call(n+"_negAffine",i.getLocal("p2"),C),i.call(n+"_addAffine",i.getLocal("p1"),C,i.getLocal("pr")))}function v(){const p=t.addFunction(n+"_normalize");p.addParam("p1","i32"),p.addParam("pr","i32");const i=p.getCodeBuilder(),C=i.getLocal("p1"),c=i.i32_add(i.getLocal("p1"),i.i32_const(h)),m=i.i32_add(i.getLocal("p1"),i.i32_const(h*2)),y=i.getLocal("pr"),f=i.i32_add(i.getLocal("pr"),i.i32_const(h)),S=i.i32_add(i.getLocal("pr"),i.i32_const(h*2)),J=i.i32_const(t.alloc(h)),R=i.i32_const(t.alloc(h)),et=i.i32_const(t.alloc(h));p.addCode(i.if(i.call(n+"_isZero",i.getLocal("p1")),i.call(n+"_zero",i.getLocal("pr")),[...i.call(o+"_inverse",m,J),...i.call(o+"_square",J,R),...i.call(o+"_mul",J,R,et),...i.call(o+"_mul",C,R,y),...i.call(o+"_mul",c,et,f),...i.call(o+"_one",S)]))}function T(){const p=t.addFunction(n+"_toAffine");p.addParam("p1","i32"),p.addParam("pr","i32");const i=p.getCodeBuilder(),C=i.getLocal("p1"),c=i.i32_add(i.getLocal("p1"),i.i32_const(h)),m=i.i32_add(i.getLocal("p1"),i.i32_const(h*2)),y=i.getLocal("pr"),f=i.i32_add(i.getLocal("pr"),i.i32_const(h)),S=i.i32_const(t.alloc(h)),J=i.i32_const(t.alloc(h)),R=i.i32_const(t.alloc(h));p.addCode(i.if(i.call(n+"_isZero",i.getLocal("p1")),[...i.call(o+"_zero",y),...i.call(o+"_zero",f)],[...i.call(o+"_inverse",m,S),...i.call(o+"_square",S,J),...i.call(o+"_mul",S,J,R),...i.call(o+"_mul",C,J,y),...i.call(o+"_mul",c,R,f)]))}function ot(){const p=t.addFunction(n+"_toJacobian");p.addParam("p1","i32"),p.addParam("pr","i32");const i=p.getCodeBuilder(),C=i.getLocal("p1"),c=i.i32_add(i.getLocal("p1"),i.i32_const(h)),m=i.getLocal("pr"),y=i.i32_add(i.getLocal("pr"),i.i32_const(h)),f=i.i32_add(i.getLocal("pr"),i.i32_const(h*2));p.addCode(i.if(i.call(n+"_isZeroAffine",i.getLocal("p1")),i.call(n+"_zero",i.getLocal("pr")),[...i.call(o+"_one",f),...i.call(o+"_copy",c,y),...i.call(o+"_copy",C,m)]))}function tt(){const p=t.addFunction(n+"_batchToAffine");p.addParam("pIn","i32"),p.addParam("n","i32"),p.addParam("pOut","i32"),p.addLocal("pAux","i32"),p.addLocal("itIn","i32"),p.addLocal("itAux","i32"),p.addLocal("itOut","i32"),p.addLocal("i","i32");const i=p.getCodeBuilder(),C=i.i32_const(t.alloc(h));p.addCode(i.setLocal("pAux",i.i32_load(i.i32_const(0))),i.i32_store(i.i32_const(0),i.i32_add(i.getLocal("pAux"),i.i32_mul(i.getLocal("n"),i.i32_const(h)))),i.call(o+"_batchInverse",i.i32_add(i.getLocal("pIn"),i.i32_const(h*2)),i.i32_const(h*3),i.getLocal("n"),i.getLocal("pAux"),i.i32_const(h)),i.setLocal("itIn",i.getLocal("pIn")),i.setLocal("itAux",i.getLocal("pAux")),i.setLocal("itOut",i.getLocal("pOut")),i.setLocal("i",i.i32_const(0)),i.block(i.loop(i.br_if(1,i.i32_eq(i.getLocal("i"),i.getLocal("n"))),i.if(i.call(o+"_isZero",i.getLocal("itAux")),[...i.call(o+"_zero",i.getLocal("itOut")),...i.call(o+"_zero",i.i32_add(i.getLocal("itOut"),i.i32_const(h)))],[...i.call(o+"_mul",i.getLocal("itAux"),i.i32_add(i.getLocal("itIn"),i.i32_const(h)),C),...i.call(o+"_square",i.getLocal("itAux"),i.getLocal("itAux")),...i.call(o+"_mul",i.getLocal("itAux"),i.getLocal("itIn"),i.getLocal("itOut")),...i.call(o+"_mul",i.getLocal("itAux"),C,i.i32_add(i.getLocal("itOut"),i.i32_const(h)))]),i.setLocal("itIn",i.i32_add(i.getLocal("itIn"),i.i32_const(h*3))),i.setLocal("itOut",i.i32_add(i.getLocal("itOut"),i.i32_const(h*2))),i.setLocal("itAux",i.i32_add(i.getLocal("itAux"),i.i32_const(h))),i.setLocal("i",i.i32_add(i.getLocal("i"),i.i32_const(1))),i.br(0))),i.i32_store(i.i32_const(0),i.getLocal("pAux")))}function K(){const p=t.addFunction(n+"__reverseBytes");p.addParam("pIn","i32"),p.addParam("n","i32"),p.addParam("pOut","i32"),p.addLocal("itOut","i32"),p.addLocal("itIn","i32");const i=p.getCodeBuilder();p.addCode(i.setLocal("itOut",i.i32_sub(i.i32_add(i.getLocal("pOut"),i.getLocal("n")),i.i32_const(1))),i.setLocal("itIn",i.getLocal("pIn")),i.block(i.loop(i.br_if(1,i.i32_lt_s(i.getLocal("itOut"),i.getLocal("pOut"))),i.i32_store8(i.getLocal("itOut"),i.i32_load8_u(i.getLocal("itIn"))),i.setLocal("itOut",i.i32_sub(i.getLocal("itOut"),i.i32_const(1))),i.setLocal("itIn",i.i32_add(i.getLocal("itIn"),i.i32_const(1))),i.br(0))))}function at(){const p=t.addFunction(n+"_LEMtoC");p.addParam("pIn","i32"),p.addParam("pOut","i32");const i=p.getCodeBuilder(),C=i.i32_const(t.alloc(h));p.addCode(i.if(i.call(n+"_isZeroAffine",i.getLocal("pIn")),[...i.call(o+"_zero",i.getLocal("pOut")),...i.i32_store8(i.getLocal("pOut"),i.i32_const(64)),...i.ret([])]),i.call(o+"_fromMontgomery",i.getLocal("pIn"),C),i.call(n+"__reverseBytes",C,i.i32_const(h),i.getLocal("pOut")),i.if(i.i32_eq(i.call(o+"_sign",i.i32_add(i.getLocal("pIn"),i.i32_const(h))),i.i32_const(-1)),i.i32_store8(i.getLocal("pOut"),i.i32_or(i.i32_load8_u(i.getLocal("pOut")),i.i32_const(128)))))}function W(){const p=t.addFunction(n+"_LEMtoU");p.addParam("pIn","i32"),p.addParam("pOut","i32");const i=p.getCodeBuilder(),C=t.alloc(h*2),c=i.i32_const(C),m=i.i32_const(C),y=i.i32_const(C+h);p.addCode(i.if(i.call(n+"_isZeroAffine",i.getLocal("pIn")),[...i.call(n+"_zeroAffine",i.getLocal("pOut")),...i.ret([])]),i.call(n+"_fromMontgomeryAffine",i.getLocal("pIn"),c),i.call(n+"__reverseBytes",m,i.i32_const(h),i.getLocal("pOut")),i.call(n+"__reverseBytes",y,i.i32_const(h),i.i32_add(i.getLocal("pOut"),i.i32_const(h))))}function ct(){const p=t.addFunction(n+"_UtoLEM");p.addParam("pIn","i32"),p.addParam("pOut","i32");const i=p.getCodeBuilder(),C=t.alloc(h*2),c=i.i32_const(C),m=i.i32_const(C),y=i.i32_const(C+h);p.addCode(i.if(i.i32_and(i.i32_load8_u(i.getLocal("pIn")),i.i32_const(64)),[...i.call(n+"_zeroAffine",i.getLocal("pOut")),...i.ret([])]),i.call(n+"__reverseBytes",i.getLocal("pIn"),i.i32_const(h),m),i.call(n+"__reverseBytes",i.i32_add(i.getLocal("pIn"),i.i32_const(h)),i.i32_const(h),y),i.call(n+"_toMontgomeryAffine",c,i.getLocal("pOut")))}function Lt(){const p=t.addFunction(n+"_CtoLEM");p.addParam("pIn","i32"),p.addParam("pOut","i32"),p.addLocal("firstByte","i32"),p.addLocal("greatest","i32");const i=p.getCodeBuilder(),C=t.alloc(h*2),c=i.i32_const(C),m=i.i32_const(C+h);p.addCode(i.setLocal("firstByte",i.i32_load8_u(i.getLocal("pIn"))),i.if(i.i32_and(i.getLocal("firstByte"),i.i32_const(64)),[...i.call(n+"_zeroAffine",i.getLocal("pOut")),...i.ret([])]),i.setLocal("greatest",i.i32_and(i.getLocal("firstByte"),i.i32_const(128))),i.call(o+"_copy",i.getLocal("pIn"),m),i.i32_store8(m,i.i32_and(i.getLocal("firstByte"),i.i32_const(63))),i.call(n+"__reverseBytes",m,i.i32_const(h),c),i.call(o+"_toMontgomery",c,i.getLocal("pOut")),i.call(o+"_square",i.getLocal("pOut"),m),i.call(o+"_mul",i.getLocal("pOut"),m,m),i.call(o+"_add",m,i.i32_const(e),m),i.call(o+"_sqrt",m,m),i.call(o+"_neg",m,c),i.if(i.i32_eq(i.call(o+"_sign",m),i.i32_const(-1)),i.if(i.getLocal("greatest"),i.call(o+"_copy",m,i.i32_add(i.getLocal("pOut"),i.i32_const(h))),i.call(o+"_neg",m,i.i32_add(i.getLocal("pOut"),i.i32_const(h)))),i.if(i.getLocal("greatest"),i.call(o+"_neg",m,i.i32_add(i.getLocal("pOut"),i.i32_const(h))),i.call(o+"_copy",m,i.i32_add(i.getLocal("pOut"),i.i32_const(h))))))}function wt(){const p=t.addFunction(n+"_inCurveAffine");p.addParam("pIn","i32"),p.setReturnType("i32");const i=p.getCodeBuilder(),C=i.getLocal("pIn"),c=i.i32_add(i.getLocal("pIn"),i.i32_const(h)),m=i.i32_const(t.alloc(h)),y=i.i32_const(t.alloc(h));p.addCode(i.call(o+"_square",c,m),i.call(o+"_square",C,y),i.call(o+"_mul",C,y,y),i.call(o+"_add",y,i.i32_const(e),y),i.ret(i.call(o+"_eq",m,y)))}function ht(){const p=t.addFunction(n+"_inCurve");p.addParam("pIn","i32"),p.setReturnType("i32");const i=p.getCodeBuilder(),C=i.i32_const(t.alloc(h*2));p.addCode(i.call(n+"_toAffine",i.getLocal("pIn"),C),i.ret(i.call(n+"_inCurveAffine",C)))}return A(),r(),B(),w(),s(),_(),ot(),q(),k(),b(),F(),D(),L(),u(),E(),j(),V(),I(),P(),X(),lt(),z(),it(),x(),T(),wt(),ht(),tt(),v(),K(),W(),at(),ct(),Lt(),Kn(t,n+"_batchLEMtoU",n+"_LEMtoU",h*2,h*2),Kn(t,n+"_batchLEMtoC",n+"_LEMtoC",h*2,h),Kn(t,n+"_batchUtoLEM",n+"_UtoLEM",h*2,h*2),Kn(t,n+"_batchCtoLEM",n+"_CtoLEM",h,h*2,!0),Kn(t,n+"_batchToJacobian",n+"_toJacobian",h*2,h*3,!0),ye(t,n,n+"_multiexp",n+"_add",h*3),ye(t,n,n+"_multiexpAffine",n+"_addMixed",h*2),Ie(t,n+"_timesScalar",h*3,n+"_add",n+"_double",n+"_sub",n+"_copy",n+"_zero"),Ie(t,n+"_timesScalarAffine",h*2,n+"_addMixed",n+"_double",n+"_subMixed",n+"_copyAffine",n+"_zero"),t.exportFunction(n+"_isZero"),t.exportFunction(n+"_isZeroAffine"),t.exportFunction(n+"_eq"),t.exportFunction(n+"_eqMixed"),t.exportFunction(n+"_eqAffine"),t.exportFunction(n+"_copy"),t.exportFunction(n+"_copyAffine"),t.exportFunction(n+"_zero"),t.exportFunction(n+"_zeroAffine"),t.exportFunction(n+"_double"),t.exportFunction(n+"_doubleAffine"),t.exportFunction(n+"_add"),t.exportFunction(n+"_addMixed"),t.exportFunction(n+"_addAffine"),t.exportFunction(n+"_neg"),t.exportFunction(n+"_negAffine"),t.exportFunction(n+"_sub"),t.exportFunction(n+"_subMixed"),t.exportFunction(n+"_subAffine"),t.exportFunction(n+"_fromMontgomery"),t.exportFunction(n+"_fromMontgomeryAffine"),t.exportFunction(n+"_toMontgomery"),t.exportFunction(n+"_toMontgomeryAffine"),t.exportFunction(n+"_timesScalar"),t.exportFunction(n+"_timesScalarAffine"),t.exportFunction(n+"_normalize"),t.exportFunction(n+"_LEMtoU"),t.exportFunction(n+"_LEMtoC"),t.exportFunction(n+"_UtoLEM"),t.exportFunction(n+"_CtoLEM"),t.exportFunction(n+"_batchLEMtoU"),t.exportFunction(n+"_batchLEMtoC"),t.exportFunction(n+"_batchUtoLEM"),t.exportFunction(n+"_batchCtoLEM"),t.exportFunction(n+"_toAffine"),t.exportFunction(n+"_toJacobian"),t.exportFunction(n+"_batchToAffine"),t.exportFunction(n+"_batchToJacobian"),t.exportFunction(n+"_inCurve"),t.exportFunction(n+"_inCurveAffine"),n};const{isOdd:yc,modInv:Ce,modPow:Hn}=jt,lo=wn;var Qi=function(t,n,o,e,l){const r=t.modules[e].n64*8,_=t.modules[o].n64*8,s=t.modules[e].q;let w=s-1n,B=0;for(;!yc(w);)B++,w=w>>1n;let b=2n;for(;Hn(b,s>>1n,s)===1n;)b=b+1n;const k=new Array(B+1);k[B]=Hn(b,w,s);let D=B-1;for(;D>=0;)k[D]=Hn(k[D+1],2n,s),D--;const F=[],q=(1n<<BigInt(r*8))%s;for(let C=0;C<k.length;C++){const c=k[C]*q%s;F.push(...lo.bigInt2BytesLE(c,r))}const x=t.alloc(F),it=new Array(B+1);it[0]=1n;for(let C=1;C<=B;C++)it[C]=it[C-1]*2n;const z=[];for(let C=0;C<=B;C++){const c=Ce(it[C],s)*q%s;z.push(...lo.bigInt2BytesLE(c,r))}const lt=t.alloc(z),E=Hn(b,2n,s),u=[],L=[];for(let C=0;C<=B;C++){const c=Hn(E,2n**BigInt(C),s),m=Ce(s+1n-c,s);u.push(...lo.bigInt2BytesLE(c*q%s,r)),L.push(...lo.bigInt2BytesLE(m*q%s,r))}const V=t.alloc(u),j=t.alloc(L);function X(C){let c=0;for(let m=0;m<8;m++)C&1<<m&&(c=c|128>>m);return c}const P=Array(256);for(let C=0;C<256;C++)P[C]=X(C);const I=t.alloc(P);function v(){const C=t.addFunction(n+"__log2");C.addParam("n","i32"),C.setReturnType("i32"),C.addLocal("bits","i32"),C.addLocal("aux","i32");const c=C.getCodeBuilder();C.addCode(c.setLocal("aux",c.i32_shr_u(c.getLocal("n"),c.i32_const(1)))),C.addCode(c.setLocal("bits",c.i32_const(0))),C.addCode(c.block(c.loop(c.br_if(1,c.i32_eqz(c.getLocal("aux"))),c.setLocal("aux",c.i32_shr_u(c.getLocal("aux"),c.i32_const(1))),c.setLocal("bits",c.i32_add(c.getLocal("bits"),c.i32_const(1))),c.br(0)))),C.addCode(c.if(c.i32_ne(c.getLocal("n"),c.i32_shl(c.i32_const(1),c.getLocal("bits"))),c.unreachable())),C.addCode(c.if(c.i32_gt_u(c.getLocal("bits"),c.i32_const(B)),c.unreachable())),C.addCode(c.getLocal("bits"))}function T(){const C=t.addFunction(n+"_fft");C.addParam("px","i32"),C.addParam("n","i32"),C.addLocal("bits","i32");const c=C.getCodeBuilder(),m=c.i32_const(t.alloc(r));C.addCode(c.setLocal("bits",c.call(n+"__log2",c.getLocal("n"))),c.call(e+"_one",m),c.call(n+"_rawfft",c.getLocal("px"),c.getLocal("bits"),c.i32_const(0),m))}function ot(){const C=t.addFunction(n+"_ifft");C.addParam("px","i32"),C.addParam("n","i32"),C.addLocal("bits","i32"),C.addLocal("pInv2","i32");const c=C.getCodeBuilder();C.addCode(c.setLocal("bits",c.call(n+"__log2",c.getLocal("n"))),c.setLocal("pInv2",c.i32_add(c.i32_const(lt),c.i32_mul(c.getLocal("bits"),c.i32_const(r)))),c.call(n+"_rawfft",c.getLocal("px"),c.getLocal("bits"),c.i32_const(1),c.getLocal("pInv2")))}function tt(){const C=t.addFunction(n+"_rawfft");C.addParam("px","i32"),C.addParam("bits","i32"),C.addParam("reverse","i32"),C.addParam("mulFactor","i32"),C.addLocal("s","i32"),C.addLocal("k","i32"),C.addLocal("j","i32"),C.addLocal("m","i32"),C.addLocal("mdiv2","i32"),C.addLocal("n","i32"),C.addLocal("pwm","i32"),C.addLocal("idx1","i32"),C.addLocal("idx2","i32");const c=C.getCodeBuilder(),m=c.i32_const(t.alloc(r)),y=c.i32_const(t.alloc(_)),f=c.i32_const(t.alloc(_));C.addCode(c.call(n+"__reversePermutation",c.getLocal("px"),c.getLocal("bits")),c.setLocal("n",c.i32_shl(c.i32_const(1),c.getLocal("bits"))),c.setLocal("s",c.i32_const(1)),c.block(c.loop(c.br_if(1,c.i32_gt_u(c.getLocal("s"),c.getLocal("bits"))),c.setLocal("m",c.i32_shl(c.i32_const(1),c.getLocal("s"))),c.setLocal("pwm",c.i32_add(c.i32_const(x),c.i32_mul(c.getLocal("s"),c.i32_const(r)))),c.setLocal("k",c.i32_const(0)),c.block(c.loop(c.br_if(1,c.i32_ge_u(c.getLocal("k"),c.getLocal("n"))),c.call(e+"_one",m),c.setLocal("mdiv2",c.i32_shr_u(c.getLocal("m"),c.i32_const(1))),c.setLocal("j",c.i32_const(0)),c.block(c.loop(c.br_if(1,c.i32_ge_u(c.getLocal("j"),c.getLocal("mdiv2"))),c.setLocal("idx1",c.i32_add(c.getLocal("px"),c.i32_mul(c.i32_add(c.getLocal("k"),c.getLocal("j")),c.i32_const(_)))),c.setLocal("idx2",c.i32_add(c.getLocal("idx1"),c.i32_mul(c.getLocal("mdiv2"),c.i32_const(_)))),c.call(l,c.getLocal("idx2"),m,y),c.call(o+"_copy",c.getLocal("idx1"),f),c.call(o+"_add",f,y,c.getLocal("idx1")),c.call(o+"_sub",f,y,c.getLocal("idx2")),c.call(e+"_mul",m,c.getLocal("pwm"),m),c.setLocal("j",c.i32_add(c.getLocal("j"),c.i32_const(1))),c.br(0))),c.setLocal("k",c.i32_add(c.getLocal("k"),c.getLocal("m"))),c.br(0))),c.setLocal("s",c.i32_add(c.getLocal("s"),c.i32_const(1))),c.br(0))),c.call(n+"__fftFinal",c.getLocal("px"),c.getLocal("bits"),c.getLocal("reverse"),c.getLocal("mulFactor")))}function K(){const C=t.addFunction(n+"__fftFinal");C.addParam("px","i32"),C.addParam("bits","i32"),C.addParam("reverse","i32"),C.addParam("mulFactor","i32"),C.addLocal("n","i32"),C.addLocal("ndiv2","i32"),C.addLocal("pInv2","i32"),C.addLocal("i","i32"),C.addLocal("mask","i32"),C.addLocal("idx1","i32"),C.addLocal("idx2","i32");const c=C.getCodeBuilder(),m=c.i32_const(t.alloc(_));C.addCode(c.if(c.i32_and(c.i32_eqz(c.getLocal("reverse")),c.call(e+"_isOne",c.getLocal("mulFactor"))),c.ret([])),c.setLocal("n",c.i32_shl(c.i32_const(1),c.getLocal("bits"))),c.setLocal("mask",c.i32_sub(c.getLocal("n"),c.i32_const(1))),c.setLocal("i",c.i32_const(1)),c.setLocal("ndiv2",c.i32_shr_u(c.getLocal("n"),c.i32_const(1))),c.block(c.loop(c.br_if(1,c.i32_ge_u(c.getLocal("i"),c.getLocal("ndiv2"))),c.setLocal("idx1",c.i32_add(c.getLocal("px"),c.i32_mul(c.getLocal("i"),c.i32_const(_)))),c.setLocal("idx2",c.i32_add(c.getLocal("px"),c.i32_mul(c.i32_sub(c.getLocal("n"),c.getLocal("i")),c.i32_const(_)))),c.if(c.getLocal("reverse"),c.if(c.call(e+"_isOne",c.getLocal("mulFactor")),[...c.call(o+"_copy",c.getLocal("idx1"),m),...c.call(o+"_copy",c.getLocal("idx2"),c.getLocal("idx1")),...c.call(o+"_copy",m,c.getLocal("idx2"))],[...c.call(o+"_copy",c.getLocal("idx1"),m),...c.call(l,c.getLocal("idx2"),c.getLocal("mulFactor"),c.getLocal("idx1")),...c.call(l,m,c.getLocal("mulFactor"),c.getLocal("idx2"))]),c.if(c.call(e+"_isOne",c.getLocal("mulFactor")),[],[...c.call(l,c.getLocal("idx1"),c.getLocal("mulFactor"),c.getLocal("idx1")),...c.call(l,c.getLocal("idx2"),c.getLocal("mulFactor"),c.getLocal("idx2"))])),c.setLocal("i",c.i32_add(c.getLocal("i"),c.i32_const(1))),c.br(0))),c.if(c.call(e+"_isOne",c.getLocal("mulFactor")),[],[...c.call(l,c.getLocal("px"),c.getLocal("mulFactor"),c.getLocal("px")),...c.setLocal("idx2",c.i32_add(c.getLocal("px"),c.i32_mul(c.getLocal("ndiv2"),c.i32_const(_)))),...c.call(l,c.getLocal("idx2"),c.getLocal("mulFactor"),c.getLocal("idx2"))]))}function at(){const C=t.addFunction(n+"__reversePermutation");C.addParam("px","i32"),C.addParam("bits","i32"),C.addLocal("n","i32"),C.addLocal("i","i32"),C.addLocal("ri","i32"),C.addLocal("idx1","i32"),C.addLocal("idx2","i32");const c=C.getCodeBuilder(),m=c.i32_const(t.alloc(_));C.addCode(c.setLocal("n",c.i32_shl(c.i32_const(1),c.getLocal("bits"))),c.setLocal("i",c.i32_const(0)),c.block(c.loop(c.br_if(1,c.i32_eq(c.getLocal("i"),c.getLocal("n"))),c.setLocal("idx1",c.i32_add(c.getLocal("px"),c.i32_mul(c.getLocal("i"),c.i32_const(_)))),c.setLocal("ri",c.call(n+"__rev",c.getLocal("i"),c.getLocal("bits"))),c.setLocal("idx2",c.i32_add(c.getLocal("px"),c.i32_mul(c.getLocal("ri"),c.i32_const(_)))),c.if(c.i32_lt_u(c.getLocal("i"),c.getLocal("ri")),[...c.call(o+"_copy",c.getLocal("idx1"),m),...c.call(o+"_copy",c.getLocal("idx2"),c.getLocal("idx1")),...c.call(o+"_copy",m,c.getLocal("idx2"))]),c.setLocal("i",c.i32_add(c.getLocal("i"),c.i32_const(1))),c.br(0))))}function W(){const C=t.addFunction(n+"__rev");C.addParam("x","i32"),C.addParam("bits","i32"),C.setReturnType("i32");const c=C.getCodeBuilder();C.addCode(c.i32_rotl(c.i32_add(c.i32_add(c.i32_shl(c.i32_load8_u(c.i32_and(c.getLocal("x"),c.i32_const(255)),I,0),c.i32_const(24)),c.i32_shl(c.i32_load8_u(c.i32_and(c.i32_shr_u(c.getLocal("x"),c.i32_const(8)),c.i32_const(255)),I,0),c.i32_const(16))),c.i32_add(c.i32_shl(c.i32_load8_u(c.i32_and(c.i32_shr_u(c.getLocal("x"),c.i32_const(16)),c.i32_const(255)),I,0),c.i32_const(8)),c.i32_load8_u(c.i32_and(c.i32_shr_u(c.getLocal("x"),c.i32_const(24)),c.i32_const(255)),I,0))),c.getLocal("bits")))}function ct(){const C=t.addFunction(n+"_fftJoin");C.addParam("pBuff1","i32"),C.addParam("pBuff2","i32"),C.addParam("n","i32"),C.addParam("first","i32"),C.addParam("inc","i32"),C.addLocal("idx1","i32"),C.addLocal("idx2","i32"),C.addLocal("i","i32");const c=C.getCodeBuilder(),m=c.i32_const(t.alloc(r)),y=c.i32_const(t.alloc(_)),f=c.i32_const(t.alloc(_));C.addCode(c.call(e+"_copy",c.getLocal("first"),m),c.setLocal("i",c.i32_const(0)),c.block(c.loop(c.br_if(1,c.i32_eq(c.getLocal("i"),c.getLocal("n"))),c.setLocal("idx1",c.i32_add(c.getLocal("pBuff1"),c.i32_mul(c.getLocal("i"),c.i32_const(_)))),c.setLocal("idx2",c.i32_add(c.getLocal("pBuff2"),c.i32_mul(c.getLocal("i"),c.i32_const(_)))),c.call(l,c.getLocal("idx2"),m,y),c.call(o+"_copy",c.getLocal("idx1"),f),c.call(o+"_add",f,y,c.getLocal("idx1")),c.call(o+"_sub",f,y,c.getLocal("idx2")),c.call(e+"_mul",m,c.getLocal("inc"),m),c.setLocal("i",c.i32_add(c.getLocal("i"),c.i32_const(1))),c.br(0))))}function Lt(){const C=t.addFunction(n+"_fftJoinExt");C.addParam("pBuff1","i32"),C.addParam("pBuff2","i32"),C.addParam("n","i32"),C.addParam("first","i32"),C.addParam("inc","i32"),C.addParam("totalBits","i32"),C.addLocal("idx1","i32"),C.addLocal("idx2","i32"),C.addLocal("i","i32"),C.addLocal("pShiftToM","i32");const c=C.getCodeBuilder(),m=c.i32_const(t.alloc(r)),y=c.i32_const(t.alloc(_));C.addCode(c.setLocal("pShiftToM",c.i32_add(c.i32_const(V),c.i32_mul(c.getLocal("totalBits"),c.i32_const(r)))),c.call(e+"_copy",c.getLocal("first"),m),c.setLocal("i",c.i32_const(0)),c.block(c.loop(c.br_if(1,c.i32_eq(c.getLocal("i"),c.getLocal("n"))),c.setLocal("idx1",c.i32_add(c.getLocal("pBuff1"),c.i32_mul(c.getLocal("i"),c.i32_const(_)))),c.setLocal("idx2",c.i32_add(c.getLocal("pBuff2"),c.i32_mul(c.getLocal("i"),c.i32_const(_)))),c.call(o+"_add",c.getLocal("idx1"),c.getLocal("idx2"),y),c.call(l,c.getLocal("idx2"),c.getLocal("pShiftToM"),c.getLocal("idx2")),c.call(o+"_add",c.getLocal("idx1"),c.getLocal("idx2"),c.getLocal("idx2")),c.call(l,c.getLocal("idx2"),m,c.getLocal("idx2")),c.call(o+"_copy",y,c.getLocal("idx1")),c.call(e+"_mul",m,c.getLocal("inc"),m),c.setLocal("i",c.i32_add(c.getLocal("i"),c.i32_const(1))),c.br(0))))}function wt(){const C=t.addFunction(n+"_fftJoinExtInv");C.addParam("pBuff1","i32"),C.addParam("pBuff2","i32"),C.addParam("n","i32"),C.addParam("first","i32"),C.addParam("inc","i32"),C.addParam("totalBits","i32"),C.addLocal("idx1","i32"),C.addLocal("idx2","i32"),C.addLocal("i","i32"),C.addLocal("pShiftToM","i32"),C.addLocal("pSConst","i32");const c=C.getCodeBuilder(),m=c.i32_const(t.alloc(r)),y=c.i32_const(t.alloc(_));C.addCode(c.setLocal("pShiftToM",c.i32_add(c.i32_const(V),c.i32_mul(c.getLocal("totalBits"),c.i32_const(r)))),c.setLocal("pSConst",c.i32_add(c.i32_const(j),c.i32_mul(c.getLocal("totalBits"),c.i32_const(r)))),c.call(e+"_copy",c.getLocal("first"),m),c.setLocal("i",c.i32_const(0)),c.block(c.loop(c.br_if(1,c.i32_eq(c.getLocal("i"),c.getLocal("n"))),c.setLocal("idx1",c.i32_add(c.getLocal("pBuff1"),c.i32_mul(c.getLocal("i"),c.i32_const(_)))),c.setLocal("idx2",c.i32_add(c.getLocal("pBuff2"),c.i32_mul(c.getLocal("i"),c.i32_const(_)))),c.call(l,c.getLocal("idx2"),m,y),c.call(o+"_sub",c.getLocal("idx1"),y,c.getLocal("idx2")),c.call(l,c.getLocal("idx2"),c.getLocal("pSConst"),c.getLocal("idx2")),c.call(l,c.getLocal("idx1"),c.getLocal("pShiftToM"),c.getLocal("idx1")),c.call(o+"_sub",y,c.getLocal("idx1"),c.getLocal("idx1")),c.call(l,c.getLocal("idx1"),c.getLocal("pSConst"),c.getLocal("idx1")),c.call(e+"_mul",m,c.getLocal("inc"),m),c.setLocal("i",c.i32_add(c.getLocal("i"),c.i32_const(1))),c.br(0))))}function ht(){const C=t.addFunction(n+"_prepareLagrangeEvaluation");C.addParam("pBuff1","i32"),C.addParam("pBuff2","i32"),C.addParam("n","i32"),C.addParam("first","i32"),C.addParam("inc","i32"),C.addParam("totalBits","i32"),C.addLocal("idx1","i32"),C.addLocal("idx2","i32"),C.addLocal("i","i32"),C.addLocal("pShiftToM","i32"),C.addLocal("pSConst","i32");const c=C.getCodeBuilder(),m=c.i32_const(t.alloc(r)),y=c.i32_const(t.alloc(_));C.addCode(c.setLocal("pShiftToM",c.i32_add(c.i32_const(V),c.i32_mul(c.getLocal("totalBits"),c.i32_const(r)))),c.setLocal("pSConst",c.i32_add(c.i32_const(j),c.i32_mul(c.getLocal("totalBits"),c.i32_const(r)))),c.call(e+"_copy",c.getLocal("first"),m),c.setLocal("i",c.i32_const(0)),c.block(c.loop(c.br_if(1,c.i32_eq(c.getLocal("i"),c.getLocal("n"))),c.setLocal("idx1",c.i32_add(c.getLocal("pBuff1"),c.i32_mul(c.getLocal("i"),c.i32_const(_)))),c.setLocal("idx2",c.i32_add(c.getLocal("pBuff2"),c.i32_mul(c.getLocal("i"),c.i32_const(_)))),c.call(l,c.getLocal("idx1"),c.getLocal("pShiftToM"),y),c.call(o+"_sub",c.getLocal("idx2"),y,y),c.call(o+"_sub",c.getLocal("idx1"),c.getLocal("idx2"),c.getLocal("idx2")),c.call(l,y,c.getLocal("pSConst"),c.getLocal("idx1")),c.call(l,c.getLocal("idx2"),m,c.getLocal("idx2")),c.call(e+"_mul",m,c.getLocal("inc"),m),c.setLocal("i",c.i32_add(c.getLocal("i"),c.i32_const(1))),c.br(0))))}function p(){const C=t.addFunction(n+"_fftMix");C.addParam("pBuff","i32"),C.addParam("n","i32"),C.addParam("exp","i32"),C.addLocal("nGroups","i32"),C.addLocal("nPerGroup","i32"),C.addLocal("nPerGroupDiv2","i32"),C.addLocal("pairOffset","i32"),C.addLocal("idx1","i32"),C.addLocal("idx2","i32"),C.addLocal("i","i32"),C.addLocal("j","i32"),C.addLocal("pwm","i32");const c=C.getCodeBuilder(),m=c.i32_const(t.alloc(r)),y=c.i32_const(t.alloc(_)),f=c.i32_const(t.alloc(_));C.addCode(c.setLocal("nPerGroup",c.i32_shl(c.i32_const(1),c.getLocal("exp"))),c.setLocal("nPerGroupDiv2",c.i32_shr_u(c.getLocal("nPerGroup"),c.i32_const(1))),c.setLocal("nGroups",c.i32_shr_u(c.getLocal("n"),c.getLocal("exp"))),c.setLocal("pairOffset",c.i32_mul(c.getLocal("nPerGroupDiv2"),c.i32_const(_))),c.setLocal("pwm",c.i32_add(c.i32_const(x),c.i32_mul(c.getLocal("exp"),c.i32_const(r)))),c.setLocal("i",c.i32_const(0)),c.block(c.loop(c.br_if(1,c.i32_eq(c.getLocal("i"),c.getLocal("nGroups"))),c.call(e+"_one",m),c.setLocal("j",c.i32_const(0)),c.block(c.loop(c.br_if(1,c.i32_eq(c.getLocal("j"),c.getLocal("nPerGroupDiv2"))),c.setLocal("idx1",c.i32_add(c.getLocal("pBuff"),c.i32_mul(c.i32_add(c.i32_mul(c.getLocal("i"),c.getLocal("nPerGroup")),c.getLocal("j")),c.i32_const(_)))),c.setLocal("idx2",c.i32_add(c.getLocal("idx1"),c.getLocal("pairOffset"))),c.call(l,c.getLocal("idx2"),m,y),c.call(o+"_copy",c.getLocal("idx1"),f),c.call(o+"_add",f,y,c.getLocal("idx1")),c.call(o+"_sub",f,y,c.getLocal("idx2")),c.call(e+"_mul",m,c.getLocal("pwm"),m),c.setLocal("j",c.i32_add(c.getLocal("j"),c.i32_const(1))),c.br(0))),c.setLocal("i",c.i32_add(c.getLocal("i"),c.i32_const(1))),c.br(0))))}function i(){const C=t.addFunction(n+"_fftFinal");C.addParam("pBuff","i32"),C.addParam("n","i32"),C.addParam("factor","i32"),C.addLocal("idx1","i32"),C.addLocal("idx2","i32"),C.addLocal("i","i32"),C.addLocal("ndiv2","i32");const c=C.getCodeBuilder(),m=c.i32_const(t.alloc(_));C.addCode(c.setLocal("ndiv2",c.i32_shr_u(c.getLocal("n"),c.i32_const(1))),c.if(c.i32_and(c.getLocal("n"),c.i32_const(1)),c.call(l,c.i32_add(c.getLocal("pBuff"),c.i32_mul(c.getLocal("ndiv2"),c.i32_const(_))),c.getLocal("factor"),c.i32_add(c.getLocal("pBuff"),c.i32_mul(c.getLocal("ndiv2"),c.i32_const(_))))),c.setLocal("i",c.i32_const(0)),c.block(c.loop(c.br_if(1,c.i32_ge_u(c.getLocal("i"),c.getLocal("ndiv2"))),c.setLocal("idx1",c.i32_add(c.getLocal("pBuff"),c.i32_mul(c.getLocal("i"),c.i32_const(_)))),c.setLocal("idx2",c.i32_add(c.getLocal("pBuff"),c.i32_mul(c.i32_sub(c.i32_sub(c.getLocal("n"),c.i32_const(1)),c.getLocal("i")),c.i32_const(_)))),c.call(l,c.getLocal("idx2"),c.getLocal("factor"),m),c.call(l,c.getLocal("idx1"),c.getLocal("factor"),c.getLocal("idx2")),c.call(o+"_copy",m,c.getLocal("idx1")),c.setLocal("i",c.i32_add(c.getLocal("i"),c.i32_const(1))),c.br(0))))}W(),at(),K(),tt(),v(),T(),ot(),ct(),Lt(),wt(),p(),i(),ht(),t.exportFunction(n+"_fft"),t.exportFunction(n+"_ifft"),t.exportFunction(n+"_rawfft"),t.exportFunction(n+"_fftJoin"),t.exportFunction(n+"_fftJoinExt"),t.exportFunction(n+"_fftJoinExtInv"),t.exportFunction(n+"_fftMix"),t.exportFunction(n+"_fftFinal"),t.exportFunction(n+"_prepareLagrangeEvaluation")},Mi=function(t,n,o){const l=t.modules[o].n64*8;function h(){const A=t.addFunction(n+"_zero");A.addParam("px","i32"),A.addParam("n","i32"),A.addLocal("lastp","i32"),A.addLocal("p","i32");const _=A.getCodeBuilder();A.addCode(_.setLocal("p",_.getLocal("px")),_.setLocal("lastp",_.i32_add(_.getLocal("px"),_.i32_mul(_.getLocal("n"),_.i32_const(l)))),_.block(_.loop(_.br_if(1,_.i32_eq(_.getLocal("p"),_.getLocal("lastp"))),_.call(o+"_zero",_.getLocal("p")),_.setLocal("p",_.i32_add(_.getLocal("p"),_.i32_const(l))),_.br(0))))}function r(){const A=t.addFunction(n+"_constructLC");A.addParam("ppolynomials","i32"),A.addParam("psignals","i32"),A.addParam("nSignals","i32"),A.addParam("pres","i32"),A.addLocal("i","i32"),A.addLocal("j","i32"),A.addLocal("pp","i32"),A.addLocal("ps","i32"),A.addLocal("pd","i32"),A.addLocal("ncoefs","i32");const _=A.getCodeBuilder(),s=_.i32_const(t.alloc(l));A.addCode(_.setLocal("i",_.i32_const(0)),_.setLocal("pp",_.getLocal("ppolynomials")),_.setLocal("ps",_.getLocal("psignals")),_.block(_.loop(_.br_if(1,_.i32_eq(_.getLocal("i"),_.getLocal("nSignals"))),_.setLocal("ncoefs",_.i32_load(_.getLocal("pp"))),_.setLocal("pp",_.i32_add(_.getLocal("pp"),_.i32_const(4))),_.setLocal("j",_.i32_const(0)),_.block(_.loop(_.br_if(1,_.i32_eq(_.getLocal("j"),_.getLocal("ncoefs"))),_.setLocal("pd",_.i32_add(_.getLocal("pres"),_.i32_mul(_.i32_load(_.getLocal("pp")),_.i32_const(l)))),_.setLocal("pp",_.i32_add(_.getLocal("pp"),_.i32_const(4))),_.call(o+"_mul",_.getLocal("ps"),_.getLocal("pp"),s),_.call(o+"_add",s,_.getLocal("pd"),_.getLocal("pd")),_.setLocal("pp",_.i32_add(_.getLocal("pp"),_.i32_const(l))),_.setLocal("j",_.i32_add(_.getLocal("j"),_.i32_const(1))),_.br(0))),_.setLocal("ps",_.i32_add(_.getLocal("ps"),_.i32_const(l))),_.setLocal("i",_.i32_add(_.getLocal("i"),_.i32_const(1))),_.br(0))))}return h(),r(),t.exportFunction(n+"_zero"),t.exportFunction(n+"_constructLC"),n},qi=function(t,n,o){const l=t.modules[o].n64*8;function h(){const _=t.addFunction(n+"_buildABC");_.addParam("pCoefs","i32"),_.addParam("nCoefs","i32"),_.addParam("pWitness","i32"),_.addParam("pA","i32"),_.addParam("pB","i32"),_.addParam("pC","i32"),_.addParam("offsetOut","i32"),_.addParam("nOut","i32"),_.addParam("offsetWitness","i32"),_.addParam("nWitness","i32"),_.addLocal("it","i32"),_.addLocal("ita","i32"),_.addLocal("itb","i32"),_.addLocal("last","i32"),_.addLocal("m","i32"),_.addLocal("c","i32"),_.addLocal("s","i32"),_.addLocal("pOut","i32");const s=_.getCodeBuilder(),w=s.i32_const(t.alloc(l));_.addCode(s.setLocal("ita",s.getLocal("pA")),s.setLocal("itb",s.getLocal("pB")),s.setLocal("last",s.i32_add(s.getLocal("pA"),s.i32_mul(s.getLocal("nOut"),s.i32_const(l)))),s.block(s.loop(s.br_if(1,s.i32_eq(s.getLocal("ita"),s.getLocal("last"))),s.call(o+"_zero",s.getLocal("ita")),s.call(o+"_zero",s.getLocal("itb")),s.setLocal("ita",s.i32_add(s.getLocal("ita"),s.i32_const(l))),s.setLocal("itb",s.i32_add(s.getLocal("itb"),s.i32_const(l))),s.br(0))),s.setLocal("it",s.getLocal("pCoefs")),s.setLocal("last",s.i32_add(s.getLocal("pCoefs"),s.i32_mul(s.getLocal("nCoefs"),s.i32_const(l+12)))),s.block(s.loop(s.br_if(1,s.i32_eq(s.getLocal("it"),s.getLocal("last"))),s.setLocal("s",s.i32_load(s.getLocal("it"),8)),s.if(s.i32_or(s.i32_lt_u(s.getLocal("s"),s.getLocal("offsetWitness")),s.i32_ge_u(s.getLocal("s"),s.i32_add(s.getLocal("offsetWitness"),s.getLocal("nWitness")))),[...s.setLocal("it",s.i32_add(s.getLocal("it"),s.i32_const(l+12))),...s.br(1)]),s.setLocal("m",s.i32_load(s.getLocal("it"))),s.if(s.i32_eq(s.getLocal("m"),s.i32_const(0)),s.setLocal("pOut",s.getLocal("pA")),s.if(s.i32_eq(s.getLocal("m"),s.i32_const(1)),s.setLocal("pOut",s.getLocal("pB")),[...s.setLocal("it",s.i32_add(s.getLocal("it"),s.i32_const(l+12))),...s.br(1)])),s.setLocal("c",s.i32_load(s.getLocal("it"),4)),s.if(s.i32_or(s.i32_lt_u(s.getLocal("c"),s.getLocal("offsetOut")),s.i32_ge_u(s.getLocal("c"),s.i32_add(s.getLocal("offsetOut"),s.getLocal("nOut")))),[...s.setLocal("it",s.i32_add(s.getLocal("it"),s.i32_const(l+12))),...s.br(1)]),s.setLocal("pOut",s.i32_add(s.getLocal("pOut"),s.i32_mul(s.i32_sub(s.getLocal("c"),s.getLocal("offsetOut")),s.i32_const(l)))),s.call(o+"_mul",s.i32_add(s.getLocal("pWitness"),s.i32_mul(s.i32_sub(s.getLocal("s"),s.getLocal("offsetWitness")),s.i32_const(l))),s.i32_add(s.getLocal("it"),s.i32_const(12)),w),s.call(o+"_add",s.getLocal("pOut"),w,s.getLocal("pOut")),s.setLocal("it",s.i32_add(s.getLocal("it"),s.i32_const(l+12))),s.br(0))),s.setLocal("ita",s.getLocal("pA")),s.setLocal("itb",s.getLocal("pB")),s.setLocal("it",s.getLocal("pC")),s.setLocal("last",s.i32_add(s.getLocal("pA"),s.i32_mul(s.getLocal("nOut"),s.i32_const(l)))),s.block(s.loop(s.br_if(1,s.i32_eq(s.getLocal("ita"),s.getLocal("last"))),s.call(o+"_mul",s.getLocal("ita"),s.getLocal("itb"),s.getLocal("it")),s.setLocal("ita",s.i32_add(s.getLocal("ita"),s.i32_const(l))),s.setLocal("itb",s.i32_add(s.getLocal("itb"),s.i32_const(l))),s.setLocal("it",s.i32_add(s.getLocal("it"),s.i32_const(l))),s.br(0))))}function r(){const _=t.addFunction(n+"_joinABC");_.addParam("pA","i32"),_.addParam("pB","i32"),_.addParam("pC","i32"),_.addParam("n","i32"),_.addParam("pP","i32"),_.addLocal("ita","i32"),_.addLocal("itb","i32"),_.addLocal("itc","i32"),_.addLocal("itp","i32"),_.addLocal("last","i32");const s=_.getCodeBuilder(),w=s.i32_const(t.alloc(l));_.addCode(s.setLocal("ita",s.getLocal("pA")),s.setLocal("itb",s.getLocal("pB")),s.setLocal("itc",s.getLocal("pC")),s.setLocal("itp",s.getLocal("pP")),s.setLocal("last",s.i32_add(s.getLocal("pA"),s.i32_mul(s.getLocal("n"),s.i32_const(l)))),s.block(s.loop(s.br_if(1,s.i32_eq(s.getLocal("ita"),s.getLocal("last"))),s.call(o+"_mul",s.getLocal("ita"),s.getLocal("itb"),w),s.call(o+"_sub",w,s.getLocal("itc"),s.getLocal("itp")),s.setLocal("ita",s.i32_add(s.getLocal("ita"),s.i32_const(l))),s.setLocal("itb",s.i32_add(s.getLocal("itb"),s.i32_const(l))),s.setLocal("itc",s.i32_add(s.getLocal("itc"),s.i32_const(l))),s.setLocal("itp",s.i32_add(s.getLocal("itp"),s.i32_const(l))),s.br(0))))}function A(){const _=t.addFunction(n+"_batchAdd");_.addParam("pa","i32"),_.addParam("pb","i32"),_.addParam("n","i32"),_.addParam("pr","i32"),_.addLocal("ita","i32"),_.addLocal("itb","i32"),_.addLocal("itr","i32"),_.addLocal("last","i32");const s=_.getCodeBuilder();_.addCode(s.setLocal("ita",s.getLocal("pa")),s.setLocal("itb",s.getLocal("pb")),s.setLocal("itr",s.getLocal("pr")),s.setLocal("last",s.i32_add(s.getLocal("pa"),s.i32_mul(s.getLocal("n"),s.i32_const(l)))),s.block(s.loop(s.br_if(1,s.i32_eq(s.getLocal("ita"),s.getLocal("last"))),s.call(o+"_add",s.getLocal("ita"),s.getLocal("itb"),s.getLocal("itr")),s.setLocal("ita",s.i32_add(s.getLocal("ita"),s.i32_const(l))),s.setLocal("itb",s.i32_add(s.getLocal("itb"),s.i32_const(l))),s.setLocal("itr",s.i32_add(s.getLocal("itr"),s.i32_const(l))),s.br(0))))}return h(),r(),A(),t.exportFunction(n+"_buildABC"),t.exportFunction(n+"_joinABC"),t.exportFunction(n+"_batchAdd"),n},Ui=function(t,n,o,e,l,h,r,A){const _=t.addFunction(n);_.addParam("pIn","i32"),_.addParam("n","i32"),_.addParam("pFirst","i32"),_.addParam("pInc","i32"),_.addParam("pOut","i32"),_.addLocal("pOldFree","i32"),_.addLocal("i","i32"),_.addLocal("pFrom","i32"),_.addLocal("pTo","i32");const s=_.getCodeBuilder(),w=s.i32_const(t.alloc(r));_.addCode(s.setLocal("pFrom",s.getLocal("pIn")),s.setLocal("pTo",s.getLocal("pOut"))),_.addCode(s.call(e+"_copy",s.getLocal("pFirst"),w)),_.addCode(s.setLocal("i",s.i32_const(0)),s.block(s.loop(s.br_if(1,s.i32_eq(s.getLocal("i"),s.getLocal("n"))),s.call(A,s.getLocal("pFrom"),w,s.getLocal("pTo")),s.setLocal("pFrom",s.i32_add(s.getLocal("pFrom"),s.i32_const(l))),s.setLocal("pTo",s.i32_add(s.getLocal("pTo"),s.i32_const(h))),s.call(e+"_mul",w,s.getLocal("pInc"),w),s.setLocal("i",s.i32_add(s.getLocal("i"),s.i32_const(1))),s.br(0)))),t.exportFunction(n)};const Ft=wn,Cc=re,mc=Si,me=vi,wc=Oi,we=Pi,xo=Qi,Bc=Mi,Ec=qi,Vn=Ui,{bitLength:Fc,modInv:xc,isOdd:Be,isNegative:Sc}=jt;var vc=function(t,n){const o=n||"bn128";if(t.modules[o])return o;const e=21888242871839275222246405745257275088696311157297823662689037894645226208583n,l=21888242871839275222246405745257275088548364400416034343698204186575808495617n,h=Math.floor((Fc(e-1n)-1)/64)+1,r=h*8,A=r,_=r,s=_*2,w=_*12,B=t.alloc(Ft.bigInt2BytesLE(l,A)),b=Cc(t,e,"f1m");mc(t,l,"fr","frm");const k=t.alloc(Ft.bigInt2BytesLE(z(3n),_)),D=we(t,"g1m","f1m",k);xo(t,"frm","frm","frm","frm_mul"),Bc(t,"pol","frm"),Ec(t,"qap","frm");const F=me(t,"f1m_neg","f2m","f1m"),q=t.alloc([...Ft.bigInt2BytesLE(z(19485874751759354771024239261021720505790618469301721065564631296452457478373n),_),...Ft.bigInt2BytesLE(z(266929791119991161246907387137283842545076965332900288569378510910307636690n),_)]),x=we(t,"g2m","f2m",q);function it(N,d){const g=t.addFunction(N);g.addParam("pG","i32"),g.addParam("pFr","i32"),g.addParam("pr","i32");const Q=g.getCodeBuilder(),U=Q.i32_const(t.alloc(r));g.addCode(Q.call("frm_fromMontgomery",Q.getLocal("pFr"),U),Q.call(d,Q.getLocal("pG"),U,Q.i32_const(r),Q.getLocal("pr"))),t.exportFunction(N)}it("g1m_timesFr","g1m_timesScalar"),xo(t,"g1m","g1m","frm","g1m_timesFr"),it("g2m_timesFr","g2m_timesScalar"),xo(t,"g2m","g2m","frm","g2m_timesFr"),it("g1m_timesFrAffine","g1m_timesScalarAffine"),it("g2m_timesFrAffine","g2m_timesScalarAffine"),Vn(t,"frm_batchApplyKey","fmr","frm",r,r,r,"frm_mul"),Vn(t,"g1m_batchApplyKey","g1m","frm",r*3,r*3,r,"g1m_timesFr"),Vn(t,"g1m_batchApplyKeyMixed","g1m","frm",r*2,r*3,r,"g1m_timesFrAffine"),Vn(t,"g2m_batchApplyKey","g2m","frm",r*2*3,r*3*2,r,"g2m_timesFr"),Vn(t,"g2m_batchApplyKeyMixed","g2m","frm",r*2*2,r*3*2,r,"g2m_timesFrAffine");function z(N){return BigInt(N)*(1n<<BigInt(_*8))%e}const lt=[1n,2n,1n],E=t.alloc([...Ft.bigInt2BytesLE(z(lt[0]),_),...Ft.bigInt2BytesLE(z(lt[1]),_),...Ft.bigInt2BytesLE(z(lt[2]),_)]),u=[0n,1n,0n],L=t.alloc([...Ft.bigInt2BytesLE(z(u[0]),_),...Ft.bigInt2BytesLE(z(u[1]),_),...Ft.bigInt2BytesLE(z(u[2]),_)]),V=[[10857046999023057135944570762232829481370756359578518086990519993285655852781n,11559732032986387107991004021392285783925812861821192530917403151452391805634n],[8495653923123431417604973247489272438418190587263600148770280649306958101930n,4082367875863433681332203403145435568316851327593401208105741076214120093531n],[1n,0n]],j=t.alloc([...Ft.bigInt2BytesLE(z(V[0][0]),_),...Ft.bigInt2BytesLE(z(V[0][1]),_),...Ft.bigInt2BytesLE(z(V[1][0]),_),...Ft.bigInt2BytesLE(z(V[1][1]),_),...Ft.bigInt2BytesLE(z(V[2][0]),_),...Ft.bigInt2BytesLE(z(V[2][1]),_)]),X=[[0n,0n],[1n,0n],[0n,0n]],P=t.alloc([...Ft.bigInt2BytesLE(z(X[0][0]),_),...Ft.bigInt2BytesLE(z(X[0][1]),_),...Ft.bigInt2BytesLE(z(X[1][0]),_),...Ft.bigInt2BytesLE(z(X[1][1]),_),...Ft.bigInt2BytesLE(z(X[2][0]),_),...Ft.bigInt2BytesLE(z(X[2][1]),_)]),I=t.alloc([...Ft.bigInt2BytesLE(z(1),_),...Ft.bigInt2BytesLE(z(0),_),...Ft.bigInt2BytesLE(z(0),_),...Ft.bigInt2BytesLE(z(0),_),...Ft.bigInt2BytesLE(z(0),_),...Ft.bigInt2BytesLE(z(0),_),...Ft.bigInt2BytesLE(z(0),_),...Ft.bigInt2BytesLE(z(0),_),...Ft.bigInt2BytesLE(z(0),_),...Ft.bigInt2BytesLE(z(0),_),...Ft.bigInt2BytesLE(z(0),_),...Ft.bigInt2BytesLE(z(0),_)]),v=t.alloc([...Ft.bigInt2BytesLE(z(9),_),...Ft.bigInt2BytesLE(z(1),_)]),T=t.alloc([...Ft.bigInt2BytesLE(z(xc(2n,e)),_),...Ft.bigInt2BytesLE(0n,_)]),ot=v,tt=t.alloc([...Ft.bigInt2BytesLE(z(19485874751759354771024239261021720505790618469301721065564631296452457478373n),_),...Ft.bigInt2BytesLE(z(266929791119991161246907387137283842545076965332900288569378510910307636690n),_)]);function K(){const N=t.addFunction(o+"_mulNR6");N.addParam("x","i32"),N.addParam("pr","i32");const d=N.getCodeBuilder();N.addCode(d.call(F+"_mul",d.i32_const(v),d.getLocal("x"),d.getLocal("pr")))}K();const at=wc(t,o+"_mulNR6","f6m","f2m");function W(){const N=t.addFunction(o+"_mulNR12");N.addParam("x","i32"),N.addParam("pr","i32");const d=N.getCodeBuilder();N.addCode(d.call(F+"_mul",d.i32_const(v),d.i32_add(d.getLocal("x"),d.i32_const(r*4)),d.getLocal("pr")),d.call(F+"_copy",d.getLocal("x"),d.i32_add(d.getLocal("pr"),d.i32_const(r*2))),d.call(F+"_copy",d.i32_add(d.getLocal("x"),d.i32_const(r*2)),d.i32_add(d.getLocal("pr"),d.i32_const(r*4))))}W();const ct=me(t,o+"_mulNR12","ftm",at),wt=J(29793968203157093288n),ht=t.alloc(wt),p=3*s,i=wt.length-1,c=wt.reduce((N,d)=>N+(d!=0?1:0),0)+i+1,m=3*2*r,y=3*r*2+c*p;t.modules[o]={n64:h,pG1gen:E,pG1zero:L,pG1b:k,pG2gen:j,pG2zero:P,pG2b:q,pq:t.modules.f1m.pq,pr:B,pOneT:I,prePSize:m,preQSize:y,r:l.toString(),q:e.toString()};const f=4965661367192848881n;function S(N){let d=N;const g=[];for(;d>0n;){if(Be(d)){const Q=2-Number(d%4n);g.push(Q),d=d-BigInt(Q)}else g.push(0);d=d>>1n}return g}function J(N){let d=N;const g=[];for(;d>0n;)Be(d)?g.push(1):g.push(0),d=d>>1n;return g}function R(){const N=t.addFunction(o+"_prepareG1");N.addParam("pP","i32"),N.addParam("ppreP","i32");const d=N.getCodeBuilder();N.addCode(d.call(D+"_normalize",d.getLocal("pP"),d.getLocal("ppreP")))}function et(){const N=t.addFunction(o+"_prepAddStep");N.addParam("pQ","i32"),N.addParam("pR","i32"),N.addParam("pCoef","i32");const d=N.getCodeBuilder(),g=d.getLocal("pQ"),Q=d.i32_add(d.getLocal("pQ"),d.i32_const(s)),U=d.getLocal("pR"),O=d.i32_add(d.getLocal("pR"),d.i32_const(s)),G=d.i32_add(d.getLocal("pR"),d.i32_const(2*s)),M=d.getLocal("pCoef"),$=d.i32_add(d.getLocal("pCoef"),d.i32_const(s)),Y=d.i32_add(d.getLocal("pCoef"),d.i32_const(2*s)),Z=$,H=d.i32_const(t.alloc(s)),nt=d.i32_const(t.alloc(s)),ut=d.i32_const(t.alloc(s)),_t=d.i32_const(t.alloc(s)),st=d.i32_const(t.alloc(s)),At=d.i32_const(t.alloc(s)),Ct=d.i32_const(t.alloc(s));N.addCode(d.call(F+"_mul",g,G,Z),d.call(F+"_sub",U,Z,Z),d.call(F+"_mul",Q,G,H),d.call(F+"_sub",O,H,H),d.call(F+"_square",Z,nt),d.call(F+"_square",H,ut),d.call(F+"_mul",Z,nt,_t),d.call(F+"_mul",U,nt,st),d.call(F+"_add",st,st,Ct),d.call(F+"_mul",G,ut,At),d.call(F+"_add",_t,At,At),d.call(F+"_sub",At,Ct,At),d.call(F+"_mul",Z,At,U),d.call(F+"_mul",_t,O,O),d.call(F+"_sub",st,At,Ct),d.call(F+"_mul",H,Ct,Ct),d.call(F+"_sub",Ct,O,O),d.call(F+"_mul",G,_t,G),d.call(F+"_mul",Z,Q,Ct),d.call(F+"_mul",H,g,M),d.call(F+"_sub",M,Ct,M),d.call(F+"_mul",M,d.i32_const(ot),M),d.call(F+"_neg",H,Y))}function It(){const N=t.addFunction(o+"_prepDblStep");N.addParam("pR","i32"),N.addParam("pCoef","i32");const d=N.getCodeBuilder(),g=d.getLocal("pR"),Q=d.i32_add(d.getLocal("pR"),d.i32_const(s)),U=d.i32_add(d.getLocal("pR"),d.i32_const(2*s)),O=d.getLocal("pCoef"),G=d.i32_add(d.getLocal("pCoef"),d.i32_const(s)),M=d.i32_add(d.getLocal("pCoef"),d.i32_const(2*s)),$=d.i32_const(t.alloc(s)),Y=d.i32_const(t.alloc(s)),Z=d.i32_const(t.alloc(s)),H=d.i32_const(t.alloc(s)),nt=d.i32_const(t.alloc(s)),ut=d.i32_const(t.alloc(s)),_t=d.i32_const(t.alloc(s)),st=d.i32_const(t.alloc(s)),At=d.i32_const(t.alloc(s)),Ct=d.i32_const(t.alloc(s)),St=d.i32_const(t.alloc(s)),yt=d.i32_const(t.alloc(s));N.addCode(d.call(F+"_mul",Q,d.i32_const(T),$),d.call(F+"_mul",g,$,$),d.call(F+"_square",Q,Y),d.call(F+"_square",U,Z),d.call(F+"_add",Z,Z,H),d.call(F+"_add",H,Z,H),d.call(F+"_mul",d.i32_const(tt),H,nt),d.call(F+"_add",nt,nt,ut),d.call(F+"_add",nt,ut,ut),d.call(F+"_add",Y,ut,_t),d.call(F+"_mul",_t,d.i32_const(T),_t),d.call(F+"_add",Y,Z,yt),d.call(F+"_add",Q,U,st),d.call(F+"_square",st,st),d.call(F+"_sub",st,yt,st),d.call(F+"_sub",nt,Y,At),d.call(F+"_square",g,Ct),d.call(F+"_square",nt,St),d.call(F+"_sub",Y,ut,yt),d.call(F+"_mul",$,yt,g),d.call(F+"_add",St,St,yt),d.call(F+"_add",St,yt,yt),d.call(F+"_square",_t,Q),d.call(F+"_sub",Q,yt,Q),d.call(F+"_mul",Y,st,U),d.call(F+"_mul",d.i32_const(ot),At,O),d.call(F+"_neg",st,G),d.call(F+"_add",Ct,Ct,M),d.call(F+"_add",Ct,M,M))}function dt(){const N=t.addFunction(o+"_mulByQ");N.addParam("p1","i32"),N.addParam("pr","i32");const d=N.getCodeBuilder(),g=d.getLocal("p1"),Q=d.i32_add(d.getLocal("p1"),d.i32_const(s)),U=d.i32_add(d.getLocal("p1"),d.i32_const(s*2)),O=d.getLocal("pr"),G=d.i32_add(d.getLocal("pr"),d.i32_const(s)),M=d.i32_add(d.getLocal("pr"),d.i32_const(s*2)),$=d.i32_const(t.alloc([...Ft.bigInt2BytesLE(z("21575463638280843010398324269430826099269044274347216827212613867836435027261"),_),...Ft.bigInt2BytesLE(z("10307601595873709700152284273816112264069230130616436755625194854815875713954"),_)])),Y=d.i32_const(t.alloc([...Ft.bigInt2BytesLE(z("2821565182194536844548159561693502659359617185244120367078079554186484126554"),_),...Ft.bigInt2BytesLE(z("3505843767911556378687030309984248845540243509899259641013678093033130930403"),_)]));N.addCode(d.call(F+"_conjugate",g,O),d.call(F+"_mul",$,O,O),d.call(F+"_conjugate",Q,G),d.call(F+"_mul",Y,G,G),d.call(F+"_conjugate",U,M))}function pt(){dt();const N=t.addFunction(o+"_prepareG2");N.addParam("pQ","i32"),N.addParam("ppreQ","i32"),N.addLocal("pCoef","i32"),N.addLocal("i","i32");const d=N.getCodeBuilder(),g=d.getLocal("pQ"),Q=t.alloc(s*3),U=d.i32_const(Q),O=d.i32_const(Q),G=d.i32_const(Q+s),M=d.i32_const(Q+2*s),$=d.i32_add(d.getLocal("ppreQ"),d.i32_const(0)),Y=d.i32_add(d.getLocal("ppreQ"),d.i32_const(s)),Z=t.alloc(s*3),H=d.i32_const(Z),nt=t.alloc(s*3),ut=d.i32_const(nt),_t=d.i32_const(nt+s);N.addCode(d.call(x+"_normalize",g,$),d.call(F+"_copy",$,O),d.call(F+"_copy",Y,G),d.call(F+"_one",M)),N.addCode(d.setLocal("pCoef",d.i32_add(d.getLocal("ppreQ"),d.i32_const(s*3))),d.setLocal("i",d.i32_const(wt.length-2)),d.block(d.loop(d.call(o+"_prepDblStep",U,d.getLocal("pCoef")),d.setLocal("pCoef",d.i32_add(d.getLocal("pCoef"),d.i32_const(p))),d.if(d.i32_load8_s(d.getLocal("i"),ht),[...d.call(o+"_prepAddStep",$,U,d.getLocal("pCoef")),...d.setLocal("pCoef",d.i32_add(d.getLocal("pCoef"),d.i32_const(p)))]),d.br_if(1,d.i32_eqz(d.getLocal("i"))),d.setLocal("i",d.i32_sub(d.getLocal("i"),d.i32_const(1))),d.br(0)))),N.addCode(d.call(o+"_mulByQ",$,H),d.call(o+"_mulByQ",H,ut)),N.addCode(d.call(F+"_neg",_t,_t),d.call(o+"_prepAddStep",H,U,d.getLocal("pCoef")),d.setLocal("pCoef",d.i32_add(d.getLocal("pCoef"),d.i32_const(p))),d.call(o+"_prepAddStep",ut,U,d.getLocal("pCoef")),d.setLocal("pCoef",d.i32_add(d.getLocal("pCoef"),d.i32_const(p))))}function xt(){const N=t.addFunction(o+"__mulBy024Old");N.addParam("pEll0","i32"),N.addParam("pEllVW","i32"),N.addParam("pEllVV","i32"),N.addParam("pR","i32");const d=N.getCodeBuilder(),g=d.getLocal("pEll0"),Q=d.getLocal("pEllVV"),U=d.getLocal("pEllVW"),O=d.getLocal("pR"),G=t.alloc(w),M=d.i32_const(G),$=d.i32_const(G),Y=d.i32_const(G+s),Z=d.i32_const(G+s*2),H=d.i32_const(G+s*3),nt=d.i32_const(G+s*4),ut=d.i32_const(G+s*5);N.addCode(d.call(F+"_copy",g,$),d.call(F+"_zero",Y),d.call(F+"_copy",Q,Z),d.call(F+"_zero",H),d.call(F+"_copy",U,nt),d.call(F+"_zero",ut),d.call(ct+"_mul",M,O,O))}function gt(){const N=t.addFunction(o+"__mulBy024");N.addParam("pEll0","i32"),N.addParam("pEllVW","i32"),N.addParam("pEllVV","i32"),N.addParam("pR","i32");const d=N.getCodeBuilder(),g=d.getLocal("pEll0"),Q=d.getLocal("pEllVV"),U=d.getLocal("pEllVW"),O=d.getLocal("pR"),G=d.i32_add(d.getLocal("pR"),d.i32_const(2*r)),M=d.i32_add(d.getLocal("pR"),d.i32_const(4*r)),$=d.i32_add(d.getLocal("pR"),d.i32_const(6*r)),Y=d.i32_add(d.getLocal("pR"),d.i32_const(8*r)),Z=d.i32_add(d.getLocal("pR"),d.i32_const(10*r)),H=d.i32_const(t.alloc(s)),nt=d.i32_const(t.alloc(s)),ut=d.i32_const(t.alloc(s)),_t=d.i32_const(t.alloc(s)),st=d.i32_const(t.alloc(s)),At=d.i32_const(t.alloc(s)),Ct=d.i32_const(t.alloc(s)),St=d.i32_const(t.alloc(s)),yt=d.i32_const(t.alloc(s)),mt=d.i32_const(t.alloc(s)),ft=d.i32_const(t.alloc(s));N.addCode(d.call(F+"_mul",O,g,Ct),d.call(F+"_mul",M,Q,St),d.call(F+"_mul",Y,U,yt),d.call(F+"_add",O,Y,ut),d.call(F+"_add",O,M,nt),d.call(F+"_add",G,$,_t),d.call(F+"_add",_t,Z,_t),d.call(F+"_mul",G,Q,mt),d.call(F+"_add",mt,yt,st),d.call(F+"_mul",d.i32_const(v),st,At),d.call(F+"_add",At,Ct,O),d.call(F+"_mul",Z,U,st),d.call(F+"_add",mt,st,mt),d.call(F+"_add",st,St,st),d.call(F+"_mul",d.i32_const(v),st,At),d.call(F+"_mul",G,g,st),d.call(F+"_add",mt,st,mt),d.call(F+"_add",At,st,G),d.call(F+"_add",g,Q,H),d.call(F+"_mul",nt,H,st),d.call(F+"_add",Ct,St,ft),d.call(F+"_sub",st,ft,st),d.call(F+"_mul",$,U,At),d.call(F+"_add",mt,At,mt),d.call(F+"_add",M,Y,H),d.call(F+"_add",st,At,M),d.call(F+"_add",Q,U,nt),d.call(F+"_mul",nt,H,st),d.call(F+"_add",St,yt,ft),d.call(F+"_sub",st,ft,st),d.call(F+"_mul",d.i32_const(v),st,At),d.call(F+"_mul",$,g,st),d.call(F+"_add",mt,st,mt),d.call(F+"_add",At,st,$),d.call(F+"_mul",Z,Q,st),d.call(F+"_add",mt,st,mt),d.call(F+"_mul",d.i32_const(v),st,At),d.call(F+"_add",g,U,H),d.call(F+"_mul",ut,H,st),d.call(F+"_add",Ct,yt,ft),d.call(F+"_sub",st,ft,st),d.call(F+"_add",At,st,Y),d.call(F+"_add",g,Q,H),d.call(F+"_add",H,U,H),d.call(F+"_mul",_t,H,st),d.call(F+"_sub",st,mt,Z))}function rt(){const N=t.addFunction(o+"_millerLoop");N.addParam("ppreP","i32"),N.addParam("ppreQ","i32"),N.addParam("r","i32"),N.addLocal("pCoef","i32"),N.addLocal("i","i32");const d=N.getCodeBuilder(),g=d.getLocal("ppreP"),Q=d.i32_add(d.getLocal("ppreP"),d.i32_const(_)),U=d.getLocal("pCoef"),O=d.i32_add(d.getLocal("pCoef"),d.i32_const(s)),G=d.i32_add(d.getLocal("pCoef"),d.i32_const(2*s)),M=t.alloc(s),$=d.i32_const(M),Y=t.alloc(s),Z=d.i32_const(Y),H=d.getLocal("r");N.addCode(d.call(ct+"_one",H),d.setLocal("pCoef",d.i32_add(d.getLocal("ppreQ"),d.i32_const(s*3))),d.setLocal("i",d.i32_const(wt.length-2)),d.block(d.loop(d.call(ct+"_square",H,H),d.call(F+"_mul1",O,Q,$),d.call(F+"_mul1",G,g,Z),d.call(o+"__mulBy024",U,$,Z,H),d.setLocal("pCoef",d.i32_add(d.getLocal("pCoef"),d.i32_const(p))),d.if(d.i32_load8_s(d.getLocal("i"),ht),[...d.call(F+"_mul1",O,Q,$),...d.call(F+"_mul1",G,g,Z),...d.call(o+"__mulBy024",U,$,Z,H),...d.setLocal("pCoef",d.i32_add(d.getLocal("pCoef"),d.i32_const(p)))]),d.br_if(1,d.i32_eqz(d.getLocal("i"))),d.setLocal("i",d.i32_sub(d.getLocal("i"),d.i32_const(1))),d.br(0)))),N.addCode(d.call(F+"_mul1",O,Q,$),d.call(F+"_mul1",G,g,Z),d.call(o+"__mulBy024",U,$,Z,H),d.setLocal("pCoef",d.i32_add(d.getLocal("pCoef"),d.i32_const(p))),d.call(F+"_mul1",O,Q,$),d.call(F+"_mul1",G,g,Z),d.call(o+"__mulBy024",U,$,Z,H),d.setLocal("pCoef",d.i32_add(d.getLocal("pCoef"),d.i32_const(p))))}function bt(N){const d=[[[1n,0n],[1n,0n],[1n,0n],[1n,0n],[1n,0n],[1n,0n],[1n,0n],[1n,0n],[1n,0n],[1n,0n],[1n,0n],[1n,0n]],[[1n,0n],[8376118865763821496583973867626364092589906065868298776909617916018768340080n,16469823323077808223889137241176536799009286646108169935659301613961712198316n],[21888242871839275220042445260109153167277707414472061641714758635765020556617n,0n],[11697423496358154304825782922584725312912383441159505038794027105778954184319n,303847389135065887422783454877609941456349188919719272345083954437860409601n],[21888242871839275220042445260109153167277707414472061641714758635765020556616n,0n],[3321304630594332808241809054958361220322477375291206261884409189760185844239n,5722266937896532885780051958958348231143373700109372999374820235121374419868n],[21888242871839275222246405745257275088696311157297823662689037894645226208582n,0n],[13512124006075453725662431877630910996106405091429524885779419978626457868503n,5418419548761466998357268504080738289687024511189653727029736280683514010267n],[2203960485148121921418603742825762020974279258880205651966n,0n],[10190819375481120917420622822672549775783927716138318623895010788866272024264n,21584395482704209334823622290379665147239961968378104390343953940207365798982n],[2203960485148121921418603742825762020974279258880205651967n,0n],[18566938241244942414004596690298913868373833782006617400804628704885040364344n,16165975933942742336466353786298926857552937457188450663314217659523851788715n]]],g=[[[1n,0n],[1n,0n],[1n,0n],[1n,0n],[1n,0n],[1n,0n]],[[1n,0n],[21575463638280843010398324269430826099269044274347216827212613867836435027261n,10307601595873709700152284273816112264069230130616436755625194854815875713954n],[21888242871839275220042445260109153167277707414472061641714758635765020556616n,0n],[3772000881919853776433695186713858239009073593817195771773381919316419345261n,2236595495967245188281701248203181795121068902605861227855261137820944008926n],[2203960485148121921418603742825762020974279258880205651966n,0n],[18429021223477853657660792034369865839114504446431234726392080002137598044644n,9344045779998320333812420223237981029506012124075525679208581902008406485703n]],[[1n,0n],[2581911344467009335267311115468803099551665605076196740867805258568234346338n,19937756971775647987995932169929341994314640652964949448313374472400716661030n],[2203960485148121921418603742825762020974279258880205651966n,0n],[5324479202449903542726783395506214481928257762400643279780343368557297135718n,16208900380737693084919495127334387981393726419856888799917914180988844123039n],[21888242871839275220042445260109153167277707414472061641714758635765020556616n,0n],[13981852324922362344252311234282257507216387789820983642040889267519694726527n,7629828391165209371577384193250820201684255241773809077146787135900891633097n]]],Q=t.addFunction(o+"__frobeniusMap"+N);Q.addParam("x","i32"),Q.addParam("r","i32");const U=Q.getCodeBuilder();for(let G=0;G<6;G++){const M=G==0?U.getLocal("x"):U.i32_add(U.getLocal("x"),U.i32_const(G*s)),$=M,Y=U.i32_add(U.getLocal("x"),U.i32_const(G*s+_)),Z=G==0?U.getLocal("r"):U.i32_add(U.getLocal("r"),U.i32_const(G*s)),H=Z,nt=U.i32_add(U.getLocal("r"),U.i32_const(G*s+_)),ut=O(d[Math.floor(G/3)][N%12],g[G%3][N%6]),_t=t.alloc([...Ft.bigInt2BytesLE(z(ut[0]),32),...Ft.bigInt2BytesLE(z(ut[1]),32)]);N%2==1?Q.addCode(U.call(b+"_copy",$,H),U.call(b+"_neg",Y,nt),U.call(F+"_mul",Z,U.i32_const(_t),Z)):Q.addCode(U.call(F+"_mul",M,U.i32_const(_t),Z))}function O(G,M){const $=BigInt(G[0]),Y=BigInt(G[1]),Z=BigInt(M[0]),H=BigInt(M[1]),nt=[($*Z-Y*H)%e,($*H+Y*Z)%e];return Sc(nt[0])&&(nt[0]=nt[0]+e),nt}}function vt(){const N=t.addFunction(o+"__finalExponentiationFirstChunk");N.addParam("x","i32"),N.addParam("r","i32");const d=N.getCodeBuilder(),g=d.getLocal("x"),Q=g,U=d.i32_add(g,d.i32_const(r*6)),O=d.getLocal("r"),G=t.alloc(w),M=d.i32_const(G),$=M,Y=d.i32_const(G+r*6),Z=d.i32_const(t.alloc(w)),H=d.i32_const(t.alloc(w)),nt=d.i32_const(t.alloc(w));N.addCode(d.call(at+"_copy",Q,$),d.call(at+"_neg",U,Y),d.call(ct+"_inverse",g,Z),d.call(ct+"_mul",M,Z,H),d.call(o+"__frobeniusMap2",H,nt),d.call(ct+"_mul",H,nt,O))}function Mt(){const N=t.addFunction(o+"__cyclotomicSquare");N.addParam("x","i32"),N.addParam("r","i32");const d=N.getCodeBuilder(),g=d.getLocal("x"),Q=d.i32_add(d.getLocal("x"),d.i32_const(s)),U=d.i32_add(d.getLocal("x"),d.i32_const(2*s)),O=d.i32_add(d.getLocal("x"),d.i32_const(3*s)),G=d.i32_add(d.getLocal("x"),d.i32_const(4*s)),M=d.i32_add(d.getLocal("x"),d.i32_const(5*s)),$=d.getLocal("r"),Y=d.i32_add(d.getLocal("r"),d.i32_const(s)),Z=d.i32_add(d.getLocal("r"),d.i32_const(2*s)),H=d.i32_add(d.getLocal("r"),d.i32_const(3*s)),nt=d.i32_add(d.getLocal("r"),d.i32_const(4*s)),ut=d.i32_add(d.getLocal("r"),d.i32_const(5*s)),_t=d.i32_const(t.alloc(s)),st=d.i32_const(t.alloc(s)),At=d.i32_const(t.alloc(s)),Ct=d.i32_const(t.alloc(s)),St=d.i32_const(t.alloc(s)),yt=d.i32_const(t.alloc(s)),mt=d.i32_const(t.alloc(s)),ft=d.i32_const(t.alloc(s));N.addCode(d.call(F+"_mul",g,G,mt),d.call(F+"_mul",G,d.i32_const(v),_t),d.call(F+"_add",g,_t,_t),d.call(F+"_add",g,G,ft),d.call(F+"_mul",ft,_t,_t),d.call(F+"_mul",d.i32_const(v),mt,ft),d.call(F+"_add",mt,ft,ft),d.call(F+"_sub",_t,ft,_t),d.call(F+"_add",mt,mt,st),d.call(F+"_mul",O,U,mt),d.call(F+"_mul",U,d.i32_const(v),At),d.call(F+"_add",O,At,At),d.call(F+"_add",O,U,ft),d.call(F+"_mul",ft,At,At),d.call(F+"_mul",d.i32_const(v),mt,ft),d.call(F+"_add",mt,ft,ft),d.call(F+"_sub",At,ft,At),d.call(F+"_add",mt,mt,Ct),d.call(F+"_mul",Q,M,mt),d.call(F+"_mul",M,d.i32_const(v),St),d.call(F+"_add",Q,St,St),d.call(F+"_add",Q,M,ft),d.call(F+"_mul",ft,St,St),d.call(F+"_mul",d.i32_const(v),mt,ft),d.call(F+"_add",mt,ft,ft),d.call(F+"_sub",St,ft,St),d.call(F+"_add",mt,mt,yt),d.call(F+"_sub",_t,g,$),d.call(F+"_add",$,$,$),d.call(F+"_add",_t,$,$),d.call(F+"_add",st,G,nt),d.call(F+"_add",nt,nt,nt),d.call(F+"_add",st,nt,nt),d.call(F+"_mul",yt,d.i32_const(ot),ft),d.call(F+"_add",ft,O,H),d.call(F+"_add",H,H,H),d.call(F+"_add",ft,H,H),d.call(F+"_sub",St,U,Z),d.call(F+"_add",Z,Z,Z),d.call(F+"_add",St,Z,Z),d.call(F+"_sub",At,Q,Y),d.call(F+"_add",Y,Y,Y),d.call(F+"_add",At,Y,Y),d.call(F+"_add",Ct,M,ut),d.call(F+"_add",ut,ut,ut),d.call(F+"_add",Ct,ut,ut))}function Kt(N,d){const g=S(N).map(Y=>Y==-1?255:Y),Q=t.alloc(g),U=t.addFunction(o+"__cyclotomicExp_"+d);U.addParam("x","i32"),U.addParam("r","i32"),U.addLocal("bit","i32"),U.addLocal("i","i32");const O=U.getCodeBuilder(),G=O.getLocal("x"),M=O.getLocal("r"),$=O.i32_const(t.alloc(w));U.addCode(O.call(ct+"_conjugate",G,$),O.call(ct+"_one",M),O.if(O.teeLocal("bit",O.i32_load8_s(O.i32_const(g.length-1),Q)),O.if(O.i32_eq(O.getLocal("bit"),O.i32_const(1)),O.call(ct+"_mul",M,G,M),O.call(ct+"_mul",M,$,M))),O.setLocal("i",O.i32_const(g.length-2)),O.block(O.loop(O.call(o+"__cyclotomicSquare",M,M),O.if(O.teeLocal("bit",O.i32_load8_s(O.getLocal("i"),Q)),O.if(O.i32_eq(O.getLocal("bit"),O.i32_const(1)),O.call(ct+"_mul",M,G,M),O.call(ct+"_mul",M,$,M))),O.br_if(1,O.i32_eqz(O.getLocal("i"))),O.setLocal("i",O.i32_sub(O.getLocal("i"),O.i32_const(1))),O.br(0))))}function zt(){Mt(),Kt(f,"w0");const N=t.addFunction(o+"__finalExponentiationLastChunk");N.addParam("x","i32"),N.addParam("r","i32");const d=N.getCodeBuilder(),g=d.getLocal("x"),Q=d.getLocal("r"),U=d.i32_const(t.alloc(w)),O=d.i32_const(t.alloc(w)),G=d.i32_const(t.alloc(w)),M=d.i32_const(t.alloc(w)),$=d.i32_const(t.alloc(w)),Y=d.i32_const(t.alloc(w)),Z=d.i32_const(t.alloc(w)),H=d.i32_const(t.alloc(w)),nt=d.i32_const(t.alloc(w)),ut=d.i32_const(t.alloc(w)),_t=d.i32_const(t.alloc(w)),st=d.i32_const(t.alloc(w)),At=d.i32_const(t.alloc(w)),Ct=d.i32_const(t.alloc(w)),St=d.i32_const(t.alloc(w)),yt=d.i32_const(t.alloc(w)),mt=d.i32_const(t.alloc(w)),ft=d.i32_const(t.alloc(w)),Ot=d.i32_const(t.alloc(w)),Rt=d.i32_const(t.alloc(w)),Wt=d.i32_const(t.alloc(w));N.addCode(d.call(o+"__cyclotomicExp_w0",g,U),d.call(ct+"_conjugate",U,U),d.call(o+"__cyclotomicSquare",U,O),d.call(o+"__cyclotomicSquare",O,G),d.call(ct+"_mul",G,O,M),d.call(o+"__cyclotomicExp_w0",M,$),d.call(ct+"_conjugate",$,$),d.call(o+"__cyclotomicSquare",$,Y),d.call(o+"__cyclotomicExp_w0",Y,Z),d.call(ct+"_conjugate",Z,Z),d.call(ct+"_conjugate",M,H),d.call(ct+"_conjugate",Z,nt),d.call(ct+"_mul",nt,$,ut),d.call(ct+"_mul",ut,H,_t),d.call(ct+"_mul",_t,O,st),d.call(ct+"_mul",_t,$,At),d.call(ct+"_mul",At,g,Ct),d.call(o+"__frobeniusMap1",st,St),d.call(ct+"_mul",St,Ct,yt),d.call(o+"__frobeniusMap2",_t,mt),d.call(ct+"_mul",mt,yt,ft),d.call(ct+"_conjugate",g,Ot),d.call(ct+"_mul",Ot,st,Rt),d.call(o+"__frobeniusMap3",Rt,Wt),d.call(ct+"_mul",Wt,ft,Q))}function Ht(){vt(),zt();const N=t.addFunction(o+"_finalExponentiation");N.addParam("x","i32"),N.addParam("r","i32");const d=N.getCodeBuilder(),g=d.getLocal("x"),Q=d.getLocal("r"),U=d.i32_const(t.alloc(w));N.addCode(d.call(o+"__finalExponentiationFirstChunk",g,U),d.call(o+"__finalExponentiationLastChunk",U,Q))}function qt(){const N=t.addFunction(o+"_finalExponentiationOld");N.addParam("x","i32"),N.addParam("r","i32");const g=t.alloc(Ft.bigInt2BytesLE(552484233613224096312617126783173147097382103762957654188882734314196910839907541213974502761540629817009608548654680343627701153829446747810907373256841551006201639677726139946029199968412598804882391702273019083653272047566316584365559776493027495458238373902875937659943504873220554161550525926302303331747463515644711876653177129578303191095900909191624817826566688241804408081892785725967931714097716709526092261278071952560171111444072049229123565057483750161460024353346284167282452756217662335528813519139808291170539072125381230815729071544861602750936964829313608137325426383735122175229541155376346436093930287402089517426973178917569713384748081827255472576937471496195752727188261435633271238710131736096299798168852925540549342330775279877006784354801422249722573783561685179618816480037695005515426162362431072245638324744480n,352)),Q=N.getCodeBuilder();N.addCode(Q.call(ct+"_exp",Q.getLocal("x"),Q.i32_const(g),Q.i32_const(352),Q.getLocal("r")))}const kt=t.alloc(m),Gt=t.alloc(y);function an(N){const d=t.addFunction(o+"_pairingEq"+N);for(let O=0;O<N;O++)d.addParam("p_"+O,"i32"),d.addParam("q_"+O,"i32");d.addParam("c","i32"),d.setReturnType("i32");const g=d.getCodeBuilder(),Q=g.i32_const(t.alloc(w)),U=g.i32_const(t.alloc(w));d.addCode(g.call(ct+"_one",Q));for(let O=0;O<N;O++)d.addCode(g.call(o+"_prepareG1",g.getLocal("p_"+O),g.i32_const(kt))),d.addCode(g.call(o+"_prepareG2",g.getLocal("q_"+O),g.i32_const(Gt))),d.addCode(g.call(o+"_millerLoop",g.i32_const(kt),g.i32_const(Gt),U)),d.addCode(g.call(ct+"_mul",Q,U,Q));d.addCode(g.call(o+"_finalExponentiation",Q,Q)),d.addCode(g.call(ct+"_eq",Q,g.getLocal("c")))}function Yt(){const N=t.addFunction(o+"_pairing");N.addParam("p","i32"),N.addParam("q","i32"),N.addParam("r","i32");const d=N.getCodeBuilder(),g=d.i32_const(t.alloc(w));N.addCode(d.call(o+"_prepareG1",d.getLocal("p"),d.i32_const(kt))),N.addCode(d.call(o+"_prepareG2",d.getLocal("q"),d.i32_const(Gt))),N.addCode(d.call(o+"_millerLoop",d.i32_const(kt),d.i32_const(Gt),g)),N.addCode(d.call(o+"_finalExponentiation",g,d.getLocal("r")))}et(),It(),R(),pt(),gt(),xt(),rt();for(let N=0;N<10;N++)bt(N),t.exportFunction(o+"__frobeniusMap"+N);qt(),Ht();for(let N=1;N<=5;N++)an(N),t.exportFunction(o+"_pairingEq"+N);Yt(),t.exportFunction(o+"_pairing"),t.exportFunction(o+"_prepareG1"),t.exportFunction(o+"_prepareG2"),t.exportFunction(o+"_millerLoop"),t.exportFunction(o+"_finalExponentiation"),t.exportFunction(o+"_finalExponentiationOld"),t.exportFunction(o+"__mulBy024"),t.exportFunction(o+"__mulBy024Old"),t.exportFunction(o+"__cyclotomicSquare"),t.exportFunction(o+"__cyclotomicExp_w0")};const Bt=wn,Oc=re,Pc=Si,Ee=vi,Qc=Oi,Fe=Pi,So=Qi,Mc=Mi,qc=qi,$n=Ui,{bitLength:xe,isOdd:Se,isNegative:Uc}=jt;var zc=function(t,n){const o=n||"bls12381";if(t.modules[o])return o;const e=0x1a0111ea397fe69a4b1ba7b6434bacd764774b84f38512bf6730d2a0f6b0f6241eabfffeb153ffffb9feffffffffaaabn,l=0x73eda753299d7d483339d80809a1d80553bda402fffe5bfeffffffff00000001n,h=Math.floor((xe(e-1n)-1)/64)+1,r=h*8,A=r,_=A*2,s=A*12,w=Math.floor((xe(l-1n)-1)/64)+1,B=w*8,b=B,k=t.alloc(Bt.bigInt2BytesLE(l,b)),D=Oc(t,e,"f1m","intq");Pc(t,l,"fr","frm","intr");const F=t.alloc(Bt.bigInt2BytesLE(E(4n),A)),q=Fe(t,"g1m","f1m",F);So(t,"frm","frm","frm","frm_mul"),Mc(t,"pol","frm"),qc(t,"qap","frm");const x=Ee(t,"f1m_neg","f2m","f1m"),it=t.alloc([...Bt.bigInt2BytesLE(E(4n),A),...Bt.bigInt2BytesLE(E(4n),A)]),z=Fe(t,"g2m","f2m",it);function lt(d,g){const Q=t.addFunction(d);Q.addParam("pG","i32"),Q.addParam("pFr","i32"),Q.addParam("pr","i32");const U=Q.getCodeBuilder(),O=U.i32_const(t.alloc(B));Q.addCode(U.call("frm_fromMontgomery",U.getLocal("pFr"),O),U.call(g,U.getLocal("pG"),O,U.i32_const(B),U.getLocal("pr"))),t.exportFunction(d)}lt("g1m_timesFr","g1m_timesScalar"),So(t,"g1m","g1m","frm","g1m_timesFr"),lt("g2m_timesFr","g2m_timesScalar"),So(t,"g2m","g2m","frm","g2m_timesFr"),lt("g1m_timesFrAffine","g1m_timesScalarAffine"),lt("g2m_timesFrAffine","g2m_timesScalarAffine"),$n(t,"frm_batchApplyKey","fmr","frm",B,B,B,"frm_mul"),$n(t,"g1m_batchApplyKey","g1m","frm",r*3,r*3,B,"g1m_timesFr"),$n(t,"g1m_batchApplyKeyMixed","g1m","frm",r*2,r*3,B,"g1m_timesFrAffine"),$n(t,"g2m_batchApplyKey","g2m","frm",r*2*3,r*3*2,B,"g2m_timesFr"),$n(t,"g2m_batchApplyKeyMixed","g2m","frm",r*2*2,r*3*2,B,"g2m_timesFrAffine");function E(d){return BigInt(d)*(1n<<BigInt(A*8))%e}const u=[3685416753713387016781088315183077757961620795782546409894578378688607592378376318836054947676345821548104185464507n,1339506544944476473020471379941921221584933875938349620426543736416511423956333506472724655353366534992391756441569n,1n],L=t.alloc([...Bt.bigInt2BytesLE(E(u[0]),A),...Bt.bigInt2BytesLE(E(u[1]),A),...Bt.bigInt2BytesLE(E(u[2]),A)]),V=[0n,1n,0n],j=t.alloc([...Bt.bigInt2BytesLE(E(V[0]),A),...Bt.bigInt2BytesLE(E(V[1]),A),...Bt.bigInt2BytesLE(E(V[2]),A)]),X=[[352701069587466618187139116011060144890029952792775240219908644239793785735715026873347600343865175952761926303160n,3059144344244213709971259814753781636986470325476647558659373206291635324768958432433509563104347017837885763365758n],[1985150602287291935568054521177171638300868978215655730859378665066344726373823718423869104263333984641494340347905n,927553665492332455747201965776037880757740193453592970025027978793976877002675564980949289727957565575433344219582n],[1n,0n]],P=t.alloc([...Bt.bigInt2BytesLE(E(X[0][0]),A),...Bt.bigInt2BytesLE(E(X[0][1]),A),...Bt.bigInt2BytesLE(E(X[1][0]),A),...Bt.bigInt2BytesLE(E(X[1][1]),A),...Bt.bigInt2BytesLE(E(X[2][0]),A),...Bt.bigInt2BytesLE(E(X[2][1]),A)]),I=[[0n,0n],[1n,0n],[0n,0n]],v=t.alloc([...Bt.bigInt2BytesLE(E(I[0][0]),A),...Bt.bigInt2BytesLE(E(I[0][1]),A),...Bt.bigInt2BytesLE(E(I[1][0]),A),...Bt.bigInt2BytesLE(E(I[1][1]),A),...Bt.bigInt2BytesLE(E(I[2][0]),A),...Bt.bigInt2BytesLE(E(I[2][1]),A)]),T=t.alloc([...Bt.bigInt2BytesLE(E(1n),A),...Bt.bigInt2BytesLE(E(0n),A),...Bt.bigInt2BytesLE(E(0n),A),...Bt.bigInt2BytesLE(E(0n),A),...Bt.bigInt2BytesLE(E(0n),A),...Bt.bigInt2BytesLE(E(0n),A),...Bt.bigInt2BytesLE(E(0n),A),...Bt.bigInt2BytesLE(E(0n),A),...Bt.bigInt2BytesLE(E(0n),A),...Bt.bigInt2BytesLE(E(0n),A),...Bt.bigInt2BytesLE(E(0n),A),...Bt.bigInt2BytesLE(E(0n),A)]),ot=t.alloc([...Bt.bigInt2BytesLE(E(1n),A),...Bt.bigInt2BytesLE(E(1n),A)]);function tt(){const d=t.addFunction(x+"_mulNR");d.addParam("x","i32"),d.addParam("pr","i32");const g=d.getCodeBuilder(),Q=g.i32_const(t.alloc(A)),U=g.getLocal("x"),O=g.i32_add(g.getLocal("x"),g.i32_const(A)),G=g.getLocal("pr"),M=g.i32_add(g.getLocal("pr"),g.i32_const(A));d.addCode(g.call(D+"_copy",U,Q),g.call(D+"_sub",U,O,G),g.call(D+"_add",Q,O,M))}tt();const K=Qc(t,x+"_mulNR","f6m","f2m");function at(){const d=t.addFunction(K+"_mulNR");d.addParam("x","i32"),d.addParam("pr","i32");const g=d.getCodeBuilder(),Q=g.i32_const(t.alloc(A*2));d.addCode(g.call(x+"_copy",g.getLocal("x"),Q),g.call(x+"_mulNR",g.i32_add(g.getLocal("x"),g.i32_const(r*4)),g.getLocal("pr")),g.call(x+"_copy",g.i32_add(g.getLocal("x"),g.i32_const(r*2)),g.i32_add(g.getLocal("pr"),g.i32_const(r*4))),g.call(x+"_copy",Q,g.i32_add(g.getLocal("pr"),g.i32_const(r*2))))}at();const W=Ee(t,K+"_mulNR","ftm",K),Lt=J(0xd201000000010000n),wt=t.alloc(Lt),ht=3*_,p=Lt.length-1,C=Lt.reduce((d,g)=>d+(g!=0?1:0),0)+p+1,c=3*2*r,m=3*r*2+C*ht,y=!0,f=15132376222941642752n;t.modules[o]={n64q:h,n64r:w,n8q:r,n8r:B,pG1gen:L,pG1zero:j,pG1b:F,pG2gen:P,pG2zero:v,pG2b:it,pq:t.modules.f1m.pq,pr:k,pOneT:T,r:l,q:e,prePSize:c,preQSize:m};function S(d){let g=d;const Q=[];for(;g>0n;){if(Se(g)){const U=2-Number(g%4n);Q.push(U),g=g-BigInt(U)}else Q.push(0);g=g>>1n}return Q}function J(d){let g=d;const Q=[];for(;g>0n;)Se(g)?Q.push(1):Q.push(0),g=g>>1n;return Q}function R(){const d=t.addFunction(o+"_prepareG1");d.addParam("pP","i32"),d.addParam("ppreP","i32");const g=d.getCodeBuilder();d.addCode(g.call(q+"_normalize",g.getLocal("pP"),g.getLocal("ppreP")))}function et(){const d=t.addFunction(o+"_prepDblStep");d.addParam("R","i32"),d.addParam("r","i32");const g=d.getCodeBuilder(),Q=g.getLocal("R"),U=g.i32_add(g.getLocal("R"),g.i32_const(2*r)),O=g.i32_add(g.getLocal("R"),g.i32_const(4*r)),G=g.getLocal("r"),M=g.i32_add(g.getLocal("r"),g.i32_const(2*r)),$=g.i32_add(g.getLocal("r"),g.i32_const(4*r)),Y=g.i32_const(t.alloc(_)),Z=g.i32_const(t.alloc(_)),H=g.i32_const(t.alloc(_)),nt=g.i32_const(t.alloc(_)),ut=g.i32_const(t.alloc(_));d.addCode(g.call(x+"_square",Q,G),g.call(x+"_square",U,Z),g.call(x+"_square",Z,H),g.call(x+"_add",Z,Q,M),g.call(x+"_square",M,M),g.call(x+"_sub",M,G,M),g.call(x+"_sub",M,H,M),g.call(x+"_add",M,M,M),g.call(x+"_add",G,G,nt),g.call(x+"_add",nt,G,nt),g.call(x+"_add",Q,nt,$),g.call(x+"_square",nt,ut),g.call(x+"_square",O,Y),g.call(x+"_sub",ut,M,Q),g.call(x+"_sub",Q,M,Q),g.call(x+"_add",O,U,O),g.call(x+"_square",O,O),g.call(x+"_sub",O,Z,O),g.call(x+"_sub",O,Y,O),g.call(x+"_sub",M,Q,U),g.call(x+"_mul",U,nt,U),g.call(x+"_add",H,H,H),g.call(x+"_add",H,H,H),g.call(x+"_add",H,H,H),g.call(x+"_sub",U,H,U),g.call(x+"_mul",nt,Y,M),g.call(x+"_add",M,M,M),g.call(x+"_neg",M,M),g.call(x+"_square",$,$),g.call(x+"_sub",$,G,$),g.call(x+"_sub",$,ut,$),g.call(x+"_add",Z,Z,Z),g.call(x+"_add",Z,Z,Z),g.call(x+"_sub",$,Z,$),g.call(x+"_mul",O,Y,G),g.call(x+"_add",G,G,G))}function It(){const d=t.addFunction(o+"_prepAddStep");d.addParam("R","i32"),d.addParam("Q","i32"),d.addParam("r","i32");const g=d.getCodeBuilder(),Q=g.getLocal("R"),U=g.i32_add(g.getLocal("R"),g.i32_const(2*r)),O=g.i32_add(g.getLocal("R"),g.i32_const(4*r)),G=g.getLocal("Q"),M=g.i32_add(g.getLocal("Q"),g.i32_const(2*r)),$=g.getLocal("r"),Y=g.i32_add(g.getLocal("r"),g.i32_const(2*r)),Z=g.i32_add(g.getLocal("r"),g.i32_const(4*r)),H=g.i32_const(t.alloc(_)),nt=g.i32_const(t.alloc(_)),ut=g.i32_const(t.alloc(_)),_t=g.i32_const(t.alloc(_)),st=g.i32_const(t.alloc(_)),At=g.i32_const(t.alloc(_)),Ct=g.i32_const(t.alloc(_)),St=g.i32_const(t.alloc(_)),yt=g.i32_const(t.alloc(_)),mt=g.i32_const(t.alloc(_)),ft=g.i32_const(t.alloc(_));d.addCode(g.call(x+"_square",O,H),g.call(x+"_square",M,nt),g.call(x+"_mul",H,G,_t),g.call(x+"_add",M,O,Y),g.call(x+"_square",Y,Y),g.call(x+"_sub",Y,nt,Y),g.call(x+"_sub",Y,H,Y),g.call(x+"_mul",Y,H,Y),g.call(x+"_sub",_t,Q,st),g.call(x+"_square",st,At),g.call(x+"_add",At,At,Ct),g.call(x+"_add",Ct,Ct,Ct),g.call(x+"_mul",Ct,st,St),g.call(x+"_sub",Y,U,yt),g.call(x+"_sub",yt,U,yt),g.call(x+"_mul",yt,G,Z),g.call(x+"_mul",Ct,Q,mt),g.call(x+"_square",yt,Q),g.call(x+"_sub",Q,St,Q),g.call(x+"_sub",Q,mt,Q),g.call(x+"_sub",Q,mt,Q),g.call(x+"_add",O,st,O),g.call(x+"_square",O,O),g.call(x+"_sub",O,H,O),g.call(x+"_sub",O,At,O),g.call(x+"_add",M,O,$),g.call(x+"_sub",mt,Q,ft),g.call(x+"_mul",ft,yt,ft),g.call(x+"_mul",U,St,_t),g.call(x+"_add",_t,_t,_t),g.call(x+"_sub",ft,_t,U),g.call(x+"_square",$,$),g.call(x+"_sub",$,nt,$),g.call(x+"_square",O,ut),g.call(x+"_sub",$,ut,$),g.call(x+"_add",Z,Z,Z),g.call(x+"_sub",Z,$,Z),g.call(x+"_add",O,O,$),g.call(x+"_neg",yt,yt),g.call(x+"_add",yt,yt,Y))}function dt(){const d=t.addFunction(o+"_prepareG2");d.addParam("pQ","i32"),d.addParam("ppreQ","i32"),d.addLocal("pCoef","i32"),d.addLocal("i","i32");const g=d.getCodeBuilder(),Q=g.getLocal("pQ"),U=t.alloc(_*3),O=g.i32_const(U),G=g.getLocal("ppreQ");d.addCode(g.call(z+"_normalize",Q,G),g.if(g.call(z+"_isZero",G),g.ret([])),g.call(z+"_copy",G,O),g.setLocal("pCoef",g.i32_add(g.getLocal("ppreQ"),g.i32_const(_*3)))),d.addCode(g.setLocal("i",g.i32_const(Lt.length-2)),g.block(g.loop(g.call(o+"_prepDblStep",O,g.getLocal("pCoef")),g.setLocal("pCoef",g.i32_add(g.getLocal("pCoef"),g.i32_const(ht))),g.if(g.i32_load8_s(g.getLocal("i"),wt),[...g.call(o+"_prepAddStep",O,G,g.getLocal("pCoef")),...g.setLocal("pCoef",g.i32_add(g.getLocal("pCoef"),g.i32_const(ht)))]),g.br_if(1,g.i32_eqz(g.getLocal("i"))),g.setLocal("i",g.i32_sub(g.getLocal("i"),g.i32_const(1))),g.br(0))))}function pt(){const d=t.addFunction(K+"_mul1");d.addParam("pA","i32"),d.addParam("pC1","i32"),d.addParam("pR","i32");const g=d.getCodeBuilder(),Q=g.getLocal("pA"),U=g.i32_add(g.getLocal("pA"),g.i32_const(A*2)),O=g.i32_add(g.getLocal("pA"),g.i32_const(A*4)),G=g.getLocal("pC1"),M=g.getLocal("pR"),$=g.i32_add(g.getLocal("pR"),g.i32_const(A*2)),Y=g.i32_add(g.getLocal("pR"),g.i32_const(A*4)),Z=g.i32_const(t.alloc(A*2)),H=g.i32_const(t.alloc(A*2));d.addCode(g.call(x+"_add",Q,U,Z),g.call(x+"_add",U,O,H),g.call(x+"_mul",U,G,Y),g.call(x+"_mul",H,G,M),g.call(x+"_sub",M,Y,M),g.call(x+"_mulNR",M,M),g.call(x+"_mul",Z,G,$),g.call(x+"_sub",$,Y,$))}pt();function xt(){const d=t.addFunction(K+"_mul01");d.addParam("pA","i32"),d.addParam("pC0","i32"),d.addParam("pC1","i32"),d.addParam("pR","i32");const g=d.getCodeBuilder(),Q=g.getLocal("pA"),U=g.i32_add(g.getLocal("pA"),g.i32_const(A*2)),O=g.i32_add(g.getLocal("pA"),g.i32_const(A*4)),G=g.getLocal("pC0"),M=g.getLocal("pC1"),$=g.getLocal("pR"),Y=g.i32_add(g.getLocal("pR"),g.i32_const(A*2)),Z=g.i32_add(g.getLocal("pR"),g.i32_const(A*4)),H=g.i32_const(t.alloc(A*2)),nt=g.i32_const(t.alloc(A*2)),ut=g.i32_const(t.alloc(A*2)),_t=g.i32_const(t.alloc(A*2));d.addCode(g.call(x+"_mul",Q,G,H),g.call(x+"_mul",U,M,nt),g.call(x+"_add",Q,U,ut),g.call(x+"_add",Q,O,_t),g.call(x+"_add",U,O,$),g.call(x+"_mul",$,M,$),g.call(x+"_sub",$,nt,$),g.call(x+"_mulNR",$,$),g.call(x+"_add",$,H,$),g.call(x+"_add",G,M,Y),g.call(x+"_mul",Y,ut,Y),g.call(x+"_sub",Y,H,Y),g.call(x+"_sub",Y,nt,Y),g.call(x+"_mul",_t,G,Z),g.call(x+"_sub",Z,H,Z),g.call(x+"_add",Z,nt,Z))}xt();function gt(){const d=t.addFunction(W+"_mul014");d.addParam("pA","i32"),d.addParam("pC0","i32"),d.addParam("pC1","i32"),d.addParam("pC4","i32"),d.addParam("pR","i32");const g=d.getCodeBuilder(),Q=g.getLocal("pA"),U=g.i32_add(g.getLocal("pA"),g.i32_const(A*6)),O=g.getLocal("pC0"),G=g.getLocal("pC1"),M=g.getLocal("pC4"),$=g.i32_const(t.alloc(A*6)),Y=g.i32_const(t.alloc(A*6)),Z=g.i32_const(t.alloc(A*2)),H=g.getLocal("pR"),nt=g.i32_add(g.getLocal("pR"),g.i32_const(A*6));d.addCode(g.call(K+"_mul01",Q,O,G,$),g.call(K+"_mul1",U,M,Y),g.call(x+"_add",G,M,Z),g.call(K+"_add",U,Q,nt),g.call(K+"_mul01",nt,O,Z,nt),g.call(K+"_sub",nt,$,nt),g.call(K+"_sub",nt,Y,nt),g.call(K+"_copy",Y,H),g.call(K+"_mulNR",H,H),g.call(K+"_add",H,$,H))}gt();function rt(){const d=t.addFunction(o+"_ell");d.addParam("pP","i32"),d.addParam("pCoefs","i32"),d.addParam("pF","i32");const g=d.getCodeBuilder(),Q=g.getLocal("pP"),U=g.i32_add(g.getLocal("pP"),g.i32_const(r)),O=g.getLocal("pF"),G=g.getLocal("pCoefs"),M=g.i32_add(g.getLocal("pCoefs"),g.i32_const(A)),$=g.i32_add(g.getLocal("pCoefs"),g.i32_const(A*2)),Y=g.i32_add(g.getLocal("pCoefs"),g.i32_const(A*3)),Z=g.i32_add(g.getLocal("pCoefs"),g.i32_const(A*4)),H=t.alloc(A*2),nt=g.i32_const(H),ut=g.i32_const(H),_t=g.i32_const(H+A),st=t.alloc(A*2),At=g.i32_const(st),Ct=g.i32_const(st),St=g.i32_const(st+A);d.addCode(g.call(D+"_mul",G,U,ut),g.call(D+"_mul",M,U,_t),g.call(D+"_mul",$,Q,Ct),g.call(D+"_mul",Y,Q,St),g.call(W+"_mul014",O,Z,At,nt,O))}rt();function bt(){const d=t.addFunction(o+"_millerLoop");d.addParam("ppreP","i32"),d.addParam("ppreQ","i32"),d.addParam("r","i32"),d.addLocal("pCoef","i32"),d.addLocal("i","i32");const g=d.getCodeBuilder(),Q=g.getLocal("ppreP"),U=g.getLocal("pCoef"),O=g.getLocal("r");d.addCode(g.call(W+"_one",O),g.if(g.call(q+"_isZero",Q),g.ret([])),g.if(g.call(q+"_isZero",g.getLocal("ppreQ")),g.ret([])),g.setLocal("pCoef",g.i32_add(g.getLocal("ppreQ"),g.i32_const(_*3))),g.setLocal("i",g.i32_const(Lt.length-2)),g.block(g.loop(g.call(o+"_ell",Q,U,O),g.setLocal("pCoef",g.i32_add(g.getLocal("pCoef"),g.i32_const(ht))),g.if(g.i32_load8_s(g.getLocal("i"),wt),[...g.call(o+"_ell",Q,U,O),...g.setLocal("pCoef",g.i32_add(g.getLocal("pCoef"),g.i32_const(ht)))]),g.call(W+"_square",O,O),g.br_if(1,g.i32_eq(g.getLocal("i"),g.i32_const(1))),g.setLocal("i",g.i32_sub(g.getLocal("i"),g.i32_const(1))),g.br(0))),g.call(o+"_ell",Q,U,O)),d.addCode(g.call(W+"_conjugate",O,O))}function vt(d){const g=[[[1n,0n],[1n,0n],[1n,0n],[1n,0n],[1n,0n],[1n,0n],[1n,0n],[1n,0n],[1n,0n],[1n,0n],[1n,0n],[1n,0n]],[[1n,0n],[3850754370037169011952147076051364057158807420970682438676050522613628423219637725072182697113062777891589506424760n,151655185184498381465642749684540099398075398968325446656007613510403227271200139370504932015952886146304766135027n],[793479390729215512621379701633421447060886740281060493010456487427281649075476305620758731620351n,0n],[2973677408986561043442465346520108879172042883009249989176415018091420807192182638567116318576472649347015917690530n,1028732146235106349975324479215795277384839936929757896155643118032610843298655225875571310552543014690878354869257n],[793479390729215512621379701633421447060886740281060493010456487427281649075476305620758731620350n,0n],[3125332594171059424908108096204648978570118281977575435832422631601824034463382777937621250592425535493320683825557n,877076961050607968509681729531255177986764537961432449499635504522207616027455086505066378536590128544573588734230n],[4002409555221667393417789825735904156556882819939007885332058136124031650490837864442687629129015664037894272559786n,0n],[151655185184498381465642749684540099398075398968325446656007613510403227271200139370504932015952886146304766135027n,3850754370037169011952147076051364057158807420970682438676050522613628423219637725072182697113062777891589506424760n],[4002409555221667392624310435006688643935503118305586438271171395842971157480381377015405980053539358417135540939436n,0n],[1028732146235106349975324479215795277384839936929757896155643118032610843298655225875571310552543014690878354869257n,2973677408986561043442465346520108879172042883009249989176415018091420807192182638567116318576472649347015917690530n],[4002409555221667392624310435006688643935503118305586438271171395842971157480381377015405980053539358417135540939437n,0n],[877076961050607968509681729531255177986764537961432449499635504522207616027455086505066378536590128544573588734230n,3125332594171059424908108096204648978570118281977575435832422631601824034463382777937621250592425535493320683825557n]]],Q=[[[1n,0n],[1n,0n],[1n,0n],[1n,0n],[1n,0n],[1n,0n]],[[1n,0n],[0n,4002409555221667392624310435006688643935503118305586438271171395842971157480381377015405980053539358417135540939436n],[793479390729215512621379701633421447060886740281060493010456487427281649075476305620758731620350n,0n],[0n,1n],[4002409555221667392624310435006688643935503118305586438271171395842971157480381377015405980053539358417135540939436n,0n],[0n,793479390729215512621379701633421447060886740281060493010456487427281649075476305620758731620350n]],[[1n,0n],[4002409555221667392624310435006688643935503118305586438271171395842971157480381377015405980053539358417135540939437n,0n],[4002409555221667392624310435006688643935503118305586438271171395842971157480381377015405980053539358417135540939436n,0n],[4002409555221667393417789825735904156556882819939007885332058136124031650490837864442687629129015664037894272559786n,0n],[793479390729215512621379701633421447060886740281060493010456487427281649075476305620758731620350n,0n],[793479390729215512621379701633421447060886740281060493010456487427281649075476305620758731620351n,0n]]],U=t.addFunction(W+"_frobeniusMap"+d);U.addParam("x","i32"),U.addParam("r","i32");const O=U.getCodeBuilder();for(let M=0;M<6;M++){const $=M==0?O.getLocal("x"):O.i32_add(O.getLocal("x"),O.i32_const(M*_)),Y=$,Z=O.i32_add(O.getLocal("x"),O.i32_const(M*_+A)),H=M==0?O.getLocal("r"):O.i32_add(O.getLocal("r"),O.i32_const(M*_)),nt=H,ut=O.i32_add(O.getLocal("r"),O.i32_const(M*_+A)),_t=G(g[Math.floor(M/3)][d%12],Q[M%3][d%6]),st=t.alloc([...Bt.bigInt2BytesLE(E(_t[0]),r),...Bt.bigInt2BytesLE(E(_t[1]),r)]);d%2==1?U.addCode(O.call(D+"_copy",Y,nt),O.call(D+"_neg",Z,ut),O.call(x+"_mul",H,O.i32_const(st),H)):U.addCode(O.call(x+"_mul",$,O.i32_const(st),H))}function G(M,$){const Y=M[0],Z=M[1],H=$[0],nt=$[1],ut=[(Y*H-Z*nt)%e,(Y*nt+Z*H)%e];return Uc(ut[0])&&(ut[0]=ut[0]+e),ut}}function Mt(){const d=t.addFunction(o+"__cyclotomicSquare");d.addParam("x","i32"),d.addParam("r","i32");const g=d.getCodeBuilder(),Q=g.getLocal("x"),U=g.i32_add(g.getLocal("x"),g.i32_const(_)),O=g.i32_add(g.getLocal("x"),g.i32_const(2*_)),G=g.i32_add(g.getLocal("x"),g.i32_const(3*_)),M=g.i32_add(g.getLocal("x"),g.i32_const(4*_)),$=g.i32_add(g.getLocal("x"),g.i32_const(5*_)),Y=g.getLocal("r"),Z=g.i32_add(g.getLocal("r"),g.i32_const(_)),H=g.i32_add(g.getLocal("r"),g.i32_const(2*_)),nt=g.i32_add(g.getLocal("r"),g.i32_const(3*_)),ut=g.i32_add(g.getLocal("r"),g.i32_const(4*_)),_t=g.i32_add(g.getLocal("r"),g.i32_const(5*_)),st=g.i32_const(t.alloc(_)),At=g.i32_const(t.alloc(_)),Ct=g.i32_const(t.alloc(_)),St=g.i32_const(t.alloc(_)),yt=g.i32_const(t.alloc(_)),mt=g.i32_const(t.alloc(_)),ft=g.i32_const(t.alloc(_)),Ot=g.i32_const(t.alloc(_));d.addCode(g.call(x+"_mul",Q,M,ft),g.call(x+"_mulNR",M,st),g.call(x+"_add",Q,st,st),g.call(x+"_add",Q,M,Ot),g.call(x+"_mul",Ot,st,st),g.call(x+"_mulNR",ft,Ot),g.call(x+"_add",ft,Ot,Ot),g.call(x+"_sub",st,Ot,st),g.call(x+"_add",ft,ft,At),g.call(x+"_mul",G,O,ft),g.call(x+"_mulNR",O,Ct),g.call(x+"_add",G,Ct,Ct),g.call(x+"_add",G,O,Ot),g.call(x+"_mul",Ot,Ct,Ct),g.call(x+"_mulNR",ft,Ot),g.call(x+"_add",ft,Ot,Ot),g.call(x+"_sub",Ct,Ot,Ct),g.call(x+"_add",ft,ft,St),g.call(x+"_mul",U,$,ft),g.call(x+"_mulNR",$,yt),g.call(x+"_add",U,yt,yt),g.call(x+"_add",U,$,Ot),g.call(x+"_mul",Ot,yt,yt),g.call(x+"_mulNR",ft,Ot),g.call(x+"_add",ft,Ot,Ot),g.call(x+"_sub",yt,Ot,yt),g.call(x+"_add",ft,ft,mt),g.call(x+"_sub",st,Q,Y),g.call(x+"_add",Y,Y,Y),g.call(x+"_add",st,Y,Y),g.call(x+"_add",At,M,ut),g.call(x+"_add",ut,ut,ut),g.call(x+"_add",At,ut,ut),g.call(x+"_mul",mt,g.i32_const(ot),Ot),g.call(x+"_add",Ot,G,nt),g.call(x+"_add",nt,nt,nt),g.call(x+"_add",Ot,nt,nt),g.call(x+"_sub",yt,O,H),g.call(x+"_add",H,H,H),g.call(x+"_add",yt,H,H),g.call(x+"_sub",Ct,U,Z),g.call(x+"_add",Z,Z,Z),g.call(x+"_add",Ct,Z,Z),g.call(x+"_add",St,$,_t),g.call(x+"_add",_t,_t,_t),g.call(x+"_add",St,_t,_t))}function Kt(d,g,Q){const U=S(d).map(H=>H==-1?255:H),O=t.alloc(U),G=t.addFunction(o+"__cyclotomicExp_"+Q);G.addParam("x","i32"),G.addParam("r","i32"),G.addLocal("bit","i32"),G.addLocal("i","i32");const M=G.getCodeBuilder(),$=M.getLocal("x"),Y=M.getLocal("r"),Z=M.i32_const(t.alloc(s));G.addCode(M.call(W+"_conjugate",$,Z),M.call(W+"_one",Y),M.if(M.teeLocal("bit",M.i32_load8_s(M.i32_const(U.length-1),O)),M.if(M.i32_eq(M.getLocal("bit"),M.i32_const(1)),M.call(W+"_mul",Y,$,Y),M.call(W+"_mul",Y,Z,Y))),M.setLocal("i",M.i32_const(U.length-2)),M.block(M.loop(M.call(o+"__cyclotomicSquare",Y,Y),M.if(M.teeLocal("bit",M.i32_load8_s(M.getLocal("i"),O)),M.if(M.i32_eq(M.getLocal("bit"),M.i32_const(1)),M.call(W+"_mul",Y,$,Y),M.call(W+"_mul",Y,Z,Y))),M.br_if(1,M.i32_eqz(M.getLocal("i"))),M.setLocal("i",M.i32_sub(M.getLocal("i"),M.i32_const(1))),M.br(0)))),G.addCode(M.call(W+"_conjugate",Y,Y))}function zt(){Mt(),Kt(f,y,"w0");const d=t.addFunction(o+"_finalExponentiation");d.addParam("x","i32"),d.addParam("r","i32");const g=d.getCodeBuilder(),Q=g.getLocal("x"),U=g.getLocal("r"),O=g.i32_const(t.alloc(s)),G=g.i32_const(t.alloc(s)),M=g.i32_const(t.alloc(s)),$=g.i32_const(t.alloc(s)),Y=g.i32_const(t.alloc(s)),Z=g.i32_const(t.alloc(s)),H=g.i32_const(t.alloc(s));d.addCode(g.call(W+"_frobeniusMap6",Q,O),g.call(W+"_inverse",Q,G),g.call(W+"_mul",O,G,M),g.call(W+"_copy",M,G),g.call(W+"_frobeniusMap2",M,M),g.call(W+"_mul",M,G,M),g.call(o+"__cyclotomicSquare",M,G),g.call(W+"_conjugate",G,G),g.call(o+"__cyclotomicExp_w0",M,$),g.call(o+"__cyclotomicSquare",$,Y),g.call(W+"_mul",G,$,Z),g.call(o+"__cyclotomicExp_w0",Z,G),g.call(o+"__cyclotomicExp_w0",G,O),g.call(o+"__cyclotomicExp_w0",O,H),g.call(W+"_mul",H,Y,H),g.call(o+"__cyclotomicExp_w0",H,Y),g.call(W+"_conjugate",Z,Z),g.call(W+"_mul",Y,Z,Y),g.call(W+"_mul",Y,M,Y),g.call(W+"_conjugate",M,Z),g.call(W+"_mul",G,M,G),g.call(W+"_frobeniusMap3",G,G),g.call(W+"_mul",H,Z,H),g.call(W+"_frobeniusMap1",H,H),g.call(W+"_mul",$,O,$),g.call(W+"_frobeniusMap2",$,$),g.call(W+"_mul",$,G,$),g.call(W+"_mul",$,H,$),g.call(W+"_mul",$,Y,U))}function Ht(){const d=t.addFunction(o+"_finalExponentiationOld");d.addParam("x","i32"),d.addParam("r","i32");const Q=t.alloc(Bt.bigInt2BytesLE(322277361516934140462891564586510139908379969514828494218366688025288661041104682794998680497580008899973249814104447692778988208376779573819485263026159588510513834876303014016798809919343532899164848730280942609956670917565618115867287399623286813270357901731510188149934363360381614501334086825442271920079363289954510565375378443704372994881406797882676971082200626541916413184642520269678897559532260949334760604962086348898118982248842634379637598665468817769075878555493752214492790122785850202957575200176084204422751485957336465472324810982833638490904279282696134323072515220044451592646885410572234451732790590013479358343841220074174848221722017083597872017638514103174122784843925578370430843522959600095676285723737049438346544753168912974976791528535276317256904336520179281145394686565050419250614107803233314658825463117900250701199181529205942363159325765991819433914303908860460720581408201373164047773794825411011922305820065611121544561808414055302212057471395719432072209245600258134364584636810093520285711072578721435517884103526483832733289802426157301542744476740008494780363354305116978805620671467071400711358839553375340724899735460480144599782014906586543813292157922220645089192130209334926661588737007768565838519456601560804957985667880395221049249803753582637708560n,544)),U=d.getCodeBuilder();d.addCode(U.call(W+"_exp",U.getLocal("x"),U.i32_const(Q),U.i32_const(544),U.getLocal("r")))}const qt=t.alloc(c),kt=t.alloc(m);function Gt(d){const g=t.addFunction(o+"_pairingEq"+d);for(let G=0;G<d;G++)g.addParam("p_"+G,"i32"),g.addParam("q_"+G,"i32");g.addParam("c","i32"),g.setReturnType("i32");const Q=g.getCodeBuilder(),U=Q.i32_const(t.alloc(s)),O=Q.i32_const(t.alloc(s));g.addCode(Q.call(W+"_one",U));for(let G=0;G<d;G++)g.addCode(Q.call(o+"_prepareG1",Q.getLocal("p_"+G),Q.i32_const(qt))),g.addCode(Q.call(o+"_prepareG2",Q.getLocal("q_"+G),Q.i32_const(kt))),g.addCode(Q.if(Q.i32_eqz(Q.call(q+"_inGroupAffine",Q.i32_const(qt))),Q.ret(Q.i32_const(0))),Q.if(Q.i32_eqz(Q.call(z+"_inGroupAffine",Q.i32_const(kt))),Q.ret(Q.i32_const(0)))),g.addCode(Q.call(o+"_millerLoop",Q.i32_const(qt),Q.i32_const(kt),O)),g.addCode(Q.call(W+"_mul",U,O,U));g.addCode(Q.call(o+"_finalExponentiation",U,U)),g.addCode(Q.call(W+"_eq",U,Q.getLocal("c")))}function an(){const d=t.addFunction(o+"_pairing");d.addParam("p","i32"),d.addParam("q","i32"),d.addParam("r","i32");const g=d.getCodeBuilder(),Q=g.i32_const(t.alloc(s));d.addCode(g.call(o+"_prepareG1",g.getLocal("p"),g.i32_const(qt))),d.addCode(g.call(o+"_prepareG2",g.getLocal("q"),g.i32_const(kt))),d.addCode(g.call(o+"_millerLoop",g.i32_const(qt),g.i32_const(kt),Q)),d.addCode(g.call(o+"_finalExponentiation",Q,g.getLocal("r")))}function Yt(){const d=t.addFunction(z+"_inGroupAffine");d.addParam("p","i32"),d.setReturnType("i32");const g=d.getCodeBuilder(),Q=[2001204777610833696708894912867952078278441409969503942666029068062015825245418932221343814564507832018947136279894n,2001204777610833696708894912867952078278441409969503942666029068062015825245418932221343814564507832018947136279893n],U=4002409555221667392624310435006688643935503118305586438271171395842971157480381377015405980053539358417135540939436n,O=[2973677408986561043442465346520108879172042883009249989176415018091420807192182638567116318576472649347015917690530n,2973677408986561043442465346520108879172042883009249989176415018091420807192182638567116318576472649347015917690530n],G=g.i32_const(t.alloc([...Bt.bigInt2BytesLE(E(Q[0]),r),...Bt.bigInt2BytesLE(E(Q[1]),r)])),M=g.i32_const(t.alloc(Bt.bigInt2BytesLE(E(U),r))),$=g.i32_const(t.alloc([...Bt.bigInt2BytesLE(E(O[0]),r),...Bt.bigInt2BytesLE(E(O[1]),r)])),Y=g.i32_const(t.alloc(Bt.bigInt2BytesLE(f,8))),Z=g.getLocal("p"),H=g.i32_add(g.getLocal("p"),g.i32_const(_)),nt=g.i32_const(t.alloc(A)),ut=g.i32_const(t.alloc(_)),_t=g.i32_const(t.alloc(_)),st=t.alloc(_*2),At=g.i32_const(st),Ct=g.i32_const(st),St=g.i32_const(st),yt=g.i32_const(st+A),mt=g.i32_const(st+_),ft=g.i32_const(st+_),Ot=g.i32_const(st+_+A),Rt=t.alloc(_*3),Wt=g.i32_const(Rt),Qn=g.i32_const(Rt),Ln=g.i32_const(Rt),An=g.i32_const(Rt+A),Mn=g.i32_const(Rt+_),bn=g.i32_const(Rt+_),In=g.i32_const(Rt+_+A),qn=g.i32_const(Rt+_*2);d.addCode(g.if(g.call(z+"_isZeroAffine",g.getLocal("p")),g.ret(g.i32_const(1))),g.if(g.i32_eqz(g.call(z+"_inCurveAffine",g.getLocal("p"))),g.ret(g.i32_const(0))),g.call(x+"_mul",Z,G,ut),g.call(x+"_mul",H,G,_t),g.call(x+"_mul1",ut,M,Ct),g.call(x+"_neg",_t,mt),g.call(x+"_neg",ut,Qn),g.call(x+"_mul",_t,$,Mn),g.call(D+"_sub",St,yt,nt),g.call(D+"_add",St,yt,yt),g.call(D+"_copy",nt,St),g.call(D+"_sub",ft,Ot,nt),g.call(D+"_add",ft,Ot,Ot),g.call(D+"_copy",nt,ft),g.call(D+"_add",Ln,An,nt),g.call(D+"_sub",Ln,An,An),g.call(D+"_copy",nt,Ln),g.call(D+"_sub",In,bn,nt),g.call(D+"_add",bn,In,In),g.call(D+"_copy",nt,bn),g.call(x+"_one",qn),g.call(z+"_timesScalar",Wt,Y,g.i32_const(8),Wt),g.call(z+"_addMixed",Wt,At,Wt),g.ret(g.call(z+"_eqMixed",Wt,g.getLocal("p"))));const dn=t.addFunction(z+"_inGroup");dn.addParam("pIn","i32"),dn.setReturnType("i32");const cn=dn.getCodeBuilder(),Bn=cn.i32_const(t.alloc(_*2));dn.addCode(cn.call(z+"_toAffine",cn.getLocal("pIn"),Bn),cn.ret(cn.call(z+"_inGroupAffine",Bn)))}function N(){const d=t.addFunction(q+"_inGroupAffine");d.addParam("p","i32"),d.setReturnType("i32");const g=d.getCodeBuilder(),Q=4002409555221667392624310435006688643935503118305586438271171395842971157480381377015405980053539358417135540939436n,U=793479390729215512621379701633421447060886740281060493010456487427281649075476305620758731620350n,O=(f*f-1n)/3n,G=g.i32_const(t.alloc(Bt.bigInt2BytesLE(E(Q),r))),M=g.i32_const(t.alloc(Bt.bigInt2BytesLE(E(U),r))),$=g.i32_const(t.alloc(Bt.bigInt2BytesLE(O,16))),Y=g.getLocal("p"),Z=g.i32_add(g.getLocal("p"),g.i32_const(A)),H=t.alloc(A*3),nt=g.i32_const(H),ut=g.i32_const(H),_t=g.i32_const(H+A),st=t.alloc(A*2),At=g.i32_const(st),Ct=g.i32_const(st),St=g.i32_const(st+A);d.addCode(g.if(g.call(q+"_isZeroAffine",g.getLocal("p")),g.ret(g.i32_const(1))),g.if(g.i32_eqz(g.call(q+"_inCurveAffine",g.getLocal("p"))),g.ret(g.i32_const(0))),g.call(D+"_mul",Y,G,ut),g.call(D+"_copy",Z,_t),g.call(D+"_mul",Y,M,Ct),g.call(D+"_copy",Z,St),g.call(q+"_doubleAffine",nt,nt),g.call(q+"_subMixed",nt,g.getLocal("p"),nt),g.call(q+"_subMixed",nt,At,nt),g.call(q+"_timesScalar",nt,$,g.i32_const(16),nt),g.ret(g.call(q+"_eqMixed",nt,At)));const yt=t.addFunction(q+"_inGroup");yt.addParam("pIn","i32"),yt.setReturnType("i32");const mt=yt.getCodeBuilder(),ft=mt.i32_const(t.alloc(A*2));yt.addCode(mt.call(q+"_toAffine",mt.getLocal("pIn"),ft),mt.ret(mt.call(q+"_inGroupAffine",ft)))}for(let d=0;d<10;d++)vt(d),t.exportFunction(W+"_frobeniusMap"+d);N(),Yt(),It(),et(),R(),dt(),bt(),Ht(),zt();for(let d=1;d<=5;d++)Gt(d),t.exportFunction(o+"_pairingEq"+d);an(),t.exportFunction(o+"_pairing"),t.exportFunction(o+"_prepareG1"),t.exportFunction(o+"_prepareG2"),t.exportFunction(o+"_millerLoop"),t.exportFunction(o+"_finalExponentiation"),t.exportFunction(o+"_finalExponentiationOld"),t.exportFunction(o+"__cyclotomicSquare"),t.exportFunction(o+"__cyclotomicExp_w0"),t.exportFunction(K+"_mul1"),t.exportFunction(K+"_mul01"),t.exportFunction(W+"_mul014"),t.exportFunction(q+"_inGroupAffine"),t.exportFunction(q+"_inGroup"),t.exportFunction(z+"_inGroupAffine"),t.exportFunction(z+"_inGroup")},Tc=vc,kc=zc;function Ro(a){if(typeof a=="bigint"||a.eq!==void 0)return a.toString(10);if(a instanceof Uint8Array)return to(a,0);if(Array.isArray(a))return a.map(Ro);if(typeof a=="object"){const t={};return Object.keys(a).forEach(o=>{t[o]=Ro(a[o])}),t}else return a}function No(a){if(typeof a=="string"&&/^[0-9]+$/.test(a))return BigInt(a);if(typeof a=="string"&&/^0x[0-9a-fA-F]+$/.test(a))return BigInt(a);if(Array.isArray(a))return a.map(No);if(typeof a=="object"){if(a===null)return null;const t={};return Object.keys(a).forEach(o=>{t[o]=No(a[o])}),t}else return a}function Dc(a){let t=BigInt(0),n=a.length,o=0;const e=new DataView(a.buffer,a.byteOffset,a.byteLength);for(;n>0;)n>=4?(n-=4,t+=BigInt(e.getUint32(n))<<BigInt(o*8),o+=4):n>=2?(n-=2,t+=BigInt(e.getUint16(n))<<BigInt(o*8),o+=2):(n-=1,t+=BigInt(e.getUint8(n))<<BigInt(o*8),o+=1);return t}function Gc(a,t){let n=a;const o=new Uint8Array(t),e=new DataView(o.buffer);let l=t;for(;l>0;)l-4>=0?(l-=4,e.setUint32(l,Number(n&BigInt(4294967295))),n=n>>BigInt(32)):l-2>=0?(l-=2,e.setUint16(l,Number(n&BigInt(65535))),n=n>>BigInt(16)):(l-=1,e.setUint8(l,Number(n&BigInt(255))),n=n>>BigInt(8));if(n)throw new Error("Number does not fit in this length");return o}function Rc(a){let t=BigInt(0),n=0;const o=new DataView(a.buffer,a.byteOffset,a.byteLength);for(;n<a.length;)n+4<=a.length?(t+=BigInt(o.getUint32(n,!0))<<BigInt(n*8),n+=4):n+2<=a.length?(t+=BigInt(o.getUint16(n,!0))<<BigInt(n*8),n+=2):(t+=BigInt(o.getUint8(n,!0))<<BigInt(n*8),n+=1);return t}function zi(a,t){let n=a;typeof t>"u"&&(t=Math.floor((no(a)-1)/8)+1,t==0&&(t=1));const o=new Uint8Array(t),e=new DataView(o.buffer);let l=0;for(;l<t;)l+4<=t?(e.setUint32(l,Number(n&BigInt(4294967295)),!0),l+=4,n=n>>BigInt(32)):l+2<=t?(e.setUint16(l,Number(n&BigInt(65535)),!0),l+=2,n=n>>BigInt(16)):(e.setUint8(l,Number(n&BigInt(255)),!0),l+=1,n=n>>BigInt(8));if(n)throw new Error("Number does not fit in this length");return o}function Ko(a,t){if(typeof t=="bigint"||t.eq!==void 0)return t.toString(10);if(t instanceof Uint8Array)return a.toString(a.e(t));if(Array.isArray(t))return t.map(Ko.bind(this,a));if(typeof t=="object"){const n={};return Object.keys(t).forEach(e=>{n[e]=Ko(a,t[e])}),n}else return t}function Ho(a,t){if(typeof t=="string"&&/^[0-9]+$/.test(t))return a.e(t);if(typeof t=="string"&&/^0x[0-9a-fA-F]+$/.test(t))return a.e(t);if(Array.isArray(t))return t.map(Ho.bind(this,a));if(typeof t=="object"){if(t===null)return null;const n={};return Object.keys(t).forEach(e=>{n[e]=Ho(a,t[e])}),n}else return t}const Zn=[];for(let a=0;a<256;a++)Zn[a]=Nc(a,8);function Nc(a,t){let n=0,o=a;for(let e=0;e<t;e++)n<<=1,n=n|o&1,o>>=1;return n}function Ti(a,t){return(Zn[a>>>24]|Zn[a>>>16&255]<<8|Zn[a>>>8&255]<<16|Zn[a&255]<<24)>>>32-t}function Zt(a){return(a&4294901760?(a&=4294901760,16):0)|(a&4278255360?(a&=4278255360,8):0)|(a&4042322160?(a&=4042322160,4):0)|(a&3435973836?(a&=3435973836,2):0)|(a&2863311530)!==0}function ki(a,t){const n=a.byteLength/t,o=Zt(n);if(n!=1<<o)throw new Error("Invalid number of pointers");for(let e=0;e<n;e++){const l=Ti(e,o);if(e>l){const h=a.slice(e*t,(e+1)*t);a.set(a.slice(l*t,(l+1)*t),e*t),a.set(h,l*t)}}}function de(a,t){const n=new Uint8Array(t*a.length);for(let o=0;o<a.length;o++)n.set(a[o],o*t);return n}function Ao(a,t){const n=a.byteLength/t,o=new Array(n);for(let e=0;e<n;e++)o[e]=a.slice(e*t,e*t+t);return o}var Kc=Object.freeze({__proto__:null,array2buffer:de,beBuff2int:Dc,beInt2Buff:Gc,bitReverse:Ti,buffReverseBits:ki,buffer2array:Ao,leBuff2int:Rc,leInt2Buff:zi,log2:Zt,stringifyBigInts:Ro,stringifyFElements:Ko,unstringifyBigInts:No,unstringifyFElements:Ho});const Dt=1<<30;class Pt{constructor(t){this.buffers=[],this.byteLength=t;for(let n=0;n<t;n+=Dt){const o=Math.min(t-n,Dt);this.buffers.push(new Uint8Array(o))}}slice(t,n){n===void 0&&(n=this.byteLength),t===void 0&&(t=0);const o=n-t,e=Math.floor(t/Dt),l=Math.floor((t+o-1)/Dt);if(e==l||o==0)return this.buffers[e].slice(t%Dt,t%Dt+o);let h,r=e,A=t%Dt,_=o;for(;_>0;){const s=A+_>Dt?Dt-A:_,w=new Uint8Array(this.buffers[r].buffer,this.buffers[r].byteOffset+A,s);if(s==o)return w.slice();h||(o<=Dt?h=new Uint8Array(o):h=new Pt(o)),h.set(w,o-_),_=_-s,r++,A=0}return h}set(t,n){n===void 0&&(n=0);const o=t.byteLength;if(o==0)return;const e=Math.floor(n/Dt),l=Math.floor((n+o-1)/Dt);if(e==l)return t instanceof Pt&&t.buffers.length==1?this.buffers[e].set(t.buffers[0],n%Dt):this.buffers[e].set(t,n%Dt);let h=e,r=n%Dt,A=o;for(;A>0;){const _=r+A>Dt?Dt-r:A,s=t.slice(o-A,o-A+_);new Uint8Array(this.buffers[h].buffer,this.buffers[h].byteOffset+r,_).set(s),A=A-_,h++,r=0}}}function Cn(a,t,n,o){return async function(l){const h=Math.floor(l.byteLength/n);if(h*n!==l.byteLength)throw new Error("Invalid buffer size");const r=Math.floor(h/a.concurrency),A=[];for(let B=0;B<a.concurrency;B++){let b;if(B<a.concurrency-1?b=r:b=h-B*r,b==0)continue;const D=[{cmd:"ALLOCSET",var:0,buff:l.slice(B*r*n,B*r*n+b*n)},{cmd:"ALLOC",var:1,len:o*b},{cmd:"CALL",fnName:t,params:[{var:0},{val:b},{var:1}]},{cmd:"GET",out:0,var:1,len:o*b}];A.push(a.queueAction(D))}const _=await Promise.all(A);let s;l instanceof Pt?s=new Pt(h*o):s=new Uint8Array(h*o);let w=0;for(let B=0;B<_.length;B++)s.set(_[B][0],w),w+=_[B][0].byteLength;return s}}class ve{constructor(t,n,o,e){if(this.tm=t,this.prefix=n,this.p=e,this.n8=o,this.type="F1",this.m=1,this.half=Tn(e,xn),this.bitLength=no(e),this.mask=fn(po(xn,this.bitLength),xn),this.pOp1=t.alloc(o),this.pOp2=t.alloc(o),this.pOp3=t.alloc(o),this.tm.instance.exports[n+"_zero"](this.pOp1),this.zero=this.tm.getBuff(this.pOp1,this.n8),this.tm.instance.exports[n+"_one"](this.pOp1),this.one=this.tm.getBuff(this.pOp1,this.n8),this.negone=this.neg(this.one),this.two=this.add(this.one,this.one),this.n64=Math.floor(o/8),this.n32=Math.floor(o/4),this.n64*8!=this.n8)throw new Error("n8 must be a multiple of 8");this.half=Tn(this.p,xn),this.nqr=this.two;let l=this.exp(this.nqr,this.half);for(;!this.eq(l,this.negone);)this.nqr=this.add(this.nqr,this.one),l=this.exp(this.nqr,this.half);this.shift=this.mul(this.nqr,this.nqr),this.shiftInv=this.inv(this.shift),this.s=0;let h=fn(this.p,xn);for(;!ne(h);)this.s=this.s+1,h=Tn(h,xn);this.w=[],this.w[this.s]=this.exp(this.nqr,h);for(let r=this.s-1;r>=0;r--)this.w[r]=this.square(this.w[r+1]);if(!this.eq(this.w[0],this.one))throw new Error("Error calculating roots of unity");this.batchToMontgomery=Cn(t,n+"_batchToMontgomery",this.n8,this.n8),this.batchFromMontgomery=Cn(t,n+"_batchFromMontgomery",this.n8,this.n8)}op2(t,n,o){return this.tm.setBuff(this.pOp1,n),this.tm.setBuff(this.pOp2,o),this.tm.instance.exports[this.prefix+t](this.pOp1,this.pOp2,this.pOp3),this.tm.getBuff(this.pOp3,this.n8)}op2Bool(t,n,o){return this.tm.setBuff(this.pOp1,n),this.tm.setBuff(this.pOp2,o),!!this.tm.instance.exports[this.prefix+t](this.pOp1,this.pOp2)}op1(t,n){return this.tm.setBuff(this.pOp1,n),this.tm.instance.exports[this.prefix+t](this.pOp1,this.pOp3),this.tm.getBuff(this.pOp3,this.n8)}op1Bool(t,n){return this.tm.setBuff(this.pOp1,n),!!this.tm.instance.exports[this.prefix+t](this.pOp1,this.pOp3)}add(t,n){return this.op2("_add",t,n)}eq(t,n){return this.op2Bool("_eq",t,n)}isZero(t){return this.op1Bool("_isZero",t)}sub(t,n){return this.op2("_sub",t,n)}neg(t){return this.op1("_neg",t)}inv(t){return this.op1("_inverse",t)}toMontgomery(t){return this.op1("_toMontgomery",t)}fromMontgomery(t){return this.op1("_fromMontgomery",t)}mul(t,n){return this.op2("_mul",t,n)}div(t,n){return this.tm.setBuff(this.pOp1,t),this.tm.setBuff(this.pOp2,n),this.tm.instance.exports[this.prefix+"_inverse"](this.pOp2,this.pOp2),this.tm.instance.exports[this.prefix+"_mul"](this.pOp1,this.pOp2,this.pOp3),this.tm.getBuff(this.pOp3,this.n8)}square(t){return this.op1("_square",t)}isSquare(t){return this.op1Bool("_isSquare",t)}sqrt(t){return this.op1("_sqrt",t)}exp(t,n){return n instanceof Uint8Array||(n=Gn(Ut(n))),this.tm.setBuff(this.pOp1,t),this.tm.setBuff(this.pOp2,n),this.tm.instance.exports[this.prefix+"_exp"](this.pOp1,this.pOp2,n.byteLength,this.pOp3),this.tm.getBuff(this.pOp3,this.n8)}isNegative(t){return this.op1Bool("_isNegative",t)}e(t,n){if(t instanceof Uint8Array)return t;let o=Ut(t,n);_i(o)?(o=hi(o),Go(o,this.p)&&(o=sn(o,this.p)),o=fn(this.p,o)):Go(o,this.p)&&(o=sn(o,this.p));const e=zi(o,this.n8);return this.toMontgomery(e)}toString(t,n){const o=this.fromMontgomery(t),e=to(o,0);return Ii(e,n)}fromRng(t){let n;const o=new Uint8Array(this.n8);do{n=yi;for(let e=0;e<this.n64;e++)n=oe(n,po(t.nextU64(),64*e));n=ee(n,this.mask)}while(Li(n,this.p));return Xn(o,0,n,this.n8),o}random(){return this.fromRng(ie())}toObject(t){const n=this.fromMontgomery(t);return to(n,0)}fromObject(t){const n=new Uint8Array(this.n8);return Xn(n,0,t,this.n8),this.toMontgomery(n)}toRprLE(t,n,o){t.set(this.fromMontgomery(o),n)}toRprBE(t,n,o){const e=this.fromMontgomery(o);for(let l=0;l<this.n8/2;l++){const h=e[l];e[l]=e[this.n8-1-l],e[this.n8-1-l]=h}t.set(e,n)}fromRprLE(t,n){n=n||0;const o=t.slice(n,n+this.n8);return this.toMontgomery(o)}async batchInverse(t){let n=!1;const o=this.n8,e=this.n8;Array.isArray(t)?(t=de(t,o),n=!0):t=t.slice(0,t.byteLength);const l=Math.floor(t.byteLength/o);if(l*o!==t.byteLength)throw new Error("Invalid buffer size");const h=Math.floor(l/this.tm.concurrency),r=[];for(let w=0;w<this.tm.concurrency;w++){let B;if(w<this.tm.concurrency-1?B=h:B=l-w*h,B==0)continue;const k=[{cmd:"ALLOCSET",var:0,buff:t.slice(w*h*o,w*h*o+B*o)},{cmd:"ALLOC",var:1,len:e*B},{cmd:"CALL",fnName:this.prefix+"_batchInverse",params:[{var:0},{val:o},{val:B},{var:1},{val:e}]},{cmd:"GET",out:0,var:1,len:e*B}];r.push(this.tm.queueAction(k))}const A=await Promise.all(r);let _;t instanceof Pt?_=new Pt(l*e):_=new Uint8Array(l*e);let s=0;for(let w=0;w<A.length;w++)_.set(A[w][0],s),s+=A[w][0].byteLength;return n?Ao(_,e):_}}class Oe{constructor(t,n,o){this.tm=t,this.prefix=n,this.F=o,this.type="F2",this.m=o.m*2,this.n8=this.F.n8*2,this.n32=this.F.n32*2,this.n64=this.F.n64*2,this.pOp1=t.alloc(o.n8*2),this.pOp2=t.alloc(o.n8*2),this.pOp3=t.alloc(o.n8*2),this.tm.instance.exports[n+"_zero"](this.pOp1),this.zero=t.getBuff(this.pOp1,this.n8),this.tm.instance.exports[n+"_one"](this.pOp1),this.one=t.getBuff(this.pOp1,this.n8),this.negone=this.neg(this.one),this.two=this.add(this.one,this.one)}op2(t,n,o){return this.tm.setBuff(this.pOp1,n),this.tm.setBuff(this.pOp2,o),this.tm.instance.exports[this.prefix+t](this.pOp1,this.pOp2,this.pOp3),this.tm.getBuff(this.pOp3,this.n8)}op2Bool(t,n,o){return this.tm.setBuff(this.pOp1,n),this.tm.setBuff(this.pOp2,o),!!this.tm.instance.exports[this.prefix+t](this.pOp1,this.pOp2)}op1(t,n){return this.tm.setBuff(this.pOp1,n),this.tm.instance.exports[this.prefix+t](this.pOp1,this.pOp3),this.tm.getBuff(this.pOp3,this.n8)}op1Bool(t,n){return this.tm.setBuff(this.pOp1,n),!!this.tm.instance.exports[this.prefix+t](this.pOp1,this.pOp3)}add(t,n){return this.op2("_add",t,n)}eq(t,n){return this.op2Bool("_eq",t,n)}isZero(t){return this.op1Bool("_isZero",t)}sub(t,n){return this.op2("_sub",t,n)}neg(t){return this.op1("_neg",t)}inv(t){return this.op1("_inverse",t)}isNegative(t){return this.op1Bool("_isNegative",t)}toMontgomery(t){return this.op1("_toMontgomery",t)}fromMontgomery(t){return this.op1("_fromMontgomery",t)}mul(t,n){return this.op2("_mul",t,n)}mul1(t,n){return this.op2("_mul1",t,n)}div(t,n){return this.tm.setBuff(this.pOp1,t),this.tm.setBuff(this.pOp2,n),this.tm.instance.exports[this.prefix+"_inverse"](this.pOp2,this.pOp2),this.tm.instance.exports[this.prefix+"_mul"](this.pOp1,this.pOp2,this.pOp3),this.tm.getBuff(this.pOp3,this.n8)}square(t){return this.op1("_square",t)}isSquare(t){return this.op1Bool("_isSquare",t)}sqrt(t){return this.op1("_sqrt",t)}exp(t,n){return n instanceof Uint8Array||(n=Gn(Ut(n))),this.tm.setBuff(this.pOp1,t),this.tm.setBuff(this.pOp2,n),this.tm.instance.exports[this.prefix+"_exp"](this.pOp1,this.pOp2,n.byteLength,this.pOp3),this.tm.getBuff(this.pOp3,this.n8)}e(t,n){if(t instanceof Uint8Array)return t;if(Array.isArray(t)&&t.length==2){const o=this.F.e(t[0],n),e=this.F.e(t[1],n),l=new Uint8Array(this.F.n8*2);return l.set(o),l.set(e,this.F.n8*2),l}else throw new Error("invalid F2")}toString(t,n){const o=this.F.toString(t.slice(0,this.F.n8),n),e=this.F.toString(t.slice(this.F.n8),n);return`[${o}, ${e}]`}fromRng(t){const n=this.F.fromRng(t),o=this.F.fromRng(t),e=new Uint8Array(this.F.n8*2);return e.set(n),e.set(o,this.F.n8),e}random(){return this.fromRng(ie())}toObject(t){const n=this.F.toObject(t.slice(0,this.F.n8)),o=this.F.toObject(t.slice(this.F.n8,this.F.n8*2));return[n,o]}fromObject(t){const n=new Uint8Array(this.F.n8*2),o=this.F.fromObject(t[0]),e=this.F.fromObject(t[1]);return n.set(o),n.set(e,this.F.n8),n}c1(t){return t.slice(0,this.F.n8)}c2(t){return t.slice(this.F.n8)}}class Hc{constructor(t,n,o){this.tm=t,this.prefix=n,this.F=o,this.type="F3",this.m=o.m*3,this.n8=this.F.n8*3,this.n32=this.F.n32*3,this.n64=this.F.n64*3,this.pOp1=t.alloc(o.n8*3),this.pOp2=t.alloc(o.n8*3),this.pOp3=t.alloc(o.n8*3),this.tm.instance.exports[n+"_zero"](this.pOp1),this.zero=t.getBuff(this.pOp1,this.n8),this.tm.instance.exports[n+"_one"](this.pOp1),this.one=t.getBuff(this.pOp1,this.n8),this.negone=this.neg(this.one),this.two=this.add(this.one,this.one)}op2(t,n,o){return this.tm.setBuff(this.pOp1,n),this.tm.setBuff(this.pOp2,o),this.tm.instance.exports[this.prefix+t](this.pOp1,this.pOp2,this.pOp3),this.tm.getBuff(this.pOp3,this.n8)}op2Bool(t,n,o){return this.tm.setBuff(this.pOp1,n),this.tm.setBuff(this.pOp2,o),!!this.tm.instance.exports[this.prefix+t](this.pOp1,this.pOp2)}op1(t,n){return this.tm.setBuff(this.pOp1,n),this.tm.instance.exports[this.prefix+t](this.pOp1,this.pOp3),this.tm.getBuff(this.pOp3,this.n8)}op1Bool(t,n){return this.tm.setBuff(this.pOp1,n),!!this.tm.instance.exports[this.prefix+t](this.pOp1,this.pOp3)}eq(t,n){return this.op2Bool("_eq",t,n)}isZero(t){return this.op1Bool("_isZero",t)}add(t,n){return this.op2("_add",t,n)}sub(t,n){return this.op2("_sub",t,n)}neg(t){return this.op1("_neg",t)}inv(t){return this.op1("_inverse",t)}isNegative(t){return this.op1Bool("_isNegative",t)}toMontgomery(t){return this.op1("_toMontgomery",t)}fromMontgomery(t){return this.op1("_fromMontgomery",t)}mul(t,n){return this.op2("_mul",t,n)}div(t,n){return this.tm.setBuff(this.pOp1,t),this.tm.setBuff(this.pOp2,n),this.tm.instance.exports[this.prefix+"_inverse"](this.pOp2,this.pOp2),this.tm.instance.exports[this.prefix+"_mul"](this.pOp1,this.pOp2,this.pOp3),this.tm.getBuff(this.pOp3,this.n8)}square(t){return this.op1("_square",t)}isSquare(t){return this.op1Bool("_isSquare",t)}sqrt(t){return this.op1("_sqrt",t)}exp(t,n){return n instanceof Uint8Array||(n=Gn(Ut(n))),this.tm.setBuff(this.pOp1,t),this.tm.setBuff(this.pOp2,n),this.tm.instance.exports[this.prefix+"_exp"](this.pOp1,this.pOp2,n.byteLength,this.pOp3),this.getBuff(this.pOp3,this.n8)}e(t,n){if(t instanceof Uint8Array)return t;if(Array.isArray(t)&&t.length==3){const o=this.F.e(t[0],n),e=this.F.e(t[1],n),l=this.F.e(t[2],n),h=new Uint8Array(this.F.n8*3);return h.set(o),h.set(e,this.F.n8),h.set(l,this.F.n8*2),h}else throw new Error("invalid F3")}toString(t,n){const o=this.F.toString(t.slice(0,this.F.n8),n),e=this.F.toString(t.slice(this.F.n8,this.F.n8*2),n),l=this.F.toString(t.slice(this.F.n8*2),n);return`[${o}, ${e}, ${l}]`}fromRng(t){const n=this.F.fromRng(t),o=this.F.fromRng(t),e=this.F.fromRng(t),l=new Uint8Array(this.F.n8*3);return l.set(n),l.set(o,this.F.n8),l.set(e,this.F.n8*2),l}random(){return this.fromRng(ie())}toObject(t){const n=this.F.toObject(t.slice(0,this.F.n8)),o=this.F.toObject(t.slice(this.F.n8,this.F.n8*2)),e=this.F.toObject(t.slice(this.F.n8*2,this.F.n8*3));return[n,o,e]}fromObject(t){const n=new Uint8Array(this.F.n8*3),o=this.F.fromObject(t[0]),e=this.F.fromObject(t[1]),l=this.F.fromObject(t[2]);return n.set(o),n.set(e,this.F.n8),n.set(l,this.F.n8*2),n}c1(t){return t.slice(0,this.F.n8)}c2(t){return t.slice(this.F.n8,this.F.n8*2)}c3(t){return t.slice(this.F.n8*2)}}class Pe{constructor(t,n,o,e,l,h){this.tm=t,this.prefix=n,this.F=o,this.pOp1=t.alloc(o.n8*3),this.pOp2=t.alloc(o.n8*3),this.pOp3=t.alloc(o.n8*3),this.tm.instance.exports[n+"_zero"](this.pOp1),this.zero=this.tm.getBuff(this.pOp1,o.n8*3),this.tm.instance.exports[n+"_zeroAffine"](this.pOp1),this.zeroAffine=this.tm.getBuff(this.pOp1,o.n8*2),this.one=this.tm.getBuff(e,o.n8*3),this.g=this.one,this.oneAffine=this.tm.getBuff(e,o.n8*2),this.gAffine=this.oneAffine,this.b=this.tm.getBuff(l,o.n8),h&&(this.cofactor=Gn(h)),this.negone=this.neg(this.one),this.two=this.add(this.one,this.one),this.batchLEMtoC=Cn(t,n+"_batchLEMtoC",o.n8*2,o.n8),this.batchLEMtoU=Cn(t,n+"_batchLEMtoU",o.n8*2,o.n8*2),this.batchCtoLEM=Cn(t,n+"_batchCtoLEM",o.n8,o.n8*2),this.batchUtoLEM=Cn(t,n+"_batchUtoLEM",o.n8*2,o.n8*2),this.batchToJacobian=Cn(t,n+"_batchToJacobian",o.n8*2,o.n8*3),this.batchToAffine=Cn(t,n+"_batchToAffine",o.n8*3,o.n8*2)}op2(t,n,o){return this.tm.setBuff(this.pOp1,n),this.tm.setBuff(this.pOp2,o),this.tm.instance.exports[this.prefix+t](this.pOp1,this.pOp2,this.pOp3),this.tm.getBuff(this.pOp3,this.F.n8*3)}op2bool(t,n,o){return this.tm.setBuff(this.pOp1,n),this.tm.setBuff(this.pOp2,o),!!this.tm.instance.exports[this.prefix+t](this.pOp1,this.pOp2,this.pOp3)}op1(t,n){return this.tm.setBuff(this.pOp1,n),this.tm.instance.exports[this.prefix+t](this.pOp1,this.pOp3),this.tm.getBuff(this.pOp3,this.F.n8*3)}op1Affine(t,n){return this.tm.setBuff(this.pOp1,n),this.tm.instance.exports[this.prefix+t](this.pOp1,this.pOp3),this.tm.getBuff(this.pOp3,this.F.n8*2)}op1Bool(t,n){return this.tm.setBuff(this.pOp1,n),!!this.tm.instance.exports[this.prefix+t](this.pOp1,this.pOp3)}add(t,n){if(t.byteLength==this.F.n8*3){if(n.byteLength==this.F.n8*3)return this.op2("_add",t,n);if(n.byteLength==this.F.n8*2)return this.op2("_addMixed",t,n);throw new Error("invalid point size")}else if(t.byteLength==this.F.n8*2){if(n.byteLength==this.F.n8*3)return this.op2("_addMixed",n,t);if(n.byteLength==this.F.n8*2)return this.op2("_addAffine",t,n);throw new Error("invalid point size")}else throw new Error("invalid point size")}sub(t,n){if(t.byteLength==this.F.n8*3){if(n.byteLength==this.F.n8*3)return this.op2("_sub",t,n);if(n.byteLength==this.F.n8*2)return this.op2("_subMixed",t,n);throw new Error("invalid point size")}else if(t.byteLength==this.F.n8*2){if(n.byteLength==this.F.n8*3)return this.op2("_subMixed",n,t);if(n.byteLength==this.F.n8*2)return this.op2("_subAffine",t,n);throw new Error("invalid point size")}else throw new Error("invalid point size")}neg(t){if(t.byteLength==this.F.n8*3)return this.op1("_neg",t);if(t.byteLength==this.F.n8*2)return this.op1Affine("_negAffine",t);throw new Error("invalid point size")}double(t){if(t.byteLength==this.F.n8*3)return this.op1("_double",t);if(t.byteLength==this.F.n8*2)return this.op1("_doubleAffine",t);throw new Error("invalid point size")}isZero(t){if(t.byteLength==this.F.n8*3)return this.op1Bool("_isZero",t);if(t.byteLength==this.F.n8*2)return this.op1Bool("_isZeroAffine",t);throw new Error("invalid point size")}timesScalar(t,n){n instanceof Uint8Array||(n=Gn(Ut(n)));let o;if(t.byteLength==this.F.n8*3)o=this.prefix+"_timesScalar";else if(t.byteLength==this.F.n8*2)o=this.prefix+"_timesScalarAffine";else throw new Error("invalid point size");return this.tm.setBuff(this.pOp1,t),this.tm.setBuff(this.pOp2,n),this.tm.instance.exports[o](this.pOp1,this.pOp2,n.byteLength,this.pOp3),this.tm.getBuff(this.pOp3,this.F.n8*3)}timesFr(t,n){let o;if(t.byteLength==this.F.n8*3)o=this.prefix+"_timesFr";else if(t.byteLength==this.F.n8*2)o=this.prefix+"_timesFrAffine";else throw new Error("invalid point size");return this.tm.setBuff(this.pOp1,t),this.tm.setBuff(this.pOp2,n),this.tm.instance.exports[o](this.pOp1,this.pOp2,this.pOp3),this.tm.getBuff(this.pOp3,this.F.n8*3)}eq(t,n){if(t.byteLength==this.F.n8*3){if(n.byteLength==this.F.n8*3)return this.op2bool("_eq",t,n);if(n.byteLength==this.F.n8*2)return this.op2bool("_eqMixed",t,n);throw new Error("invalid point size")}else if(t.byteLength==this.F.n8*2){if(n.byteLength==this.F.n8*3)return this.op2bool("_eqMixed",n,t);if(n.byteLength==this.F.n8*2)return this.op2bool("_eqAffine",t,n);throw new Error("invalid point size")}else throw new Error("invalid point size")}toAffine(t){if(t.byteLength==this.F.n8*3)return this.op1Affine("_toAffine",t);if(t.byteLength==this.F.n8*2)return t;throw new Error("invalid point size")}toJacobian(t){if(t.byteLength==this.F.n8*3)return t;if(t.byteLength==this.F.n8*2)return this.op1("_toJacobian",t);throw new Error("invalid point size")}toRprUncompressed(t,n,o){if(this.tm.setBuff(this.pOp1,o),o.byteLength==this.F.n8*3)this.tm.instance.exports[this.prefix+"_toAffine"](this.pOp1,this.pOp1);else if(o.byteLength!=this.F.n8*2)throw new Error("invalid point size");this.tm.instance.exports[this.prefix+"_LEMtoU"](this.pOp1,this.pOp1);const e=this.tm.getBuff(this.pOp1,this.F.n8*2);t.set(e,n)}fromRprUncompressed(t,n){const o=t.slice(n,n+this.F.n8*2);return this.tm.setBuff(this.pOp1,o),this.tm.instance.exports[this.prefix+"_UtoLEM"](this.pOp1,this.pOp1),this.tm.getBuff(this.pOp1,this.F.n8*2)}toRprCompressed(t,n,o){if(this.tm.setBuff(this.pOp1,o),o.byteLength==this.F.n8*3)this.tm.instance.exports[this.prefix+"_toAffine"](this.pOp1,this.pOp1);else if(o.byteLength!=this.F.n8*2)throw new Error("invalid point size");this.tm.instance.exports[this.prefix+"_LEMtoC"](this.pOp1,this.pOp1);const e=this.tm.getBuff(this.pOp1,this.F.n8);t.set(e,n)}fromRprCompressed(t,n){const o=t.slice(n,n+this.F.n8);return this.tm.setBuff(this.pOp1,o),this.tm.instance.exports[this.prefix+"_CtoLEM"](this.pOp1,this.pOp2),this.tm.getBuff(this.pOp2,this.F.n8*2)}toUncompressed(t){const n=new Uint8Array(this.F.n8*2);return this.toRprUncompressed(n,0,t),n}toRprLEM(t,n,o){if(o.byteLength==this.F.n8*2){t.set(o,n);return}else if(o.byteLength==this.F.n8*3){this.tm.setBuff(this.pOp1,o),this.tm.instance.exports[this.prefix+"_toAffine"](this.pOp1,this.pOp1);const e=this.tm.getBuff(this.pOp1,this.F.n8*2);t.set(e,n)}else throw new Error("invalid point size")}fromRprLEM(t,n){return n=n||0,t.slice(n,n+this.F.n8*2)}toString(t,n){if(t.byteLength==this.F.n8*3){const o=this.F.toString(t.slice(0,this.F.n8),n),e=this.F.toString(t.slice(this.F.n8,this.F.n8*2),n),l=this.F.toString(t.slice(this.F.n8*2),n);return`[ ${o}, ${e}, ${l} ]`}else if(t.byteLength==this.F.n8*2){const o=this.F.toString(t.slice(0,this.F.n8),n),e=this.F.toString(t.slice(this.F.n8),n);return`[ ${o}, ${e} ]`}else throw new Error("invalid point size")}isValid(t){if(this.isZero(t))return!0;const n=this.F,o=this.toAffine(t),e=o.slice(0,this.F.n8),l=o.slice(this.F.n8,this.F.n8*2),h=n.add(n.mul(n.square(e),e),this.b),r=n.square(l);return n.eq(h,r)}fromRng(t){const n=this.F;let o=[],e,l;do o[0]=n.fromRng(t),e=t.nextBool(),l=n.add(n.mul(n.square(o[0]),o[0]),this.b);while(!n.isSquare(l));o[1]=n.sqrt(l);const h=n.isNegative(o[1]);e^h&&(o[1]=n.neg(o[1]));let r=new Uint8Array(this.F.n8*2);return r.set(o[0]),r.set(o[1],this.F.n8),this.cofactor&&(r=this.timesScalar(r,this.cofactor)),r}toObject(t){if(this.isZero(t))return[this.F.toObject(this.F.zero),this.F.toObject(this.F.one),this.F.toObject(this.F.zero)];const n=this.F.toObject(t.slice(0,this.F.n8)),o=this.F.toObject(t.slice(this.F.n8,this.F.n8*2));let e;return t.byteLength==this.F.n8*3?e=this.F.toObject(t.slice(this.F.n8*2,this.F.n8*3)):e=this.F.toObject(this.F.one),[n,o,e]}fromObject(t){const n=this.F.fromObject(t[0]),o=this.F.fromObject(t[1]);let e;if(t.length==3?e=this.F.fromObject(t[2]):e=this.F.one,this.F.isZero(e,this.F.one))return this.zeroAffine;if(this.F.eq(e,this.F.one)){const l=new Uint8Array(this.F.n8*2);return l.set(n),l.set(o,this.F.n8),l}else{const l=new Uint8Array(this.F.n8*3);return l.set(n),l.set(o,this.F.n8),l.set(e,this.F.n8*2),l}}e(t){return t instanceof Uint8Array?t:this.fromObject(t)}x(t){return this.toAffine(t).slice(0,this.F.n8)}y(t){return this.toAffine(t).slice(this.F.n8)}}function Vc(a){let n,o;async function e(s){const w=new Uint8Array(s.code),B=await WebAssembly.compile(w);o=new WebAssembly.Memory({initial:s.init,maximum:32767}),n=await WebAssembly.instantiate(B,{env:{memory:o}})}function l(s){const w=new Uint32Array(o.buffer,0,1);for(;w[0]&3;)w[0]++;const B=w[0];if(w[0]+=s,w[0]+s>o.buffer.byteLength){const b=o.buffer.byteLength/65536;let k=Math.floor((w[0]+s)/65536)+1;k>32767&&(k=32767),o.grow(k-b)}return B}function h(s){const w=l(s.byteLength);return A(w,s),w}function r(s,w){const B=new Uint8Array(o.buffer);return new Uint8Array(B.buffer,B.byteOffset+s,w)}function A(s,w){new Uint8Array(o.buffer).set(new Uint8Array(w),s)}function _(s){if(s[0].cmd=="INIT")return e(s[0]);const w={vars:[],out:[]},b=new Uint32Array(o.buffer,0,1)[0];for(let D=0;D<s.length;D++)switch(s[D].cmd){case"ALLOCSET":w.vars[s[D].var]=h(s[D].buff);break;case"ALLOC":w.vars[s[D].var]=l(s[D].len);break;case"SET":A(w.vars[s[D].var],s[D].buff);break;case"CALL":{const F=[];for(let q=0;q<s[D].params.length;q++){const x=s[D].params[q];typeof x.var<"u"?F.push(w.vars[x.var]+(x.offset||0)):typeof x.val<"u"&&F.push(x.val)}n.exports[s[D].fnName](...F);break}case"GET":w.out[s[D].out]=r(w.vars[s[D].var],s[D].len).slice();break;default:throw new Error("Invalid cmd")}const k=new Uint32Array(o.buffer,0,1);return k[0]=b,w.out}return _}const vo=25;class Qe{constructor(){this.promise=new Promise((t,n)=>{this.reject=n,this.resolve=t})}}function $c(a){return new Promise(t=>setTimeout(t,a))}let Vo;const Me=`(function thread(self) {
    const MAXMEM = 32767;
    let instance;
    let memory;

    if (self) {
        self.onmessage = function(e) {
            let data;
            if (e.data) {
                data = e.data;
            } else {
                data = e;
            }

            if (data[0].cmd == "INIT") {
                init(data[0]).then(function() {
                    self.postMessage(data.result);
                });
            } else if (data[0].cmd == "TERMINATE") {
                self.close();
            } else {
                const res = runTask(data);
                self.postMessage(res);
            }
        };
    }

    async function init(data) {
        const code = new Uint8Array(data.code);
        const wasmModule = await WebAssembly.compile(code);
        memory = new WebAssembly.Memory({initial:data.init, maximum: MAXMEM});

        instance = await WebAssembly.instantiate(wasmModule, {
            env: {
                "memory": memory
            }
        });
    }



    function alloc(length) {
        const u32 = new Uint32Array(memory.buffer, 0, 1);
        while (u32[0] & 3) u32[0]++;  // Return always aligned pointers
        const res = u32[0];
        u32[0] += length;
        if (u32[0] + length > memory.buffer.byteLength) {
            const currentPages = memory.buffer.byteLength / 0x10000;
            let requiredPages = Math.floor((u32[0] + length) / 0x10000)+1;
            if (requiredPages>MAXMEM) requiredPages=MAXMEM;
            memory.grow(requiredPages-currentPages);
        }
        return res;
    }

    function allocBuffer(buffer) {
        const p = alloc(buffer.byteLength);
        setBuffer(p, buffer);
        return p;
    }

    function getBuffer(pointer, length) {
        const u8 = new Uint8Array(memory.buffer);
        return new Uint8Array(u8.buffer, u8.byteOffset + pointer, length);
    }

    function setBuffer(pointer, buffer) {
        const u8 = new Uint8Array(memory.buffer);
        u8.set(new Uint8Array(buffer), pointer);
    }

    function runTask(task) {
        if (task[0].cmd == "INIT") {
            return init(task[0]);
        }
        const ctx = {
            vars: [],
            out: []
        };
        const u32a = new Uint32Array(memory.buffer, 0, 1);
        const oldAlloc = u32a[0];
        for (let i=0; i<task.length; i++) {
            switch (task[i].cmd) {
            case "ALLOCSET":
                ctx.vars[task[i].var] = allocBuffer(task[i].buff);
                break;
            case "ALLOC":
                ctx.vars[task[i].var] = alloc(task[i].len);
                break;
            case "SET":
                setBuffer(ctx.vars[task[i].var], task[i].buff);
                break;
            case "CALL": {
                const params = [];
                for (let j=0; j<task[i].params.length; j++) {
                    const p = task[i].params[j];
                    if (typeof p.var !== "undefined") {
                        params.push(ctx.vars[p.var] + (p.offset || 0));
                    } else if (typeof p.val != "undefined") {
                        params.push(p.val);
                    }
                }
                instance.exports[task[i].fnName](...params);
                break;
            }
            case "GET":
                ctx.out[task[i].out] = getBuffer(ctx.vars[task[i].var], task[i].len).slice();
                break;
            default:
                throw new Error("Invalid cmd");
            }
        }
        const u32b = new Uint32Array(memory.buffer, 0, 1);
        u32b[0] = oldAlloc;
        return ctx.out;
    }


    return runTask;
})(self)`;if(globalThis!=null&&globalThis.Blob){const a=new TextEncoder().encode(Me),t=new Blob([a],{type:"application/javascript"});Vo=URL.createObjectURL(t)}else Vo="data:application/javascript;base64,"+globalThis.btoa(Me);async function jc(a,t){const n=new Yc;n.memory=new WebAssembly.Memory({initial:vo}),n.u8=new Uint8Array(n.memory.buffer),n.u32=new Uint32Array(n.memory.buffer);const o=await WebAssembly.compile(a.code);if(n.instance=await WebAssembly.instantiate(o,{env:{memory:n.memory}}),globalThis!=null&&globalThis.Worker||(t=!0),n.singleThread=t,n.initalPFree=n.u32[0],n.pq=a.pq,n.pr=a.pr,n.pG1gen=a.pG1gen,n.pG1zero=a.pG1zero,n.pG2gen=a.pG2gen,n.pG2zero=a.pG2zero,n.pOneT=a.pOneT,t)n.code=a.code,n.taskManager=Vc(),await n.taskManager([{cmd:"INIT",init:vo,code:n.code.slice()}]),n.concurrency=1;else{n.workers=[],n.pendingDeferreds=[],n.working=[];let l=2;typeof navigator=="object"&&navigator.hardwareConcurrency&&(l=navigator.hardwareConcurrency),l==0&&(l=2),l>64&&(l=64),n.concurrency=l;for(let r=0;r<l;r++)n.workers[r]=new Worker(Vo),n.workers[r].addEventListener("message",e(r)),n.working[r]=!1;const h=[];for(let r=0;r<n.workers.length;r++){const A=a.code.slice();h.push(n.postAction(r,[{cmd:"INIT",init:vo,code:A}],[A.buffer]))}await Promise.all(h)}return n;function e(l){return function(h){let r;h&&h.data?r=h.data:r=h,n.working[l]=!1,n.pendingDeferreds[l].resolve(r),n.processWorks()}}}class Yc{constructor(){this.actionQueue=[],this.oldPFree=0}startSyncOp(){if(this.oldPFree!=0)throw new Error("Sync operation in progress");this.oldPFree=this.u32[0]}endSyncOp(){if(this.oldPFree==0)throw new Error("No sync operation in progress");this.u32[0]=this.oldPFree,this.oldPFree=0}postAction(t,n,o,e){if(this.working[t])throw new Error("Posting a job t a working worker");return this.working[t]=!0,this.pendingDeferreds[t]=e||new Qe,this.workers[t].postMessage(n,o),this.pendingDeferreds[t].promise}processWorks(){for(let t=0;t<this.workers.length&&this.actionQueue.length>0;t++)if(this.working[t]==!1){const n=this.actionQueue.shift();this.postAction(t,n.data,n.transfers,n.deferred)}}queueAction(t,n){const o=new Qe;if(this.singleThread){const e=this.taskManager(t);o.resolve(e)}else this.actionQueue.push({data:t,transfers:n,deferred:o}),this.processWorks();return o.promise}resetMemory(){this.u32[0]=this.initalPFree}allocBuff(t){const n=this.alloc(t.byteLength);return this.setBuff(n,t),n}getBuff(t,n){return this.u8.slice(t,t+n)}setBuff(t,n){this.u8.set(new Uint8Array(n),t)}alloc(t){for(;this.u32[0]&3;)this.u32[0]++;const n=this.u32[0];return this.u32[0]+=t,n}async terminate(){for(let t=0;t<this.workers.length;t++)this.workers[t].postMessage([{cmd:"TERMINATE"}]);await $c(200)}}function Oo(a,t){const n=a[t],o=a.Fr,e=a.tm;a[t].batchApplyKey=async function(l,h,r,A,_){A=A||"affine",_=_||"affine";let s,w,B,b,k;if(t=="G1")A=="jacobian"?(B=n.F.n8*3,s="g1m_batchApplyKey"):(B=n.F.n8*2,s="g1m_batchApplyKeyMixed"),b=n.F.n8*3,_=="jacobian"?k=n.F.n8*3:(w="g1m_batchToAffine",k=n.F.n8*2);else if(t=="G2")A=="jacobian"?(B=n.F.n8*3,s="g2m_batchApplyKey"):(B=n.F.n8*2,s="g2m_batchApplyKeyMixed"),b=n.F.n8*3,_=="jacobian"?k=n.F.n8*3:(w="g2m_batchToAffine",k=n.F.n8*2);else if(t=="Fr")s="frm_batchApplyKey",B=n.n8,b=n.n8,k=n.n8;else throw new Error("Invalid group: "+t);const D=Math.floor(l.byteLength/B),F=Math.floor(D/e.concurrency),q=[];r=o.e(r);let x=o.e(h);for(let E=0;E<e.concurrency;E++){let u;if(E<e.concurrency-1?u=F:u=D-E*F,u==0)continue;const L=[];L.push({cmd:"ALLOCSET",var:0,buff:l.slice(E*F*B,E*F*B+u*B)}),L.push({cmd:"ALLOCSET",var:1,buff:x}),L.push({cmd:"ALLOCSET",var:2,buff:r}),L.push({cmd:"ALLOC",var:3,len:u*Math.max(b,k)}),L.push({cmd:"CALL",fnName:s,params:[{var:0},{val:u},{var:1},{var:2},{var:3}]}),w&&L.push({cmd:"CALL",fnName:w,params:[{var:3},{val:u},{var:3}]}),L.push({cmd:"GET",out:0,var:3,len:u*k}),q.push(e.queueAction(L)),x=o.mul(x,o.exp(r,u))}const it=await Promise.all(q);let z;l instanceof Pt?z=new Pt(D*k):z=new Uint8Array(D*k);let lt=0;for(let E=0;E<it.length;E++)z.set(it[E][0],lt),lt+=it[E][0].byteLength;return z}}function Zc(a){const t=a.tm;a.pairing=function(o,e){t.startSyncOp();const l=t.allocBuff(a.G1.toJacobian(o)),h=t.allocBuff(a.G2.toJacobian(e)),r=t.alloc(a.Gt.n8);t.instance.exports[a.name+"_pairing"](l,h,r);const A=t.getBuff(r,a.Gt.n8);return t.endSyncOp(),A},a.pairingEq=async function(){let o,e;arguments.length%2==1?(o=arguments[arguments.length-1],e=(arguments.length-1)/2):(o=a.Gt.one,e=arguments.length/2);const l=[];for(let s=0;s<e;s++){const w=[],B=a.G1.toJacobian(arguments[s*2]);w.push({cmd:"ALLOCSET",var:0,buff:B}),w.push({cmd:"ALLOC",var:1,len:a.prePSize});const b=a.G2.toJacobian(arguments[s*2+1]);w.push({cmd:"ALLOCSET",var:2,buff:b}),w.push({cmd:"ALLOC",var:3,len:a.preQSize}),w.push({cmd:"ALLOC",var:4,len:a.Gt.n8}),w.push({cmd:"CALL",fnName:a.name+"_prepareG1",params:[{var:0},{var:1}]}),w.push({cmd:"CALL",fnName:a.name+"_prepareG2",params:[{var:2},{var:3}]}),w.push({cmd:"CALL",fnName:a.name+"_millerLoop",params:[{var:1},{var:3},{var:4}]}),w.push({cmd:"GET",out:0,var:4,len:a.Gt.n8}),l.push(t.queueAction(w))}const h=await Promise.all(l);t.startSyncOp();const r=t.alloc(a.Gt.n8);t.instance.exports.ftm_one(r);for(let s=0;s<h.length;s++){const w=t.allocBuff(h[s][0]);t.instance.exports.ftm_mul(r,w,r)}t.instance.exports[a.name+"_finalExponentiation"](r,r);const A=t.allocBuff(o),_=!!t.instance.exports.ftm_eq(r,A);return t.endSyncOp(),_},a.prepareG1=function(n){this.tm.startSyncOp();const o=this.tm.allocBuff(n),e=this.tm.alloc(this.prePSize);this.tm.instance.exports[this.name+"_prepareG1"](o,e);const l=this.tm.getBuff(e,this.prePSize);return this.tm.endSyncOp(),l},a.prepareG2=function(n){this.tm.startSyncOp();const o=this.tm.allocBuff(n),e=this.tm.alloc(this.preQSize);this.tm.instance.exports[this.name+"_prepareG2"](o,e);const l=this.tm.getBuff(e,this.preQSize);return this.tm.endSyncOp(),l},a.millerLoop=function(n,o){this.tm.startSyncOp();const e=this.tm.allocBuff(n),l=this.tm.allocBuff(o),h=this.tm.alloc(this.Gt.n8);this.tm.instance.exports[this.name+"_millerLoop"](e,l,h);const r=this.tm.getBuff(h,this.Gt.n8);return this.tm.endSyncOp(),r},a.finalExponentiation=function(n){this.tm.startSyncOp();const o=this.tm.allocBuff(n),e=this.tm.alloc(this.Gt.n8);this.tm.instance.exports[this.name+"_finalExponentiation"](o,e);const l=this.tm.getBuff(e,this.Gt.n8);return this.tm.endSyncOp(),l}}const qe=[1,1,1,1,2,3,4,5,6,7,7,8,9,10,11,12,13,13,14,15,16,16,17,17,17,17,17,17,17,17,17,17];function Ue(a,t){const n=a[t],o=n.tm;async function e(h,r,A,_,s){if(!(h instanceof Uint8Array))throw _&&_.error(`${s} _multiExpChunk buffBases is not Uint8Array`),new Error(`${s} _multiExpChunk buffBases is not Uint8Array`);if(!(r instanceof Uint8Array))throw _&&_.error(`${s} _multiExpChunk buffScalars is not Uint8Array`),new Error(`${s} _multiExpChunk buffScalars is not Uint8Array`);A=A||"affine";let w,B;if(t=="G1")A=="affine"?(B="g1m_multiexpAffine_chunk",w=n.F.n8*2):(B="g1m_multiexp_chunk",w=n.F.n8*3);else if(t=="G2")A=="affine"?(B="g2m_multiexpAffine_chunk",w=n.F.n8*2):(B="g2m_multiexp_chunk",w=n.F.n8*3);else throw new Error("Invalid group");const b=Math.floor(h.byteLength/w);if(b==0)return n.zero;const k=Math.floor(r.byteLength/b);if(k*b!=r.byteLength)throw new Error("Scalar size does not match");const D=qe[Zt(b)],F=Math.floor((k*8-1)/D)+1,q=[];for(let z=0;z<F;z++){const lt=[{cmd:"ALLOCSET",var:0,buff:h},{cmd:"ALLOCSET",var:1,buff:r},{cmd:"ALLOC",var:2,len:n.F.n8*3},{cmd:"CALL",fnName:B,params:[{var:0},{var:1},{val:k},{val:b},{val:z*D},{val:Math.min(k*8-z*D,D)},{var:2}]},{cmd:"GET",out:0,var:2,len:n.F.n8*3}];q.push(n.tm.queueAction(lt))}const x=await Promise.all(q);let it=n.zero;for(let z=x.length-1;z>=0;z--){if(!n.isZero(it))for(let lt=0;lt<D;lt++)it=n.double(it);it=n.add(it,x[z][0])}return it}async function l(h,r,A,_,s){let b;if(t=="G1")A=="affine"?b=n.F.n8*2:b=n.F.n8*3;else if(t=="G2")A=="affine"?b=n.F.n8*2:b=n.F.n8*3;else throw new Error("Invalid group");const k=Math.floor(h.byteLength/b);if(k==0)return n.zero;const D=Math.floor(r.byteLength/k);if(D*k!=r.byteLength)throw new Error("Scalar size does not match");const F=qe[Zt(k)],q=Math.floor((D*8-1)/F)+1;let x;x=Math.floor(k/(o.concurrency/q)),x>4194304&&(x=4194304),x<1024&&(x=1024);const it=[];for(let E=0;E<k;E+=x){_&&_.debug(`Multiexp start: ${s}: ${E}/${k}`);const u=Math.min(k-E,x),L=h.slice(E*b,(E+u)*b),V=r.slice(E*D,(E+u)*D);it.push(e(L,V,A,_,s).then(j=>(_&&_.debug(`Multiexp end: ${s}: ${E}/${k}`),j)))}const z=await Promise.all(it);let lt=n.zero;for(let E=z.length-1;E>=0;E--)lt=n.add(lt,z[E]);return lt}n.multiExp=async function(r,A,_,s){return await l(r,A,"jacobian",_,s)},n.multiExpAffine=async function(r,A,_,s){return await l(r,A,"affine",_,s)}}function Po(a,t){const n=a[t],o=a.Fr,e=n.tm;async function l(_,s,w,B,b,k){w=w||"affine",B=B||"affine";const D=14;let F,q,x,it,z,lt,E,u;t=="G1"?(w=="affine"?(F=n.F.n8*2,it="g1m_batchToJacobian"):F=n.F.n8*3,q=n.F.n8*3,s&&(u="g1m_fftFinal"),E="g1m_fftJoin",lt="g1m_fftMix",B=="affine"?(x=n.F.n8*2,z="g1m_batchToAffine"):x=n.F.n8*3):t=="G2"?(w=="affine"?(F=n.F.n8*2,it="g2m_batchToJacobian"):F=n.F.n8*3,q=n.F.n8*3,s&&(u="g2m_fftFinal"),E="g2m_fftJoin",lt="g2m_fftMix",B=="affine"?(x=n.F.n8*2,z="g2m_batchToAffine"):x=n.F.n8*3):t=="Fr"&&(F=n.n8,q=n.n8,x=n.n8,s&&(u="frm_fftFinal"),lt="frm_fftMix",E="frm_fftJoin");let L=!1;Array.isArray(_)?(_=de(_,F),L=!0):_=_.slice(0,_.byteLength);const V=_.byteLength/F,j=Zt(V);if(1<<j!=V)throw new Error("fft must be multiple of 2");if(j==o.s+1){let K;return s?K=await r(_,w,B,b,k):K=await h(_,w,B,b,k),L?Ao(K,x):K}let X;s&&(X=o.inv(o.e(V)));let P;ki(_,F);let I,v=Math.min(1<<D,V),T=V/v;for(;T<e.concurrency&&v>=16;)T*=2,v/=2;const ot=Zt(v),tt=[];for(let K=0;K<T;K++){b&&b.debug(`${k}: fft ${j} mix start: ${K}/${T}`);const at=[];at.push({cmd:"ALLOC",var:0,len:q*v});const W=_.slice(v*K*F,v*(K+1)*F);at.push({cmd:"SET",var:0,buff:W}),it&&at.push({cmd:"CALL",fnName:it,params:[{var:0},{val:v},{var:0}]});for(let ct=1;ct<=ot;ct++)at.push({cmd:"CALL",fnName:lt,params:[{var:0},{val:v},{val:ct}]});ot==j?(u&&(at.push({cmd:"ALLOCSET",var:1,buff:X}),at.push({cmd:"CALL",fnName:u,params:[{var:0},{val:v},{var:1}]})),z&&at.push({cmd:"CALL",fnName:z,params:[{var:0},{val:v},{var:0}]}),at.push({cmd:"GET",out:0,var:0,len:v*x})):at.push({cmd:"GET",out:0,var:0,len:q*v}),tt.push(e.queueAction(at).then(ct=>(b&&b.debug(`${k}: fft ${j} mix end: ${K}/${T}`),ct)))}I=await Promise.all(tt);for(let K=0;K<T;K++)I[K]=I[K][0];for(let K=ot+1;K<=j;K++){b&&b.debug(`${k}: fft  ${j}  join: ${K}/${j}`);const at=1<<j-K,W=T/at,ct=[];for(let wt=0;wt<at;wt++)for(let ht=0;ht<W/2;ht++){const p=o.exp(o.w[K],ht*v),i=o.w[K],C=wt*W+ht,c=wt*W+ht+W/2,m=[];m.push({cmd:"ALLOCSET",var:0,buff:I[C]}),m.push({cmd:"ALLOCSET",var:1,buff:I[c]}),m.push({cmd:"ALLOCSET",var:2,buff:p}),m.push({cmd:"ALLOCSET",var:3,buff:i}),m.push({cmd:"CALL",fnName:E,params:[{var:0},{var:1},{val:v},{var:2},{var:3}]}),K==j?(u&&(m.push({cmd:"ALLOCSET",var:4,buff:X}),m.push({cmd:"CALL",fnName:u,params:[{var:0},{val:v},{var:4}]}),m.push({cmd:"CALL",fnName:u,params:[{var:1},{val:v},{var:4}]})),z&&(m.push({cmd:"CALL",fnName:z,params:[{var:0},{val:v},{var:0}]}),m.push({cmd:"CALL",fnName:z,params:[{var:1},{val:v},{var:1}]})),m.push({cmd:"GET",out:0,var:0,len:v*x}),m.push({cmd:"GET",out:1,var:1,len:v*x})):(m.push({cmd:"GET",out:0,var:0,len:v*q}),m.push({cmd:"GET",out:1,var:1,len:v*q})),ct.push(e.queueAction(m).then(y=>(b&&b.debug(`${k}: fft ${j} join  ${K}/${j}  ${wt+1}/${at} ${ht}/${W/2}`),y)))}const Lt=await Promise.all(ct);for(let wt=0;wt<at;wt++)for(let ht=0;ht<W/2;ht++){const p=wt*W+ht,i=wt*W+ht+W/2,C=Lt.shift();I[p]=C[0],I[i]=C[1]}}if(_ instanceof Pt?P=new Pt(V*x):P=new Uint8Array(V*x),s){P.set(I[0].slice((v-1)*x));let K=x;for(let at=T-1;at>0;at--)P.set(I[at],K),K+=v*x,delete I[at];P.set(I[0].slice(0,(v-1)*x),K),delete I[0]}else for(let K=0;K<T;K++)P.set(I[K],v*x*K),delete I[K];return L?Ao(P,x):P}async function h(_,s,w,B,b){let k,D;k=_.slice(0,_.byteLength/2),D=_.slice(_.byteLength/2,_.byteLength);const F=[];[k,D]=await A(k,D,"fftJoinExt",o.one,o.shift,s,"jacobian",B,b),F.push(l(k,!1,"jacobian",w,B,b)),F.push(l(D,!1,"jacobian",w,B,b));const q=await Promise.all(F);let x;return q[0].byteLength>1<<28?x=new Pt(q[0].byteLength*2):x=new Uint8Array(q[0].byteLength*2),x.set(q[0]),x.set(q[1],q[0].byteLength),x}async function r(_,s,w,B,b){let k,D;k=_.slice(0,_.byteLength/2),D=_.slice(_.byteLength/2,_.byteLength);const F=[];F.push(l(k,!0,s,"jacobian",B,b)),F.push(l(D,!0,s,"jacobian",B,b)),[k,D]=await Promise.all(F);const q=await A(k,D,"fftJoinExtInv",o.one,o.shiftInv,"jacobian",w,B,b);let x;return q[0].byteLength>1<<28?x=new Pt(q[0].byteLength*2):x=new Uint8Array(q[0].byteLength*2),x.set(q[0]),x.set(q[1],q[0].byteLength),x}async function A(_,s,w,B,b,k,D,F,q){let z,lt,E,u,L,V;if(t=="G1")k=="affine"?(L=n.F.n8*2,lt="g1m_batchToJacobian"):L=n.F.n8*3,V=n.F.n8*3,z="g1m_"+w,D=="affine"?(E="g1m_batchToAffine",u=n.F.n8*2):u=n.F.n8*3;else if(t=="G2")k=="affine"?(L=n.F.n8*2,lt="g2m_batchToJacobian"):L=n.F.n8*3,z="g2m_"+w,V=n.F.n8*3,D=="affine"?(E="g2m_batchToAffine",u=n.F.n8*2):u=n.F.n8*3;else if(t=="Fr")L=o.n8,u=o.n8,V=o.n8,z="frm_"+w;else throw new Error("Invalid group");if(_.byteLength!=s.byteLength)throw new Error("Invalid buffer size");const j=Math.floor(_.byteLength/L);if(j!=1<<Zt(j))throw new Error("Invalid number of points");let X=Math.floor(j/e.concurrency);X<16&&(X=16),X>65536&&(X=65536);const P=[];for(let tt=0;tt<j;tt+=X){F&&F.debug(`${q}: fftJoinExt Start: ${tt}/${j}`);const K=Math.min(j-tt,X),at=o.mul(B,o.exp(b,tt)),W=[],ct=_.slice(tt*L,(tt+K)*L),Lt=s.slice(tt*L,(tt+K)*L);W.push({cmd:"ALLOC",var:0,len:V*K}),W.push({cmd:"SET",var:0,buff:ct}),W.push({cmd:"ALLOC",var:1,len:V*K}),W.push({cmd:"SET",var:1,buff:Lt}),W.push({cmd:"ALLOCSET",var:2,buff:at}),W.push({cmd:"ALLOCSET",var:3,buff:b}),lt&&(W.push({cmd:"CALL",fnName:lt,params:[{var:0},{val:K},{var:0}]}),W.push({cmd:"CALL",fnName:lt,params:[{var:1},{val:K},{var:1}]})),W.push({cmd:"CALL",fnName:z,params:[{var:0},{var:1},{val:K},{var:2},{var:3},{val:o.s}]}),E&&(W.push({cmd:"CALL",fnName:E,params:[{var:0},{val:K},{var:0}]}),W.push({cmd:"CALL",fnName:E,params:[{var:1},{val:K},{var:1}]})),W.push({cmd:"GET",out:0,var:0,len:K*u}),W.push({cmd:"GET",out:1,var:1,len:K*u}),P.push(e.queueAction(W).then(wt=>(F&&F.debug(`${q}: fftJoinExt End: ${tt}/${j}`),wt)))}const I=await Promise.all(P);let v,T;j*u>1<<28?(v=new Pt(j*u),T=new Pt(j*u)):(v=new Uint8Array(j*u),T=new Uint8Array(j*u));let ot=0;for(let tt=0;tt<I.length;tt++)v.set(I[tt][0],ot),T.set(I[tt][1],ot),ot+=I[tt][0].byteLength;return[v,T]}n.fft=async function(_,s,w,B,b){return await l(_,!1,s,w,B,b)},n.ifft=async function(_,s,w,B,b){return await l(_,!0,s,w,B,b)},n.lagrangeEvaluations=async function(_,s,w,B,b){s=s||"affine",w=w||"affine";let k;if(t=="G1")s=="affine"?k=n.F.n8*2:k=n.F.n8*3;else if(t=="G2")s=="affine"?k=n.F.n8*2:k=n.F.n8*3;else if(t=="Fr")k=o.n8;else throw new Error("Invalid group");const D=_.byteLength/k,F=Zt(D);if(2**F*k!=_.byteLength)throw B&&B.error("lagrangeEvaluations iinvalid input size"),new Error("lagrangeEvaluations invalid Input size");if(F<=o.s)return await n.ifft(_,s,w,B,b);if(F>o.s+1)throw B&&B.error("lagrangeEvaluations input too big"),new Error("lagrangeEvaluations input too big");let q=_.slice(0,_.byteLength/2),x=_.slice(_.byteLength/2,_.byteLength);const it=o.exp(o.shift,D/2),z=o.inv(o.sub(o.one,it));[q,x]=await A(q,x,"prepareLagrangeEvaluation",z,o.shiftInv,s,"jacobian",B,b+" prep");const lt=[];lt.push(l(q,!0,"jacobian",w,B,b+" t0")),lt.push(l(x,!0,"jacobian",w,B,b+" t1")),[q,x]=await Promise.all(lt);let E;return q.byteLength>1<<28?E=new Pt(q.byteLength*2):E=new Uint8Array(q.byteLength*2),E.set(q),E.set(x,q.byteLength),E},n.fftMix=async function(s){const w=n.F.n8*3;let B,b;if(t=="G1")B="g1m_fftMix",b="g1m_fftJoin";else if(t=="G2")B="g2m_fftMix",b="g2m_fftJoin";else if(t=="Fr")B="frm_fftMix",b="frm_fftJoin";else throw new Error("Invalid group");const k=Math.floor(s.byteLength/w),D=Zt(k);let F=1<<Zt(e.concurrency);k<=F*2&&(F=1);const q=k/F,x=Zt(q),it=[];for(let L=0;L<F;L++){const V=[],j=s.slice(L*q*w,(L+1)*q*w);V.push({cmd:"ALLOCSET",var:0,buff:j});for(let X=1;X<=x;X++)V.push({cmd:"CALL",fnName:B,params:[{var:0},{val:q},{val:X}]});V.push({cmd:"GET",out:0,var:0,len:q*w}),it.push(e.queueAction(V))}const z=await Promise.all(it),lt=[];for(let L=0;L<z.length;L++)lt[L]=z[L][0];for(let L=x+1;L<=D;L++){const V=1<<D-L,j=F/V,X=[];for(let I=0;I<V;I++)for(let v=0;v<j/2;v++){const T=o.exp(o.w[L],v*q),ot=o.w[L],tt=I*j+v,K=I*j+v+j/2,at=[];at.push({cmd:"ALLOCSET",var:0,buff:lt[tt]}),at.push({cmd:"ALLOCSET",var:1,buff:lt[K]}),at.push({cmd:"ALLOCSET",var:2,buff:T}),at.push({cmd:"ALLOCSET",var:3,buff:ot}),at.push({cmd:"CALL",fnName:b,params:[{var:0},{var:1},{val:q},{var:2},{var:3}]}),at.push({cmd:"GET",out:0,var:0,len:q*w}),at.push({cmd:"GET",out:1,var:1,len:q*w}),X.push(e.queueAction(at))}const P=await Promise.all(X);for(let I=0;I<V;I++)for(let v=0;v<j/2;v++){const T=I*j+v,ot=I*j+v+j/2,tt=P.shift();lt[T]=tt[0],lt[ot]=tt[1]}}let E;s instanceof Pt?E=new Pt(k*w):E=new Uint8Array(k*w);let u=0;for(let L=0;L<F;L++)E.set(lt[L],u),u+=lt[L].byteLength;return E},n.fftJoin=async function(s,w,B,b){const k=n.F.n8*3;let D;if(t=="G1")D="g1m_fftJoin";else if(t=="G2")D="g2m_fftJoin";else if(t=="Fr")D="frm_fftJoin";else throw new Error("Invalid group");if(s.byteLength!=w.byteLength)throw new Error("Invalid buffer size");const F=Math.floor(s.byteLength/k);if(F!=1<<Zt(F))throw new Error("Invalid number of points");let q=1<<Zt(e.concurrency);F<=q*2&&(q=1);const x=F/q,it=[];for(let L=0;L<q;L++){const V=[],j=o.mul(B,o.exp(b,L*x)),X=s.slice(L*x*k,(L+1)*x*k),P=w.slice(L*x*k,(L+1)*x*k);V.push({cmd:"ALLOCSET",var:0,buff:X}),V.push({cmd:"ALLOCSET",var:1,buff:P}),V.push({cmd:"ALLOCSET",var:2,buff:j}),V.push({cmd:"ALLOCSET",var:3,buff:b}),V.push({cmd:"CALL",fnName:D,params:[{var:0},{var:1},{val:x},{var:2},{var:3}]}),V.push({cmd:"GET",out:0,var:0,len:x*k}),V.push({cmd:"GET",out:1,var:1,len:x*k}),it.push(e.queueAction(V))}const z=await Promise.all(it);let lt,E;s instanceof Pt?(lt=new Pt(F*k),E=new Pt(F*k)):(lt=new Uint8Array(F*k),E=new Uint8Array(F*k));let u=0;for(let L=0;L<z.length;L++)lt.set(z[L][0],u),E.set(z[L][1],u),u+=z[L][0].byteLength;return[lt,E]},n.fftFinal=async function(s,w){const B=n.F.n8*3,b=n.F.n8*2;let k,D;if(t=="G1")k="g1m_fftFinal",D="g1m_batchToAffine";else if(t=="G2")k="g2m_fftFinal",D="g2m_batchToAffine";else throw new Error("Invalid group");const F=Math.floor(s.byteLength/B);if(F!=1<<Zt(F))throw new Error("Invalid number of points");const q=Math.floor(F/e.concurrency),x=[];for(let E=0;E<e.concurrency;E++){let u;if(E<e.concurrency-1?u=q:u=F-E*q,u==0)continue;const L=[],V=s.slice(E*q*B,(E*q+u)*B);L.push({cmd:"ALLOCSET",var:0,buff:V}),L.push({cmd:"ALLOCSET",var:1,buff:w}),L.push({cmd:"CALL",fnName:k,params:[{var:0},{val:u},{var:1}]}),L.push({cmd:"CALL",fnName:D,params:[{var:0},{val:u},{var:0}]}),L.push({cmd:"GET",out:0,var:0,len:u*b}),x.push(e.queueAction(L))}const it=await Promise.all(x);let z;s instanceof Pt?z=new Pt(F*b):z=new Uint8Array(F*b);let lt=0;for(let E=it.length-1;E>=0;E--)z.set(it[E][0],lt),lt+=it[E][0].byteLength;return z}}async function Di(a){const t=await jc(a.wasm,a.singleThread),n={};return n.q=Ut(a.wasm.q.toString()),n.r=Ut(a.wasm.r.toString()),n.name=a.name,n.tm=t,n.prePSize=a.wasm.prePSize,n.preQSize=a.wasm.preQSize,n.Fr=new ve(t,"frm",a.n8r,a.r),n.F1=new ve(t,"f1m",a.n8q,a.q),n.F2=new Oe(t,"f2m",n.F1),n.G1=new Pe(t,"g1m",n.F1,a.wasm.pG1gen,a.wasm.pG1b,a.cofactorG1),n.G2=new Pe(t,"g2m",n.F2,a.wasm.pG2gen,a.wasm.pG2b,a.cofactorG2),n.F6=new Hc(t,"f6m",n.F2),n.F12=new Oe(t,"ftm",n.F6),n.Gt=n.F12,Oo(n,"G1"),Oo(n,"G2"),Oo(n,"Fr"),Ue(n,"G1"),Ue(n,"G2"),Po(n,"G1"),Po(n,"G2"),Po(n,"Fr"),Zc(n),n.array2buffer=function(o,e){const l=new Uint8Array(e*o.length);for(let h=0;h<o.length;h++)l.set(o[h],h*e);return l},n.buffer2array=function(o,e){const l=o.byteLength/e,h=new Array(l);for(let r=0;r<l;r++)h[r]=o.slice(r*e,r*e+e);return h},n}function Nn(a){return BigInt(a)}function Gi(a){return a<0n}function Wc(a){return a===0n}function Jc(a){return Gi(a)?a.toString(2).length-1:a.toString(2).length}function Qo(a){const t=[],n=Nn(a);return t.push(Number(n&0xFFn)),t.push(Number(n>>8n&0xFFn)),t.push(Number(n>>16n&0xFFn)),t.push(Number(n>>24n&0xFFn)),t}function Xc(a){for(var t=[],n=0;n<a.length;n++){var o=a.charCodeAt(n);o<128?t.push(o):o<2048?t.push(192|o>>6,128|o&63):o<55296||o>=57344?t.push(224|o>>12,128|o>>6&63,128|o&63):(n++,o=65536+((o&1023)<<10|a.charCodeAt(n)&1023),t.push(240|o>>18,128|o>>12&63,128|o>>6&63,128|o&63))}return t}function jn(a){const t=Xc(a);return[...Et(t.length),...t]}function Ri(a){const t=[];let n=Nn(a);if(Gi(n))throw new Error("Number cannot be negative");for(;!Wc(n);)t.push(Number(n&0x7Fn)),n=n>>7n;t.length==0&&t.push(0);for(let o=0;o<t.length-1;o++)t[o]=t[o]|128;return t}function Ni(a){let t,n;const o=Jc(a);a<0?(n=!0,t=(1n<<BigInt(o))+a):(n=!1,t=Nn(a));const e=7-o%7,l=(1n<<BigInt(e))-1n<<BigInt(o),h=(1<<7-e)-1|128,r=Ri(t+l);return n||(r[r.length-1]=r[r.length-1]&h),r}function $o(a){let t=Nn(a);if(t>0xFFFFFFFFn)throw new Error("Number too big");if(t>0x7FFFFFFFn&&(t=t-0x100000000n),t<-2147483648n)throw new Error("Number too small");return Ni(t)}function ts(a){let t=Nn(a);if(t>0xFFFFFFFFFFFFFFFFn)throw new Error("Number too big");if(t>0x7FFFFFFFFFFFFFFFn&&(t=t-0x10000000000000000n),t<-9223372036854775808n)throw new Error("Number too small");return Ni(t)}function Et(a){let t=Nn(a);if(t>0xFFFFFFFFn)throw new Error("Number too big");return Ri(t)}function ze(a){return Array.from(a,function(t){return("0"+(t&255).toString(16)).slice(-2)}).join("")}class ns{constructor(t){this.func=t,this.functionName=t.functionName,this.module=t.module}setLocal(t,n){const o=this.func.localIdxByName[t];if(o===void 0)throw new Error(`Local Variable not defined: Function: ${this.functionName} local: ${t} `);return[...n,33,...Et(o)]}teeLocal(t,n){const o=this.func.localIdxByName[t];if(o===void 0)throw new Error(`Local Variable not defined: Function: ${this.functionName} local: ${t} `);return[...n,34,...Et(o)]}getLocal(t){const n=this.func.localIdxByName[t];if(n===void 0)throw new Error(`Local Variable not defined: Function: ${this.functionName} local: ${t} `);return[32,...Et(n)]}i64_load8_s(t,n,o){const e=n||0,l=o===void 0?0:o;return[...t,48,l,...Et(e)]}i64_load8_u(t,n,o){const e=n||0,l=o===void 0?0:o;return[...t,49,l,...Et(e)]}i64_load16_s(t,n,o){const e=n||0,l=o===void 0?1:o;return[...t,50,l,...Et(e)]}i64_load16_u(t,n,o){const e=n||0,l=o===void 0?1:o;return[...t,51,l,...Et(e)]}i64_load32_s(t,n,o){const e=n||0,l=o===void 0?2:o;return[...t,52,l,...Et(e)]}i64_load32_u(t,n,o){const e=n||0,l=o===void 0?2:o;return[...t,53,l,...Et(e)]}i64_load(t,n,o){const e=n||0,l=o===void 0?3:o;return[...t,41,l,...Et(e)]}i64_store(t,n,o,e){let l,h,r;return Array.isArray(n)?(l=0,h=3,r=n):Array.isArray(o)?(l=n,h=3,r=o):Array.isArray(e)&&(l=n,h=o,r=e),[...t,...r,55,h,...Et(l)]}i64_store32(t,n,o,e){let l,h,r;return Array.isArray(n)?(l=0,h=2,r=n):Array.isArray(o)?(l=n,h=2,r=o):Array.isArray(e)&&(l=n,h=o,r=e),[...t,...r,62,h,...Et(l)]}i64_store16(t,n,o,e){let l,h,r;return Array.isArray(n)?(l=0,h=1,r=n):Array.isArray(o)?(l=n,h=1,r=o):Array.isArray(e)&&(l=n,h=o,r=e),[...t,...r,61,h,...Et(l)]}i64_store8(t,n,o,e){let l,h,r;return Array.isArray(n)?(l=0,h=0,r=n):Array.isArray(o)?(l=n,h=0,r=o):Array.isArray(e)&&(l=n,h=o,r=e),[...t,...r,60,h,...Et(l)]}i32_load8_s(t,n,o){const e=n||0,l=o===void 0?0:o;return[...t,44,l,...Et(e)]}i32_load8_u(t,n,o){const e=n||0,l=o===void 0?0:o;return[...t,45,l,...Et(e)]}i32_load16_s(t,n,o){const e=n||0,l=o===void 0?1:o;return[...t,46,l,...Et(e)]}i32_load16_u(t,n,o){const e=n||0,l=o===void 0?1:o;return[...t,47,l,...Et(e)]}i32_load(t,n,o){const e=n||0,l=o===void 0?2:o;return[...t,40,l,...Et(e)]}i32_store(t,n,o,e){let l,h,r;return Array.isArray(n)?(l=0,h=2,r=n):Array.isArray(o)?(l=n,h=2,r=o):Array.isArray(e)&&(l=n,h=o,r=e),[...t,...r,54,h,...Et(l)]}i32_store16(t,n,o,e){let l,h,r;return Array.isArray(n)?(l=0,h=1,r=n):Array.isArray(o)?(l=n,h=1,r=o):Array.isArray(e)&&(l=n,h=o,r=e),[...t,...r,59,h,...Et(l)]}i32_store8(t,n,o,e){let l,h,r;return Array.isArray(n)?(l=0,h=0,r=n):Array.isArray(o)?(l=n,h=0,r=o):Array.isArray(e)&&(l=n,h=o,r=e),[...t,...r,58,h,...Et(l)]}call(t,...n){const o=this.module.functionIdxByName[t];if(o===void 0)throw new Error(`Function not defined: Function: ${t}`);return[...[].concat(...n),16,...Et(o)]}call_indirect(t,...n){return[...[].concat(...n),...t,17,0,0]}if(t,n,o){return o?[...t,4,64,...n,5,...o,11]:[...t,4,64,...n,11]}block(t){return[2,64,...t,11]}loop(...t){return[3,64,...[].concat(...t),11]}br_if(t,n){return[...n,13,...Et(t)]}br(t){return[12,...Et(t)]}ret(t){return[...t,15]}drop(t){return[...t,26]}i64_const(t){return[66,...ts(t)]}i32_const(t){return[65,...$o(t)]}i64_eqz(t){return[...t,80]}i64_eq(t,n){return[...t,...n,81]}i64_ne(t,n){return[...t,...n,82]}i64_lt_s(t,n){return[...t,...n,83]}i64_lt_u(t,n){return[...t,...n,84]}i64_gt_s(t,n){return[...t,...n,85]}i64_gt_u(t,n){return[...t,...n,86]}i64_le_s(t,n){return[...t,...n,87]}i64_le_u(t,n){return[...t,...n,88]}i64_ge_s(t,n){return[...t,...n,89]}i64_ge_u(t,n){return[...t,...n,90]}i64_add(t,n){return[...t,...n,124]}i64_sub(t,n){return[...t,...n,125]}i64_mul(t,n){return[...t,...n,126]}i64_div_s(t,n){return[...t,...n,127]}i64_div_u(t,n){return[...t,...n,128]}i64_rem_s(t,n){return[...t,...n,129]}i64_rem_u(t,n){return[...t,...n,130]}i64_and(t,n){return[...t,...n,131]}i64_or(t,n){return[...t,...n,132]}i64_xor(t,n){return[...t,...n,133]}i64_shl(t,n){return[...t,...n,134]}i64_shr_s(t,n){return[...t,...n,135]}i64_shr_u(t,n){return[...t,...n,136]}i64_extend_i32_s(t){return[...t,172]}i64_extend_i32_u(t){return[...t,173]}i64_clz(t){return[...t,121]}i64_ctz(t){return[...t,122]}i32_eqz(t){return[...t,69]}i32_eq(t,n){return[...t,...n,70]}i32_ne(t,n){return[...t,...n,71]}i32_lt_s(t,n){return[...t,...n,72]}i32_lt_u(t,n){return[...t,...n,73]}i32_gt_s(t,n){return[...t,...n,74]}i32_gt_u(t,n){return[...t,...n,75]}i32_le_s(t,n){return[...t,...n,76]}i32_le_u(t,n){return[...t,...n,77]}i32_ge_s(t,n){return[...t,...n,78]}i32_ge_u(t,n){return[...t,...n,79]}i32_add(t,n){return[...t,...n,106]}i32_sub(t,n){return[...t,...n,107]}i32_mul(t,n){return[...t,...n,108]}i32_div_s(t,n){return[...t,...n,109]}i32_div_u(t,n){return[...t,...n,110]}i32_rem_s(t,n){return[...t,...n,111]}i32_rem_u(t,n){return[...t,...n,112]}i32_and(t,n){return[...t,...n,113]}i32_or(t,n){return[...t,...n,114]}i32_xor(t,n){return[...t,...n,115]}i32_shl(t,n){return[...t,...n,116]}i32_shr_s(t,n){return[...t,...n,117]}i32_shr_u(t,n){return[...t,...n,118]}i32_rotl(t,n){return[...t,...n,119]}i32_rotr(t,n){return[...t,...n,120]}i32_wrap_i64(t){return[...t,167]}i32_clz(t){return[...t,103]}i32_ctz(t){return[...t,104]}unreachable(){return[0]}current_memory(){return[63,0]}comment(){return[]}}const Mo={i32:127,i64:126,f32:125,f64:124,anyfunc:112,func:96,emptyblock:64};class Te{constructor(t,n,o,e,l){if(o=="import")this.fnType="import",this.moduleName=e,this.fieldName=l;else if(o=="internal")this.fnType="internal";else throw new Error("Invalid function fnType: "+o);this.module=t,this.fnName=n,this.params=[],this.locals=[],this.localIdxByName={},this.code=[],this.returnType=null,this.nextLocal=0}addParam(t,n){if(this.localIdxByName[t])throw new Error(`param already exists. Function: ${this.fnName}, Param: ${t} `);const o=this.nextLocal++;this.localIdxByName[t]=o,this.params.push({type:n})}addLocal(t,n,o){const e=o||1;if(this.localIdxByName[t])throw new Error(`local already exists. Function: ${this.fnName}, Param: ${t} `);const l=this.nextLocal++;this.localIdxByName[t]=l,this.locals.push({type:n,length:e})}setReturnType(t){if(this.returnType)throw new Error(`returnType already defined. Function: ${this.fnName}`);this.returnType=t}getSignature(){const t=[...Et(this.params.length),...this.params.map(o=>Mo[o.type])],n=this.returnType?[1,Mo[this.returnType]]:[0];return[96,...t,...n]}getBody(){const t=this.locals.map(o=>[...Et(o.length),Mo[o.type]]),n=[...Et(this.locals.length),...[].concat(...t),...this.code,11];return[...Et(n.length),...n]}addCode(...t){this.code.push(...[].concat(...t))}getCodeBuilder(){return new ns(this)}}class Ki{constructor(){this.functions=[],this.functionIdxByName={},this.nImportFunctions=0,this.nInternalFunctions=0,this.memory={pagesSize:1,moduleName:"env",fieldName:"memory"},this.free=8,this.datas=[],this.modules={},this.exports=[],this.functionsTable=[]}build(){return this._setSignatures(),new Uint8Array([...Qo(1836278016),...Qo(1),...this._buildType(),...this._buildImport(),...this._buildFunctionDeclarations(),...this._buildFunctionsTable(),...this._buildExports(),...this._buildElements(),...this._buildCode(),...this._buildData()])}addFunction(t){if(typeof this.functionIdxByName[t]<"u")throw new Error(`Function already defined: ${t}`);const n=this.functions.length;return this.functionIdxByName[t]=n,this.functions.push(new Te(this,t,"internal")),this.nInternalFunctions++,this.functions[n]}addIimportFunction(t,n,o){if(typeof this.functionIdxByName[t]<"u")throw new Error(`Function already defined: ${t}`);if(this.functions.length>0&&this.functions[this.functions.length-1].type=="internal")throw new Error(`Import functions must be declared before internal: ${t}`);let e=o||t;const l=this.functions.length;return this.functionIdxByName[t]=l,this.functions.push(new Te(this,t,"import",n,e)),this.nImportFunctions++,this.functions[l]}setMemory(t,n,o){this.memory={pagesSize:t,moduleName:n||"env",fieldName:o||"memory"}}exportFunction(t,n){const o=n||t;if(typeof this.functionIdxByName[t]>"u")throw new Error(`Function not defined: ${t}`);const e=this.functionIdxByName[t];o!=t&&(this.functionIdxByName[o]=e),this.exports.push({exportName:o,idx:e})}addFunctionToTable(t){const n=this.functionIdxByName[t];this.functionsTable.push(n)}addData(t,n){this.datas.push({offset:t,bytes:n})}alloc(t,n){let o,e;(Array.isArray(t)||ArrayBuffer.isView(t))&&typeof n>"u"?(o=t.length,e=t):(o=t,e=n),o=(o-1>>3)+1<<3;const l=this.free;return this.free+=o,e&&this.addData(l,e),l}allocString(t){const o=new globalThis.TextEncoder().encode(t);return this.alloc([...o,0])}_setSignatures(){this.signatures=[];const t={};if(this.functionsTable.length>0){const n=this.functions[this.functionsTable[0]].getSignature(),o="s_"+ze(n);t[o]=0,this.signatures.push(n)}for(let n=0;n<this.functions.length;n++){const o=this.functions[n].getSignature(),e="s_"+ze(o);typeof t[e]>"u"&&(t[e]=this.signatures.length,this.signatures.push(o)),this.functions[n].signatureIdx=t[e]}}_buildSection(t,n){return[t,...Et(n.length),...n]}_buildType(){return this._buildSection(1,[...Et(this.signatures.length),...[].concat(...this.signatures)])}_buildImport(){const t=[];t.push([...jn(this.memory.moduleName),...jn(this.memory.fieldName),2,0,...Et(this.memory.pagesSize)]);for(let n=0;n<this.nImportFunctions;n++)t.push([...jn(this.functions[n].moduleName),...jn(this.functions[n].fieldName),0,...Et(this.functions[n].signatureIdx)]);return this._buildSection(2,Et(t.length).concat(...t))}_buildFunctionDeclarations(){const t=[];for(let n=this.nImportFunctions;n<this.nImportFunctions+this.nInternalFunctions;n++)t.push(...Et(this.functions[n].signatureIdx));return this._buildSection(3,[...Et(t.length),...t])}_buildFunctionsTable(){return this.functionsTable.length==0?[]:this._buildSection(4,[...Et(1),112,0,...Et(this.functionsTable.length)])}_buildElements(){if(this.functionsTable.length==0)return[];const t=[];for(let n=0;n<this.functionsTable.length;n++)t.push(...Et(this.functionsTable[n]));return this._buildSection(9,[...Et(1),...Et(0),65,...$o(0),11,...Et(this.functionsTable.length),...t])}_buildExports(){const t=[];for(let n=0;n<this.exports.length;n++)t.push([...jn(this.exports[n].exportName),0,...Et(this.exports[n].idx)]);return this._buildSection(7,Et(t.length).concat(...t))}_buildCode(){const t=[];for(let n=this.nImportFunctions;n<this.nImportFunctions+this.nInternalFunctions;n++)t.push(this.functions[n].getBody());return this._buildSection(10,Et(t.length).concat(...t))}_buildData(){const t=[];t.push([0,65,0,11,4,...Qo(this.free)]);for(let n=0;n<this.datas.length;n++)t.push([0,65,...$o(this.datas[n].offset),11,...Et(this.datas[n].bytes.length),...this.datas[n].bytes]);return this._buildSection(11,Et(t.length).concat(...t))}}globalThis.curve_bn128=null;async function Hi(a,t){if(!a&&globalThis.curve_bn128)return globalThis.curve_bn128;const n=new Ki;n.setMemory(25),Tc(n);const o={};o.code=n.build(),o.pq=n.modules.f1m.pq,o.pr=n.modules.frm.pq,o.pG1gen=n.modules.bn128.pG1gen,o.pG1zero=n.modules.bn128.pG1zero,o.pG1b=n.modules.bn128.pG1b,o.pG2gen=n.modules.bn128.pG2gen,o.pG2zero=n.modules.bn128.pG2zero,o.pG2b=n.modules.bn128.pG2b,o.pOneT=n.modules.bn128.pOneT,o.prePSize=n.modules.bn128.prePSize,o.preQSize=n.modules.bn128.preQSize,o.n8q=32,o.n8r=32,o.q=n.modules.bn128.q,o.r=n.modules.bn128.r;const e={name:"bn128",wasm:o,q:Ut("21888242871839275222246405745257275088696311157297823662689037894645226208583"),r:Ut("21888242871839275222246405745257275088548364400416034343698204186575808495617"),n8q:32,n8r:32,cofactorG2:Ut("30644e72e131a029b85045b68181585e06ceecda572a2489345f2299c0f9fa8d",16),singleThread:!!a},l=await Di(e);return l.terminate=async function(){e.singleThread||(globalThis.curve_bn128=null,await this.tm.terminate())},a||(globalThis.curve_bn128=l),l}globalThis.curve_bls12381=null;async function Vi(a,t){if(!a&&globalThis.curve_bls12381)return globalThis.curve_bls12381;const n=new Ki;n.setMemory(25),kc(n);const o={};o.code=n.build(),o.pq=n.modules.f1m.pq,o.pr=n.modules.frm.pq,o.pG1gen=n.modules.bls12381.pG1gen,o.pG1zero=n.modules.bls12381.pG1zero,o.pG1b=n.modules.bls12381.pG1b,o.pG2gen=n.modules.bls12381.pG2gen,o.pG2zero=n.modules.bls12381.pG2zero,o.pG2b=n.modules.bls12381.pG2b,o.pOneT=n.modules.bls12381.pOneT,o.prePSize=n.modules.bls12381.prePSize,o.preQSize=n.modules.bls12381.preQSize,o.n8q=48,o.n8r=32,o.q=n.modules.bls12381.q,o.r=n.modules.bls12381.r;const e={name:"bls12381",wasm:o,q:Ut("1a0111ea397fe69a4b1ba7b6434bacd764774b84f38512bf6730d2a0f6b0f6241eabfffeb153ffffb9feffffffffaaab",16),r:Ut("73eda753299d7d483339d80809a1d80553bda402fffe5bfeffffffff00000001",16),n8q:48,n8r:32,cofactorG1:Ut("0x396c8c005555e1568c00aaab0000aaab",16),cofactorG2:Ut("0x5d543a95414e7f1091d50792876a202cd91de4547085abaa68a205b2e5a7ddfa628f1cb4d9e82ef21537e293a6691ae1616ec6e786f0c70cf1c38e31c7238e5",16),singleThread:!!a},l=await Di(e);return l.terminate=async function(){e.singleThread||(globalThis.curve_bls12381=null,await this.tm.terminate())},a||(globalThis.curve_bls12381=l),l}Ut("73eda753299d7d483339d80809a1d80553bda402fffe5bfeffffffff00000001",16);Ut("21888242871839275222246405745257275088548364400416034343698204186575808495617");Ut("1a0111ea397fe69a4b1ba7b6434bacd764774b84f38512bf6730d2a0f6b0f6241eabfffeb153ffffb9feffffffffaaab",16);Ut("21888242871839275222246405745257275088696311157297823662689037894645226208583");const Qt=za,Nt=Kc;var $i={};async function ji(a,t,n,o){if(n=n||4096*64,typeof t!="number"&&["w+","wx+","r","ax+","a+"].indexOf(t)<0)throw new Error("Invalid open option");const e=await $i.promises.open(a,t),l=await e.stat();return new os(e,l,n,o,a)}class os{constructor(t,n,o,e,l){for(this.fileName=l,this.fd=t,this.pos=0,this.pageSize=e||256;this.pageSize<n.blksize;)this.pageSize*=2;this.totalSize=n.size,this.totalPages=Math.floor((n.size-1)/this.pageSize)+1,this.maxPagesLoaded=Math.floor(o/this.pageSize)+1,this.pages={},this.pendingLoads=[],this.writing=!1,this.reading=!1,this.avBuffs=[],this.history={}}_loadPage(t){const n=this,o=new Promise((e,l)=>{n.pendingLoads.push({page:t,resolve:e,reject:l})});return n.__statusPage("After Load request: ",t),o}__statusPage(t,n){const o=[],e=this;if(!e.logHistory)return;o.push("=="+t+" "+n);let l="";for(let h=0;h<e.pendingLoads.length;h++)e.pendingLoads[h].page==n&&(l=l+" "+h);if(l&&o.push("Pending loads:"+l),typeof e.pages[n]<"u"){const h=e.pages[n];o.push("Loaded"),o.push("pendingOps: "+h.pendingOps),h.loading&&o.push("loading: "+h.loading),h.writing&&o.push("writing"),h.dirty&&o.push("dirty")}o.push("=="),e.history[n]||(e.history[n]=[]),e.history[n].push(o)}__printHistory(t){const n=this;n.history[t]||console.log("Empty History ",t),console.log("History "+t);for(let o=0;o<n.history[t].length;o++)for(let e=0;e<n.history[t][o].length;e++)console.log("-> "+n.history[t][o][e])}_triggerLoad(){const t=this;if(t.reading||t.pendingLoads.length==0)return;const n=Object.keys(t.pages),o=[];for(let r=0;r<n.length;r++){const A=t.pages[parseInt(n[r])];A.dirty==!1&&A.pendingOps==0&&!A.writing&&!A.loading&&o.push(parseInt(n[r]))}let e=t.maxPagesLoaded-n.length;const l=[];for(;t.pendingLoads.length>0&&(typeof t.pages[t.pendingLoads[0].page]<"u"||e>0||o.length>0);){const r=t.pendingLoads.shift();if(typeof t.pages[r.page]<"u"){t.pages[r.page].pendingOps++;const A=o.indexOf(r.page);A>=0&&o.splice(A,1),t.pages[r.page].loading?t.pages[r.page].loading.push(r):r.resolve(),t.__statusPage("After Load (cached): ",r.page)}else{if(e)e--;else{const A=o.shift();t.__statusPage("Before Unload: ",A),t.avBuffs.unshift(t.pages[A]),delete t.pages[A],t.__statusPage("After Unload: ",A)}r.page>=t.totalPages?(t.pages[r.page]=h(),r.resolve(),t.__statusPage("After Load (new): ",r.page)):(t.reading=!0,t.pages[r.page]=h(),t.pages[r.page].loading=[r],l.push(t.fd.read(t.pages[r.page].buff,0,t.pageSize,r.page*t.pageSize).then(A=>{t.pages[r.page].size=A.bytesRead;const _=t.pages[r.page].loading;delete t.pages[r.page].loading;for(let s=0;s<_.length;s++)_[s].resolve();return t.__statusPage("After Load (loaded): ",r.page),A},A=>{r.reject(A)})),t.__statusPage("After Load (loading): ",r.page))}}Promise.all(l).then(()=>{t.reading=!1,t.pendingLoads.length>0&&setImmediate(t._triggerLoad.bind(t)),t._tryClose()});function h(){if(t.avBuffs.length>0){const r=t.avBuffs.shift();return r.dirty=!1,r.pendingOps=1,r.size=0,r}else return{dirty:!1,buff:new Uint8Array(t.pageSize),pendingOps:1,size:0}}}_triggerWrite(){const t=this;if(t.writing)return;const n=Object.keys(t.pages),o=[];for(let e=0;e<n.length;e++){const l=t.pages[parseInt(n[e])];l.dirty&&(l.dirty=!1,l.writing=!0,t.writing=!0,o.push(t.fd.write(l.buff,0,l.size,parseInt(n[e])*t.pageSize).then(()=>{l.writing=!1},h=>{console.log("ERROR Writing: "+h),t.error=h,t._tryClose()})))}t.writing&&Promise.all(o).then(()=>{t.writing=!1,setImmediate(t._triggerWrite.bind(t)),t._tryClose(),t.pendingLoads.length>0&&setImmediate(t._triggerLoad.bind(t))})}_getDirtyPage(){for(let t in this.pages)if(this.pages[t].dirty)return t;return-1}async write(t,n){if(t.byteLength==0)return;const o=this;if(typeof n>"u"&&(n=o.pos),o.pos=n+t.byteLength,o.totalSize<n+t.byteLength&&(o.totalSize=n+t.byteLength),o.pendingClose)throw new Error("Writing a closing file");const e=Math.floor(n/o.pageSize),l=Math.floor((n+t.byteLength-1)/o.pageSize),h=[];for(let s=e;s<=l;s++)h.push(o._loadPage(s));o._triggerLoad();let r=e,A=n%o.pageSize,_=t.byteLength;for(;_>0;){await h[r-e];const s=A+_>o.pageSize?o.pageSize-A:_,w=t.slice(t.byteLength-_,t.byteLength-_+s);new Uint8Array(o.pages[r].buff.buffer,A,s).set(w),o.pages[r].dirty=!0,o.pages[r].pendingOps--,o.pages[r].size=Math.max(A+s,o.pages[r].size),r>=o.totalPages&&(o.totalPages=r+1),_=_-s,r++,A=0,o.writing||setImmediate(o._triggerWrite.bind(o))}}async read(t,n){const o=this;let e=new Uint8Array(t);return await o.readToBuffer(e,0,t,n),e}async readToBuffer(t,n,o,e){if(o==0)return;const l=this;if(o>l.pageSize*l.maxPagesLoaded*.8){const B=Math.floor(o*1.1);this.maxPagesLoaded=Math.floor(B/l.pageSize)+1}if(typeof e>"u"&&(e=l.pos),l.pos=e+o,l.pendingClose)throw new Error("Reading a closing file");const h=Math.floor(e/l.pageSize),r=Math.floor((e+o-1)/l.pageSize),A=[];for(let B=h;B<=r;B++)A.push(l._loadPage(B));l._triggerLoad();let _=h,s=e%l.pageSize,w=e+o>l.totalSize?o-(e+o-l.totalSize):o;for(;w>0;){await A[_-h],l.__statusPage("After Await (read): ",_);const B=s+w>l.pageSize?l.pageSize-s:w,b=new Uint8Array(l.pages[_].buff.buffer,l.pages[_].buff.byteOffset+s,B);t.set(b,n+o-w),l.pages[_].pendingOps--,l.__statusPage("After Op done: ",_),w=w-B,_++,s=0,l.pendingLoads.length>0&&setImmediate(l._triggerLoad.bind(l))}this.pos=e+o}_tryClose(){const t=this;!t.pendingClose||(t.error&&t.pendingCloseReject(t.error),t._getDirtyPage()>=0||t.writing||t.reading||t.pendingLoads.length>0)||t.pendingClose()}close(){const t=this;if(t.pendingClose)throw new Error("Closing the file twice");return new Promise((n,o)=>{t.pendingClose=n,t.pendingCloseReject=o,t._tryClose()}).then(()=>{t.fd.close()},n=>{throw t.fd.close(),n})}async discard(){await this.close(),await $i.promises.unlink(this.fileName)}async writeULE32(t,n){const o=this,e=new Uint8Array(4);new DataView(e.buffer).setUint32(0,t,!0),await o.write(e,n)}async writeUBE32(t,n){const o=this,e=new Uint8Array(4);new DataView(e.buffer).setUint32(0,t,!1),await o.write(e,n)}async writeULE64(t,n){const o=this,e=new Uint8Array(8),l=new DataView(e.buffer);l.setUint32(0,t&4294967295,!0),l.setUint32(4,Math.floor(t/4294967296),!0),await o.write(e,n)}async readULE32(t){const o=await this.read(4,t);return new Uint32Array(o.buffer)[0]}async readUBE32(t){const o=await this.read(4,t);return new DataView(o.buffer).getUint32(0,!1)}async readULE64(t){const o=await this.read(8,t),e=new Uint32Array(o.buffer);return e[1]*4294967296+e[0]}async readString(t){const n=this;if(n.pendingClose)throw new Error("Reading a closing file");let o=typeof t>"u"?n.pos:t,e=Math.floor(o/n.pageSize),l=!1,h="";for(;!l;){let r=n._loadPage(e);n._triggerLoad(),await r,n.__statusPage("After Await (read): ",e);let A=o%n.pageSize;const _=new Uint8Array(n.pages[e].buff.buffer,n.pages[e].buff.byteOffset+A,n.pageSize-A);let s=_.findIndex(w=>w===0);l=s!==-1,l?(h+=new TextDecoder().decode(_.slice(0,s)),n.pos=e*this.pageSize+A+s+1):(h+=new TextDecoder().decode(_),n.pos=e*this.pageSize+A+_.length),n.pages[e].pendingOps--,n.__statusPage("After Op done: ",e),o=n.pos,e++,n.pendingLoads.length>0&&setImmediate(n._triggerLoad.bind(n))}return h}}function es(a){const t=a.initialSize||1048576,n=new Zi;return n.o=a,n.o.data=new Uint8Array(t),n.allocSize=t,n.totalSize=0,n.readOnly=!1,n.pos=0,n}function is(a){const t=new Zi;return t.o=a,t.allocSize=a.data.byteLength,t.totalSize=a.data.byteLength,t.readOnly=!0,t.pos=0,t}const jo=new Uint8Array(4),ke=new DataView(jo.buffer),Yi=new Uint8Array(8),De=new DataView(Yi.buffer);class Zi{constructor(){this.pageSize=16384}_resizeIfNeeded(t){if(t>this.allocSize){const n=Math.max(this.allocSize+1048576,Math.floor(this.allocSize*1.1),t),o=new Uint8Array(n);o.set(this.o.data),this.o.data=o,this.allocSize=n}}async write(t,n){if(typeof n>"u"&&(n=this.pos),this.readOnly)throw new Error("Writing a read only file");this._resizeIfNeeded(n+t.byteLength),this.o.data.set(t.slice(),n),n+t.byteLength>this.totalSize&&(this.totalSize=n+t.byteLength),this.pos=n+t.byteLength}async readToBuffer(t,n,o,e){if(typeof e>"u"&&(e=this.pos),this.readOnly&&e+o>this.totalSize)throw new Error("Reading out of bounds");this._resizeIfNeeded(e+o);const h=new Uint8Array(this.o.data.buffer,this.o.data.byteOffset+e,o);t.set(h,n),this.pos=e+o}async read(t,n){const o=this,e=new Uint8Array(t);return await o.readToBuffer(e,0,t,n),e}close(){this.o.data.byteLength!=this.totalSize&&(this.o.data=this.o.data.slice(0,this.totalSize))}async discard(){}async writeULE32(t,n){const o=this;ke.setUint32(0,t,!0),await o.write(jo,n)}async writeUBE32(t,n){const o=this;ke.setUint32(0,t,!1),await o.write(jo,n)}async writeULE64(t,n){const o=this;De.setUint32(0,t&4294967295,!0),De.setUint32(4,Math.floor(t/4294967296),!0),await o.write(Yi,n)}async readULE32(t){const o=await this.read(4,t);return new Uint32Array(o.buffer)[0]}async readUBE32(t){const o=await this.read(4,t);return new DataView(o.buffer).getUint32(0,!1)}async readULE64(t){const o=await this.read(8,t),e=new Uint32Array(o.buffer);return e[1]*4294967296+e[0]}async readString(t){const n=this;let o=typeof t>"u"?n.pos:t;if(o>this.totalSize){if(this.readOnly)throw new Error("Reading out of bounds");this._resizeIfNeeded(t)}const e=new Uint8Array(n.o.data.buffer,o,this.totalSize-o);let l=e.findIndex(A=>A===0),h=l!==-1,r="";return h?(r=new TextDecoder().decode(e.slice(0,l)),n.pos=o+l+1):n.pos=o,r}}const Tt=1<<22;function as(a){const t=a.initialSize||0,n=new Ji;n.o=a;const o=t?Math.floor((t-1)/Tt)+1:0;n.o.data=[];for(let e=0;e<o-1;e++)n.o.data.push(new Uint8Array(Tt));return o&&n.o.data.push(new Uint8Array(t-Tt*(o-1))),n.totalSize=0,n.readOnly=!1,n.pos=0,n}function cs(a){const t=new Ji;return t.o=a,t.totalSize=(a.data.length-1)*Tt+a.data[a.data.length-1].byteLength,t.readOnly=!0,t.pos=0,t}const Yo=new Uint8Array(4),Ge=new DataView(Yo.buffer),Wi=new Uint8Array(8),Re=new DataView(Wi.buffer);class Ji{constructor(){this.pageSize=16384}_resizeIfNeeded(t){if(t<=this.totalSize)return;if(this.readOnly)throw new Error("Reading out of file bounds");const n=Math.floor((t-1)/Tt)+1;for(let o=Math.max(this.o.data.length-1,0);o<n;o++){const e=o<n-1?Tt:t-(n-1)*Tt,l=new Uint8Array(e);o==this.o.data.length-1&&l.set(this.o.data[o]),this.o.data[o]=l}this.totalSize=t}async write(t,n){const o=this;if(typeof n>"u"&&(n=o.pos),this.readOnly)throw new Error("Writing a read only file");this._resizeIfNeeded(n+t.byteLength);let l=Math.floor(n/Tt),h=n%Tt,r=t.byteLength;for(;r>0;){const A=h+r>Tt?Tt-h:r,_=t.slice(t.byteLength-r,t.byteLength-r+A);new Uint8Array(o.o.data[l].buffer,h,A).set(_),r=r-A,l++,h=0}this.pos=n+t.byteLength}async readToBuffer(t,n,o,e){const l=this;if(typeof e>"u"&&(e=l.pos),this.readOnly&&e+o>this.totalSize)throw new Error("Reading out of bounds");this._resizeIfNeeded(e+o);let r=Math.floor(e/Tt),A=e%Tt,_=o;for(;_>0;){const s=A+_>Tt?Tt-A:_,w=new Uint8Array(l.o.data[r].buffer,A,s);t.set(w,n+o-_),_=_-s,r++,A=0}this.pos=e+o}async read(t,n){const o=this,e=new Uint8Array(t);return await o.readToBuffer(e,0,t,n),e}close(){}async discard(){}async writeULE32(t,n){const o=this;Ge.setUint32(0,t,!0),await o.write(Yo,n)}async writeUBE32(t,n){const o=this;Ge.setUint32(0,t,!1),await o.write(Yo,n)}async writeULE64(t,n){const o=this;Re.setUint32(0,t&4294967295,!0),Re.setUint32(4,Math.floor(t/4294967296),!0),await o.write(Wi,n)}async readULE32(t){const o=await this.read(4,t);return new Uint32Array(o.buffer)[0]}async readUBE32(t){const o=await this.read(4,t);return new DataView(o.buffer).getUint32(0,!1)}async readULE64(t){const o=await this.read(8,t),e=new Uint32Array(o.buffer);return e[1]*4294967296+e[0]}async readString(t){const n=this,o=2048;let e=typeof t>"u"?n.pos:t;if(e>this.totalSize){if(this.readOnly)throw new Error("Reading out of bounds");this._resizeIfNeeded(t)}let l=!1,h="";for(;!l;){let r=Math.floor(e/Tt),A=e%Tt;if(n.o.data[r]===void 0)throw new Error("ERROR");let _=Math.min(o,n.o.data[r].length-A);const s=new Uint8Array(n.o.data[r].buffer,A,_);let w=s.findIndex(B=>B===0);l=w!==-1,l?(h+=new TextDecoder().decode(s.slice(0,w)),n.pos=r*Tt+A+w+1):(h+=new TextDecoder().decode(s),n.pos=r*Tt+A+s.length),e=n.pos}return h}}const ss=1024,ls=512,rs=2,ds=0,_s=65536,gs=8192;async function Xi(a,t,n){if(typeof a=="string"&&(a={type:"file",fileName:a,cacheSize:_s,pageSize:gs}),a.type=="file")return await ji(a.fileName,ss|ls|rs,a.cacheSize,a.pageSize);if(a.type=="mem")return es(a);if(a.type=="bigMem")return as(a);throw new Error("Invalid FastFile type: "+a.type)}async function ta(a,t,n){if(a instanceof Uint8Array&&(a={type:"mem",data:a}),typeof a=="string"&&(a={type:"mem",data:await fetch(a).then(function(e){return e.arrayBuffer()}).then(function(e){return new Uint8Array(e)})}),a.type=="file")return await ji(a.fileName,ds,a.cacheSize,a.pageSize);if(a.type=="mem")return await is(a);if(a.type=="bigMem")return await cs(a);throw new Error("Invalid FastFile type: "+a.type)}async function Ne(a,t,n,o,e){const l=await ta(a),h=await l.read(4);let r="";for(let w=0;w<4;w++)r+=String.fromCharCode(h[w]);if(r!=t)throw new Error(a+": Invalid File format");if(await l.readULE32()>n)throw new Error("Version not supported");const _=await l.readULE32();let s=[];for(let w=0;w<_;w++){let B=await l.readULE32(),b=await l.readULE64();typeof s[B]>"u"&&(s[B]=[]),s[B].push({p:l.pos,size:b}),l.pos+=b}return{fd:l,sections:s}}async function us(a,t,n,o,e,l){const h=await Xi(a),r=new Uint8Array(4);for(let A=0;A<4;A++)r[A]=t.charCodeAt(A);return await h.write(r,0),await h.writeULE32(n),await h.writeULE32(o),h}async function Ke(a,t){if(typeof a.writingSection<"u")throw new Error("Already writing a section");await a.writeULE32(t),a.writingSection={pSectionSize:a.pos},await a.writeULE64(0)}async function He(a){if(typeof a.writingSection>"u")throw new Error("Not writing a section");const t=a.pos-a.writingSection.pSectionSize-8,n=a.pos;a.pos=a.writingSection.pSectionSize,await a.writeULE64(t),a.pos=n,delete a.writingSection}async function io(a,t,n){if(typeof a.readingSection<"u")throw new Error("Already reading a section");if(!t[n])throw new Error(a.fileName+": Missing section "+n);if(t[n].length>1)throw new Error(a.fileName+": Section Duplicated "+n);a.pos=t[n][0].p,a.readingSection=t[n][0]}async function ao(a,t){if(typeof a.readingSection>"u")throw new Error("Not reading a section");if(a.pos-a.readingSection.p!=a.readingSection.size)throw new Error("Invalid section size reading");delete a.readingSection}async function fs(a,t,n,o){const e=new Uint8Array(n);Qt.toRprLE(e,0,t,n),await a.write(e,o)}async function Pn(a,t,n){const o=await a.read(t,n);return Qt.fromRprLE(o,0,t)}async function En(a,t,n,o,e){if(o=typeof o>"u"?0:o,e=typeof e>"u"?t[n][0].size-o:e,o+e>t[n][0].size)throw new Error("Reading out of the range of the section");let l;return e<1<<30?l=new Uint8Array(e):l=new Pt(e),await a.readToBuffer(l,0,e,t[n][0].p+o),l}Qt.e("73eda753299d7d483339d80809a1d80553bda402fffe5bfeffffffff00000001",16);Qt.e("21888242871839275222246405745257275088548364400416034343698204186575808495617");const hs=Qt.e("1a0111ea397fe69a4b1ba7b6434bacd764774b84f38512bf6730d2a0f6b0f6241eabfffeb153ffffb9feffffffffaaab",16),ps=Qt.e("21888242871839275222246405745257275088696311157297823662689037894645226208583");async function _e(a,t){let n,o=t&&t.singleThread;if(Qt.eq(a,ps))n=await Hi(o);else if(Qt.eq(a,hs))n=await Vi(o);else throw new Error(`Curve not supported: ${Qt.toString(a)}`);return n}async function Ls(a,t){let n,o=t&&t.singleThread;const e=l(a);if(["BN128","BN254","ALTBN128"].indexOf(e)>=0)n=await Hi(o);else if(["BLS12381"].indexOf(e)>=0)n=await Vi(o);else throw new Error(`Curve not supported: ${a}`);return n;function l(h){return h.toUpperCase().match(/[A-Za-z0-9]+/g).join("")}}var As=typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:{},pn={exports:{}},bs=oa;class na extends Error{}na.prototype.name="AssertionError";function oa(a,t){if(!a){var n=new na(t);throw Error.captureStackTrace&&Error.captureStackTrace(n,oa),n}}var Zo={exports:{}};function ea(a){return a.length}function Is(a){const t=a.byteLength;let n="";for(let o=0;o<t;o++)n+=String.fromCharCode(a[o]);return n}function ys(a,t,n=0,o=ea(t)){const e=Math.min(o,a.byteLength-n);for(let l=0;l<e;l++)a[n+l]=t.charCodeAt(l);return e}var Cs={byteLength:ea,toString:Is,write:ys};const Un="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/",Sn=new Uint8Array(256);for(let a=0;a<Un.length;a++)Sn[Un.charCodeAt(a)]=a;Sn[45]=62;Sn[95]=63;function ia(a){let t=a.length;return a.charCodeAt(t-1)===61&&t--,t>1&&a.charCodeAt(t-1)===61&&t--,t*3>>>2}function ms(a){const t=a.byteLength;let n="";for(let o=0;o<t;o+=3)n+=Un[a[o]>>2]+Un[(a[o]&3)<<4|a[o+1]>>4]+Un[(a[o+1]&15)<<2|a[o+2]>>6]+Un[a[o+2]&63];return t%3===2?n=n.substring(0,n.length-1)+"=":t%3===1&&(n=n.substring(0,n.length-2)+"=="),n}function ws(a,t,n=0,o=ia(t)){const e=Math.min(o,a.byteLength-n);for(let l=0,h=0;h<e;l+=4){const r=Sn[t.charCodeAt(l)],A=Sn[t.charCodeAt(l+1)],_=Sn[t.charCodeAt(l+2)],s=Sn[t.charCodeAt(l+3)];a[h++]=r<<2|A>>4,a[h++]=(A&15)<<4|_>>2,a[h++]=(_&3)<<6|s&63}return e}var Bs={byteLength:ia,toString:ms,write:ws};function aa(a){return a.length>>>1}function Es(a){const t=a.byteLength;a=new DataView(a.buffer,a.byteOffset,t);let n="",o=0;for(let e=t-t%4;o<e;o+=4)n+=a.getUint32(o).toString(16).padStart(8,"0");for(;o<t;o++)n+=a.getUint8(o).toString(16).padStart(2,"0");return n}function Fs(a,t,n=0,o=aa(t)){const e=Math.min(o,a.byteLength-n);for(let l=0;l<e;l++){const h=Ve(t.charCodeAt(l*2)),r=Ve(t.charCodeAt(l*2+1));if(h===void 0||r===void 0)return a.subarray(0,l);a[n+l]=h<<4|r}return e}var xs={byteLength:aa,toString:Es,write:Fs};function Ve(a){if(a>=48&&a<=57)return a-48;if(a>=65&&a<=70)return a-65+10;if(a>=97&&a<=102)return a-97+10}function Wo(a){let t=0;for(let n=0,o=a.length;n<o;n++){const e=a.charCodeAt(n);if(e>=55296&&e<=56319&&n+1<o){const l=a.charCodeAt(n+1);if(l>=56320&&l<=57343){t+=4,n++;continue}}e<=127?t+=1:e<=2047?t+=2:t+=3}return t}let Jo;if(typeof TextDecoder<"u"){const a=new TextDecoder;Jo=function(n){return a.decode(n)}}else Jo=function(t){const n=t.byteLength;let o="",e=0;for(;e<n;){let l=t[e];if(l<=127){o+=String.fromCharCode(l),e++;continue}let h=0,r=0;if(l<=223?(h=1,r=l&31):l<=239?(h=2,r=l&15):l<=244&&(h=3,r=l&7),n-e-h>0){let A=0;for(;A<h;)l=t[e+A+1],r=r<<6|l&63,A+=1}else r=65533,h=n-e;o+=String.fromCodePoint(r),e+=h+1}return o};let Xo;if(typeof TextEncoder<"u"){const a=new TextEncoder;Xo=function(n,o,e=0,l=Wo(o)){const h=Math.min(l,n.byteLength-e);return a.encodeInto(o,n.subarray(e,e+h)),h}}else Xo=function(t,n,o=0,e=Wo(n)){const l=Math.min(e,t.byteLength-o);t=t.subarray(o,o+l);let h=0,r=0;for(;h<n.length;){const A=n.codePointAt(h);if(A<=127){t[r++]=A,h++;continue}let _=0,s=0;for(A<=2047?(_=6,s=192):A<=65535?(_=12,s=224):A<=2097151&&(_=18,s=240),t[r++]=s|A>>_,_-=6;_>=0;)t[r++]=128|A>>_&63,_-=6;h+=A>=65536?2:1}return l};var Ss={byteLength:Wo,toString:Jo,write:Xo};function ca(a){return a.length*2}function vs(a){const t=a.byteLength;let n="";for(let o=0;o<t-1;o+=2)n+=String.fromCharCode(a[o]+a[o+1]*256);return n}function Os(a,t,n=0,o=ca(t)){const e=Math.min(o,a.byteLength-n);let l=e;for(let h=0;h<t.length&&!((l-=2)<0);++h){const r=t.charCodeAt(h),A=r>>8,_=r%256;a[n+h*2]=_,a[n+h*2+1]=A}return e}var Ps={byteLength:ca,toString:vs,write:Os};(function(a,t){const n=Cs,o=Bs,e=xs,l=Ss,h=Ps,r=new Uint8Array(Uint16Array.of(255).buffer)[0]===255;function A(c){switch(c){case"ascii":return n;case"base64":return o;case"hex":return e;case"utf8":case"utf-8":case void 0:return l;case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return h;default:throw new Error(`Unknown encoding: ${c}`)}}function _(c){return c instanceof Uint8Array}function s(c){try{return A(c),!0}catch{return!1}}function w(c,m,y){const f=new Uint8Array(c);return m!==void 0&&t.fill(f,m,0,f.byteLength,y),f}function B(c){return new Uint8Array(c)}function b(c){return new Uint8Array(c)}function k(c,m){return A(m).byteLength(c)}function D(c,m){if(c===m)return 0;const y=Math.min(c.byteLength,m.byteLength);c=new DataView(c.buffer,c.byteOffset,c.byteLength),m=new DataView(m.buffer,m.byteOffset,m.byteLength);let f=0;for(let S=y-y%4;f<S;f+=4){const J=c.getUint32(f,r),R=m.getUint32(f,r);if(J!==R)break}for(;f<y;f++){const S=c.getUint8(f),J=m.getUint8(f);if(S<J)return-1;if(S>J)return 1}return c.byteLength>m.byteLength?1:c.byteLength<m.byteLength?-1:0}function F(c,m){m===void 0&&(m=c.reduce((S,J)=>S+J.byteLength,0));const y=new Uint8Array(m);let f=0;for(const S of c){if(f+S.byteLength>y.byteLength){const J=S.subarray(0,y.byteLength-f);return y.set(J,f),y}y.set(S,f),f+=S.byteLength}return y}function q(c,m,y=0,f=0,S=c.byteLength){if(S>0&&S<f||S===f||c.byteLength===0||m.byteLength===0)return 0;if(y<0)throw new RangeError("targetStart is out of range");if(f<0||f>=c.byteLength)throw new RangeError("sourceStart is out of range");if(S<0)throw new RangeError("sourceEnd is out of range");y>=m.byteLength&&(y=m.byteLength),S>c.byteLength&&(S=c.byteLength),m.byteLength-y<S-f&&(S=m.length-y+f);const J=S-f;return c===m?m.copyWithin(y,f,S):m.set(c.subarray(f,S),y),J}function x(c,m){if(c===m)return!0;if(c.byteLength!==m.byteLength)return!1;const y=c.byteLength;c=new DataView(c.buffer,c.byteOffset,c.byteLength),m=new DataView(m.buffer,m.byteOffset,m.byteLength);let f=0;for(let S=y-y%4;f<S;f+=4)if(c.getUint32(f,r)!==m.getUint32(f,r))return!1;for(;f<y;f++)if(c.getUint8(f)!==m.getUint8(f))return!1;return!0}function it(c,m,y,f,S){if(typeof m=="string"?typeof y=="string"?(S=y,y=0,f=c.byteLength):typeof f=="string"&&(S=f,f=c.byteLength):typeof m=="number"?m=m&255:typeof m=="boolean"&&(m=+m),y<0||c.byteLength<y||c.byteLength<f)throw new RangeError("Out of range index");if(y===void 0&&(y=0),f===void 0&&(f=c.byteLength),f<=y)return c;if(m||(m=0),typeof m=="number")for(let J=y;J<f;++J)c[J]=m;else{m=_(m)?m:z(m,S);const J=m.byteLength;for(let R=0;R<f-y;++R)c[R+y]=m[R%J]}return c}function z(c,m,y){return typeof c=="string"?lt(c,m):Array.isArray(c)?E(c):ArrayBuffer.isView(c)?u(c):L(c,m,y)}function lt(c,m){const y=A(m),f=new Uint8Array(y.byteLength(c));return y.write(f,c,0,f.byteLength),f}function E(c){const m=new Uint8Array(c.length);return m.set(c),m}function u(c){const m=new Uint8Array(c.byteLength);return m.set(c),m}function L(c,m,y){return new Uint8Array(c,m,y)}function V(c,m,y,f){return X(c,m,y,f)!==-1}function j(c,m,y,f,S){if(c.byteLength===0)return-1;if(typeof y=="string"?(f=y,y=0):y===void 0?y=S?0:c.length-1:y<0&&(y+=c.byteLength),y>=c.byteLength){if(S)return-1;y=c.byteLength-1}else if(y<0)if(S)y=0;else return-1;if(typeof m=="string")m=z(m,f);else if(typeof m=="number")return m=m&255,S?c.indexOf(m,y):c.lastIndexOf(m,y);if(m.byteLength===0)return-1;if(S){let J=-1;for(let R=y;R<c.byteLength;R++)if(c[R]===m[J===-1?0:R-J]){if(J===-1&&(J=R),R-J+1===m.byteLength)return J}else J!==-1&&(R-=R-J),J=-1}else{y+m.byteLength>c.byteLength&&(y=c.byteLength-m.byteLength);for(let J=y;J>=0;J--){let R=!0;for(let et=0;et<m.byteLength;et++)if(c[J+et]!==m[et]){R=!1;break}if(R)return J}}return-1}function X(c,m,y,f){return j(c,m,y,f,!0)}function P(c,m,y,f){return j(c,m,y,f,!1)}function I(c,m,y){const f=c[m];c[m]=c[y],c[y]=f}function v(c){const m=c.byteLength;if(m%2!==0)throw new RangeError("Buffer size must be a multiple of 16-bits");for(let y=0;y<m;y+=2)I(c,y,y+1);return c}function T(c){const m=c.byteLength;if(m%4!==0)throw new RangeError("Buffer size must be a multiple of 32-bits");for(let y=0;y<m;y+=4)I(c,y,y+3),I(c,y+1,y+2);return c}function ot(c){const m=c.byteLength;if(m%8!==0)throw new RangeError("Buffer size must be a multiple of 64-bits");for(let y=0;y<m;y+=8)I(c,y,y+7),I(c,y+1,y+6),I(c,y+2,y+5),I(c,y+3,y+4);return c}function tt(c){return c}function K(c,m,y=0,f=c.byteLength){const S=c.byteLength;return y>=S||f<=y?"":(y<0&&(y=0),f>S&&(f=S),(y!==0||f<S)&&(c=c.subarray(y,f)),A(m).toString(c))}function at(c,m,y,f,S){return y===void 0?S="utf8":f===void 0&&typeof y=="string"?(S=y,y=void 0):S===void 0&&typeof f=="string"&&(S=f,f=void 0),A(S).write(c,m,y,f)}function W(c,m,y){return y===void 0&&(y=0),new DataView(c.buffer,c.byteOffset,c.byteLength).setFloat64(y,m,!0),y+8}function ct(c,m,y){return y===void 0&&(y=0),new DataView(c.buffer,c.byteOffset,c.byteLength).setFloat32(y,m,!0),y+4}function Lt(c,m,y){return y===void 0&&(y=0),new DataView(c.buffer,c.byteOffset,c.byteLength).setUint32(y,m,!0),y+4}function wt(c,m,y){return y===void 0&&(y=0),new DataView(c.buffer,c.byteOffset,c.byteLength).setInt32(y,m,!0),y+4}function ht(c,m){return m===void 0&&(m=0),new DataView(c.buffer,c.byteOffset,c.byteLength).getFloat64(m,!0)}function p(c,m){return m===void 0&&(m=0),new DataView(c.buffer,c.byteOffset,c.byteLength).getFloat32(m,!0)}function i(c,m){return m===void 0&&(m=0),new DataView(c.buffer,c.byteOffset,c.byteLength).getUint32(m,!0)}function C(c,m){return m===void 0&&(m=0),new DataView(c.buffer,c.byteOffset,c.byteLength).getInt32(m,!0)}a.exports=t={isBuffer:_,isEncoding:s,alloc:w,allocUnsafe:B,allocUnsafeSlow:b,byteLength:k,compare:D,concat:F,copy:q,equals:x,fill:it,from:z,includes:V,indexOf:X,lastIndexOf:P,swap16:v,swap32:T,swap64:ot,toBuffer:tt,toString:K,write:at,writeDoubleLE:W,writeFloatLE:ct,writeUInt32LE:Lt,writeInt32LE:wt,readDoubleLE:ht,readFloatLE:p,readUInt32LE:i,readInt32LE:C}})(Zo,Zo.exports);var qo,$e;function Qs(){if($e)return qo;$e=1;var a=(l,h)=>function(){return h||(0,l[Object.keys(l)[0]])((h={exports:{}}).exports,h),h.exports},t=(()=>{for(var l=new Uint8Array(128),h=0;h<64;h++)l[h<26?h+65:h<52?h+71:h<62?h-4:h*4-205]=h;return r=>{for(var A=r.length,_=new Uint8Array((A-(r[A-1]=="=")-(r[A-2]=="="))*3/4|0),s=0,w=0;s<A;){var B=l[r.charCodeAt(s++)],b=l[r.charCodeAt(s++)],k=l[r.charCodeAt(s++)],D=l[r.charCodeAt(s++)];_[w++]=B<<2|b>>4,_[w++]=b<<4|k>>2,_[w++]=k<<6|D}return _}})(),n=a({"wasm-binary:./blake2b.wat"(l,h){h.exports=t("AGFzbQEAAAABEANgAn9/AGADf39/AGABfwADBQQAAQICBQUBAQroBwdNBQZtZW1vcnkCAAxibGFrZTJiX2luaXQAAA5ibGFrZTJiX3VwZGF0ZQABDWJsYWtlMmJfZmluYWwAAhBibGFrZTJiX2NvbXByZXNzAAMKvz8EwAIAIABCADcDACAAQgA3AwggAEIANwMQIABCADcDGCAAQgA3AyAgAEIANwMoIABCADcDMCAAQgA3AzggAEIANwNAIABCADcDSCAAQgA3A1AgAEIANwNYIABCADcDYCAAQgA3A2ggAEIANwNwIABCADcDeCAAQoiS853/zPmE6gBBACkDAIU3A4ABIABCu86qptjQ67O7f0EIKQMAhTcDiAEgAEKr8NP0r+68tzxBECkDAIU3A5ABIABC8e30+KWn/aelf0EYKQMAhTcDmAEgAELRhZrv+s+Uh9EAQSApAwCFNwOgASAAQp/Y+dnCkdqCm39BKCkDAIU3A6gBIABC6/qG2r+19sEfQTApAwCFNwOwASAAQvnC+JuRo7Pw2wBBOCkDAIU3A7gBIABCADcDwAEgAEIANwPIASAAQgA3A9ABC20BA38gAEHAAWohAyAAQcgBaiEEIAQpAwCnIQUCQANAIAEgAkYNASAFQYABRgRAIAMgAykDACAFrXw3AwBBACEFIAAQAwsgACAFaiABLQAAOgAAIAVBAWohBSABQQFqIQEMAAsLIAQgBa03AwALYQEDfyAAQcABaiEBIABByAFqIQIgASABKQMAIAIpAwB8NwMAIABCfzcD0AEgAikDAKchAwJAA0AgA0GAAUYNASAAIANqQQA6AAAgA0EBaiEDDAALCyACIAOtNwMAIAAQAwuqOwIgfgl/IABBgAFqISEgAEGIAWohIiAAQZABaiEjIABBmAFqISQgAEGgAWohJSAAQagBaiEmIABBsAFqIScgAEG4AWohKCAhKQMAIQEgIikDACECICMpAwAhAyAkKQMAIQQgJSkDACEFICYpAwAhBiAnKQMAIQcgKCkDACEIQoiS853/zPmE6gAhCUK7zqqm2NDrs7t/IQpCq/DT9K/uvLc8IQtC8e30+KWn/aelfyEMQtGFmu/6z5SH0QAhDUKf2PnZwpHagpt/IQ5C6/qG2r+19sEfIQ9C+cL4m5Gjs/DbACEQIAApAwAhESAAKQMIIRIgACkDECETIAApAxghFCAAKQMgIRUgACkDKCEWIAApAzAhFyAAKQM4IRggACkDQCEZIAApA0ghGiAAKQNQIRsgACkDWCEcIAApA2AhHSAAKQNoIR4gACkDcCEfIAApA3ghICANIAApA8ABhSENIA8gACkD0AGFIQ8gASAFIBF8fCEBIA0gAYVCIIohDSAJIA18IQkgBSAJhUIYiiEFIAEgBSASfHwhASANIAGFQhCKIQ0gCSANfCEJIAUgCYVCP4ohBSACIAYgE3x8IQIgDiAChUIgiiEOIAogDnwhCiAGIAqFQhiKIQYgAiAGIBR8fCECIA4gAoVCEIohDiAKIA58IQogBiAKhUI/iiEGIAMgByAVfHwhAyAPIAOFQiCKIQ8gCyAPfCELIAcgC4VCGIohByADIAcgFnx8IQMgDyADhUIQiiEPIAsgD3whCyAHIAuFQj+KIQcgBCAIIBd8fCEEIBAgBIVCIIohECAMIBB8IQwgCCAMhUIYiiEIIAQgCCAYfHwhBCAQIASFQhCKIRAgDCAQfCEMIAggDIVCP4ohCCABIAYgGXx8IQEgECABhUIgiiEQIAsgEHwhCyAGIAuFQhiKIQYgASAGIBp8fCEBIBAgAYVCEIohECALIBB8IQsgBiALhUI/iiEGIAIgByAbfHwhAiANIAKFQiCKIQ0gDCANfCEMIAcgDIVCGIohByACIAcgHHx8IQIgDSAChUIQiiENIAwgDXwhDCAHIAyFQj+KIQcgAyAIIB18fCEDIA4gA4VCIIohDiAJIA58IQkgCCAJhUIYiiEIIAMgCCAefHwhAyAOIAOFQhCKIQ4gCSAOfCEJIAggCYVCP4ohCCAEIAUgH3x8IQQgDyAEhUIgiiEPIAogD3whCiAFIAqFQhiKIQUgBCAFICB8fCEEIA8gBIVCEIohDyAKIA98IQogBSAKhUI/iiEFIAEgBSAffHwhASANIAGFQiCKIQ0gCSANfCEJIAUgCYVCGIohBSABIAUgG3x8IQEgDSABhUIQiiENIAkgDXwhCSAFIAmFQj+KIQUgAiAGIBV8fCECIA4gAoVCIIohDiAKIA58IQogBiAKhUIYiiEGIAIgBiAZfHwhAiAOIAKFQhCKIQ4gCiAOfCEKIAYgCoVCP4ohBiADIAcgGnx8IQMgDyADhUIgiiEPIAsgD3whCyAHIAuFQhiKIQcgAyAHICB8fCEDIA8gA4VCEIohDyALIA98IQsgByALhUI/iiEHIAQgCCAefHwhBCAQIASFQiCKIRAgDCAQfCEMIAggDIVCGIohCCAEIAggF3x8IQQgECAEhUIQiiEQIAwgEHwhDCAIIAyFQj+KIQggASAGIBJ8fCEBIBAgAYVCIIohECALIBB8IQsgBiALhUIYiiEGIAEgBiAdfHwhASAQIAGFQhCKIRAgCyAQfCELIAYgC4VCP4ohBiACIAcgEXx8IQIgDSAChUIgiiENIAwgDXwhDCAHIAyFQhiKIQcgAiAHIBN8fCECIA0gAoVCEIohDSAMIA18IQwgByAMhUI/iiEHIAMgCCAcfHwhAyAOIAOFQiCKIQ4gCSAOfCEJIAggCYVCGIohCCADIAggGHx8IQMgDiADhUIQiiEOIAkgDnwhCSAIIAmFQj+KIQggBCAFIBZ8fCEEIA8gBIVCIIohDyAKIA98IQogBSAKhUIYiiEFIAQgBSAUfHwhBCAPIASFQhCKIQ8gCiAPfCEKIAUgCoVCP4ohBSABIAUgHHx8IQEgDSABhUIgiiENIAkgDXwhCSAFIAmFQhiKIQUgASAFIBl8fCEBIA0gAYVCEIohDSAJIA18IQkgBSAJhUI/iiEFIAIgBiAdfHwhAiAOIAKFQiCKIQ4gCiAOfCEKIAYgCoVCGIohBiACIAYgEXx8IQIgDiAChUIQiiEOIAogDnwhCiAGIAqFQj+KIQYgAyAHIBZ8fCEDIA8gA4VCIIohDyALIA98IQsgByALhUIYiiEHIAMgByATfHwhAyAPIAOFQhCKIQ8gCyAPfCELIAcgC4VCP4ohByAEIAggIHx8IQQgECAEhUIgiiEQIAwgEHwhDCAIIAyFQhiKIQggBCAIIB58fCEEIBAgBIVCEIohECAMIBB8IQwgCCAMhUI/iiEIIAEgBiAbfHwhASAQIAGFQiCKIRAgCyAQfCELIAYgC4VCGIohBiABIAYgH3x8IQEgECABhUIQiiEQIAsgEHwhCyAGIAuFQj+KIQYgAiAHIBR8fCECIA0gAoVCIIohDSAMIA18IQwgByAMhUIYiiEHIAIgByAXfHwhAiANIAKFQhCKIQ0gDCANfCEMIAcgDIVCP4ohByADIAggGHx8IQMgDiADhUIgiiEOIAkgDnwhCSAIIAmFQhiKIQggAyAIIBJ8fCEDIA4gA4VCEIohDiAJIA58IQkgCCAJhUI/iiEIIAQgBSAafHwhBCAPIASFQiCKIQ8gCiAPfCEKIAUgCoVCGIohBSAEIAUgFXx8IQQgDyAEhUIQiiEPIAogD3whCiAFIAqFQj+KIQUgASAFIBh8fCEBIA0gAYVCIIohDSAJIA18IQkgBSAJhUIYiiEFIAEgBSAafHwhASANIAGFQhCKIQ0gCSANfCEJIAUgCYVCP4ohBSACIAYgFHx8IQIgDiAChUIgiiEOIAogDnwhCiAGIAqFQhiKIQYgAiAGIBJ8fCECIA4gAoVCEIohDiAKIA58IQogBiAKhUI/iiEGIAMgByAefHwhAyAPIAOFQiCKIQ8gCyAPfCELIAcgC4VCGIohByADIAcgHXx8IQMgDyADhUIQiiEPIAsgD3whCyAHIAuFQj+KIQcgBCAIIBx8fCEEIBAgBIVCIIohECAMIBB8IQwgCCAMhUIYiiEIIAQgCCAffHwhBCAQIASFQhCKIRAgDCAQfCEMIAggDIVCP4ohCCABIAYgE3x8IQEgECABhUIgiiEQIAsgEHwhCyAGIAuFQhiKIQYgASAGIBd8fCEBIBAgAYVCEIohECALIBB8IQsgBiALhUI/iiEGIAIgByAWfHwhAiANIAKFQiCKIQ0gDCANfCEMIAcgDIVCGIohByACIAcgG3x8IQIgDSAChUIQiiENIAwgDXwhDCAHIAyFQj+KIQcgAyAIIBV8fCEDIA4gA4VCIIohDiAJIA58IQkgCCAJhUIYiiEIIAMgCCARfHwhAyAOIAOFQhCKIQ4gCSAOfCEJIAggCYVCP4ohCCAEIAUgIHx8IQQgDyAEhUIgiiEPIAogD3whCiAFIAqFQhiKIQUgBCAFIBl8fCEEIA8gBIVCEIohDyAKIA98IQogBSAKhUI/iiEFIAEgBSAafHwhASANIAGFQiCKIQ0gCSANfCEJIAUgCYVCGIohBSABIAUgEXx8IQEgDSABhUIQiiENIAkgDXwhCSAFIAmFQj+KIQUgAiAGIBZ8fCECIA4gAoVCIIohDiAKIA58IQogBiAKhUIYiiEGIAIgBiAYfHwhAiAOIAKFQhCKIQ4gCiAOfCEKIAYgCoVCP4ohBiADIAcgE3x8IQMgDyADhUIgiiEPIAsgD3whCyAHIAuFQhiKIQcgAyAHIBV8fCEDIA8gA4VCEIohDyALIA98IQsgByALhUI/iiEHIAQgCCAbfHwhBCAQIASFQiCKIRAgDCAQfCEMIAggDIVCGIohCCAEIAggIHx8IQQgECAEhUIQiiEQIAwgEHwhDCAIIAyFQj+KIQggASAGIB98fCEBIBAgAYVCIIohECALIBB8IQsgBiALhUIYiiEGIAEgBiASfHwhASAQIAGFQhCKIRAgCyAQfCELIAYgC4VCP4ohBiACIAcgHHx8IQIgDSAChUIgiiENIAwgDXwhDCAHIAyFQhiKIQcgAiAHIB18fCECIA0gAoVCEIohDSAMIA18IQwgByAMhUI/iiEHIAMgCCAXfHwhAyAOIAOFQiCKIQ4gCSAOfCEJIAggCYVCGIohCCADIAggGXx8IQMgDiADhUIQiiEOIAkgDnwhCSAIIAmFQj+KIQggBCAFIBR8fCEEIA8gBIVCIIohDyAKIA98IQogBSAKhUIYiiEFIAQgBSAefHwhBCAPIASFQhCKIQ8gCiAPfCEKIAUgCoVCP4ohBSABIAUgE3x8IQEgDSABhUIgiiENIAkgDXwhCSAFIAmFQhiKIQUgASAFIB18fCEBIA0gAYVCEIohDSAJIA18IQkgBSAJhUI/iiEFIAIgBiAXfHwhAiAOIAKFQiCKIQ4gCiAOfCEKIAYgCoVCGIohBiACIAYgG3x8IQIgDiAChUIQiiEOIAogDnwhCiAGIAqFQj+KIQYgAyAHIBF8fCEDIA8gA4VCIIohDyALIA98IQsgByALhUIYiiEHIAMgByAcfHwhAyAPIAOFQhCKIQ8gCyAPfCELIAcgC4VCP4ohByAEIAggGXx8IQQgECAEhUIgiiEQIAwgEHwhDCAIIAyFQhiKIQggBCAIIBR8fCEEIBAgBIVCEIohECAMIBB8IQwgCCAMhUI/iiEIIAEgBiAVfHwhASAQIAGFQiCKIRAgCyAQfCELIAYgC4VCGIohBiABIAYgHnx8IQEgECABhUIQiiEQIAsgEHwhCyAGIAuFQj+KIQYgAiAHIBh8fCECIA0gAoVCIIohDSAMIA18IQwgByAMhUIYiiEHIAIgByAWfHwhAiANIAKFQhCKIQ0gDCANfCEMIAcgDIVCP4ohByADIAggIHx8IQMgDiADhUIgiiEOIAkgDnwhCSAIIAmFQhiKIQggAyAIIB98fCEDIA4gA4VCEIohDiAJIA58IQkgCCAJhUI/iiEIIAQgBSASfHwhBCAPIASFQiCKIQ8gCiAPfCEKIAUgCoVCGIohBSAEIAUgGnx8IQQgDyAEhUIQiiEPIAogD3whCiAFIAqFQj+KIQUgASAFIB18fCEBIA0gAYVCIIohDSAJIA18IQkgBSAJhUIYiiEFIAEgBSAWfHwhASANIAGFQhCKIQ0gCSANfCEJIAUgCYVCP4ohBSACIAYgEnx8IQIgDiAChUIgiiEOIAogDnwhCiAGIAqFQhiKIQYgAiAGICB8fCECIA4gAoVCEIohDiAKIA58IQogBiAKhUI/iiEGIAMgByAffHwhAyAPIAOFQiCKIQ8gCyAPfCELIAcgC4VCGIohByADIAcgHnx8IQMgDyADhUIQiiEPIAsgD3whCyAHIAuFQj+KIQcgBCAIIBV8fCEEIBAgBIVCIIohECAMIBB8IQwgCCAMhUIYiiEIIAQgCCAbfHwhBCAQIASFQhCKIRAgDCAQfCEMIAggDIVCP4ohCCABIAYgEXx8IQEgECABhUIgiiEQIAsgEHwhCyAGIAuFQhiKIQYgASAGIBh8fCEBIBAgAYVCEIohECALIBB8IQsgBiALhUI/iiEGIAIgByAXfHwhAiANIAKFQiCKIQ0gDCANfCEMIAcgDIVCGIohByACIAcgFHx8IQIgDSAChUIQiiENIAwgDXwhDCAHIAyFQj+KIQcgAyAIIBp8fCEDIA4gA4VCIIohDiAJIA58IQkgCCAJhUIYiiEIIAMgCCATfHwhAyAOIAOFQhCKIQ4gCSAOfCEJIAggCYVCP4ohCCAEIAUgGXx8IQQgDyAEhUIgiiEPIAogD3whCiAFIAqFQhiKIQUgBCAFIBx8fCEEIA8gBIVCEIohDyAKIA98IQogBSAKhUI/iiEFIAEgBSAefHwhASANIAGFQiCKIQ0gCSANfCEJIAUgCYVCGIohBSABIAUgHHx8IQEgDSABhUIQiiENIAkgDXwhCSAFIAmFQj+KIQUgAiAGIBh8fCECIA4gAoVCIIohDiAKIA58IQogBiAKhUIYiiEGIAIgBiAffHwhAiAOIAKFQhCKIQ4gCiAOfCEKIAYgCoVCP4ohBiADIAcgHXx8IQMgDyADhUIgiiEPIAsgD3whCyAHIAuFQhiKIQcgAyAHIBJ8fCEDIA8gA4VCEIohDyALIA98IQsgByALhUI/iiEHIAQgCCAUfHwhBCAQIASFQiCKIRAgDCAQfCEMIAggDIVCGIohCCAEIAggGnx8IQQgECAEhUIQiiEQIAwgEHwhDCAIIAyFQj+KIQggASAGIBZ8fCEBIBAgAYVCIIohECALIBB8IQsgBiALhUIYiiEGIAEgBiARfHwhASAQIAGFQhCKIRAgCyAQfCELIAYgC4VCP4ohBiACIAcgIHx8IQIgDSAChUIgiiENIAwgDXwhDCAHIAyFQhiKIQcgAiAHIBV8fCECIA0gAoVCEIohDSAMIA18IQwgByAMhUI/iiEHIAMgCCAZfHwhAyAOIAOFQiCKIQ4gCSAOfCEJIAggCYVCGIohCCADIAggF3x8IQMgDiADhUIQiiEOIAkgDnwhCSAIIAmFQj+KIQggBCAFIBN8fCEEIA8gBIVCIIohDyAKIA98IQogBSAKhUIYiiEFIAQgBSAbfHwhBCAPIASFQhCKIQ8gCiAPfCEKIAUgCoVCP4ohBSABIAUgF3x8IQEgDSABhUIgiiENIAkgDXwhCSAFIAmFQhiKIQUgASAFICB8fCEBIA0gAYVCEIohDSAJIA18IQkgBSAJhUI/iiEFIAIgBiAffHwhAiAOIAKFQiCKIQ4gCiAOfCEKIAYgCoVCGIohBiACIAYgGnx8IQIgDiAChUIQiiEOIAogDnwhCiAGIAqFQj+KIQYgAyAHIBx8fCEDIA8gA4VCIIohDyALIA98IQsgByALhUIYiiEHIAMgByAUfHwhAyAPIAOFQhCKIQ8gCyAPfCELIAcgC4VCP4ohByAEIAggEXx8IQQgECAEhUIgiiEQIAwgEHwhDCAIIAyFQhiKIQggBCAIIBl8fCEEIBAgBIVCEIohECAMIBB8IQwgCCAMhUI/iiEIIAEgBiAdfHwhASAQIAGFQiCKIRAgCyAQfCELIAYgC4VCGIohBiABIAYgE3x8IQEgECABhUIQiiEQIAsgEHwhCyAGIAuFQj+KIQYgAiAHIB58fCECIA0gAoVCIIohDSAMIA18IQwgByAMhUIYiiEHIAIgByAYfHwhAiANIAKFQhCKIQ0gDCANfCEMIAcgDIVCP4ohByADIAggEnx8IQMgDiADhUIgiiEOIAkgDnwhCSAIIAmFQhiKIQggAyAIIBV8fCEDIA4gA4VCEIohDiAJIA58IQkgCCAJhUI/iiEIIAQgBSAbfHwhBCAPIASFQiCKIQ8gCiAPfCEKIAUgCoVCGIohBSAEIAUgFnx8IQQgDyAEhUIQiiEPIAogD3whCiAFIAqFQj+KIQUgASAFIBt8fCEBIA0gAYVCIIohDSAJIA18IQkgBSAJhUIYiiEFIAEgBSATfHwhASANIAGFQhCKIQ0gCSANfCEJIAUgCYVCP4ohBSACIAYgGXx8IQIgDiAChUIgiiEOIAogDnwhCiAGIAqFQhiKIQYgAiAGIBV8fCECIA4gAoVCEIohDiAKIA58IQogBiAKhUI/iiEGIAMgByAYfHwhAyAPIAOFQiCKIQ8gCyAPfCELIAcgC4VCGIohByADIAcgF3x8IQMgDyADhUIQiiEPIAsgD3whCyAHIAuFQj+KIQcgBCAIIBJ8fCEEIBAgBIVCIIohECAMIBB8IQwgCCAMhUIYiiEIIAQgCCAWfHwhBCAQIASFQhCKIRAgDCAQfCEMIAggDIVCP4ohCCABIAYgIHx8IQEgECABhUIgiiEQIAsgEHwhCyAGIAuFQhiKIQYgASAGIBx8fCEBIBAgAYVCEIohECALIBB8IQsgBiALhUI/iiEGIAIgByAafHwhAiANIAKFQiCKIQ0gDCANfCEMIAcgDIVCGIohByACIAcgH3x8IQIgDSAChUIQiiENIAwgDXwhDCAHIAyFQj+KIQcgAyAIIBR8fCEDIA4gA4VCIIohDiAJIA58IQkgCCAJhUIYiiEIIAMgCCAdfHwhAyAOIAOFQhCKIQ4gCSAOfCEJIAggCYVCP4ohCCAEIAUgHnx8IQQgDyAEhUIgiiEPIAogD3whCiAFIAqFQhiKIQUgBCAFIBF8fCEEIA8gBIVCEIohDyAKIA98IQogBSAKhUI/iiEFIAEgBSARfHwhASANIAGFQiCKIQ0gCSANfCEJIAUgCYVCGIohBSABIAUgEnx8IQEgDSABhUIQiiENIAkgDXwhCSAFIAmFQj+KIQUgAiAGIBN8fCECIA4gAoVCIIohDiAKIA58IQogBiAKhUIYiiEGIAIgBiAUfHwhAiAOIAKFQhCKIQ4gCiAOfCEKIAYgCoVCP4ohBiADIAcgFXx8IQMgDyADhUIgiiEPIAsgD3whCyAHIAuFQhiKIQcgAyAHIBZ8fCEDIA8gA4VCEIohDyALIA98IQsgByALhUI/iiEHIAQgCCAXfHwhBCAQIASFQiCKIRAgDCAQfCEMIAggDIVCGIohCCAEIAggGHx8IQQgECAEhUIQiiEQIAwgEHwhDCAIIAyFQj+KIQggASAGIBl8fCEBIBAgAYVCIIohECALIBB8IQsgBiALhUIYiiEGIAEgBiAafHwhASAQIAGFQhCKIRAgCyAQfCELIAYgC4VCP4ohBiACIAcgG3x8IQIgDSAChUIgiiENIAwgDXwhDCAHIAyFQhiKIQcgAiAHIBx8fCECIA0gAoVCEIohDSAMIA18IQwgByAMhUI/iiEHIAMgCCAdfHwhAyAOIAOFQiCKIQ4gCSAOfCEJIAggCYVCGIohCCADIAggHnx8IQMgDiADhUIQiiEOIAkgDnwhCSAIIAmFQj+KIQggBCAFIB98fCEEIA8gBIVCIIohDyAKIA98IQogBSAKhUIYiiEFIAQgBSAgfHwhBCAPIASFQhCKIQ8gCiAPfCEKIAUgCoVCP4ohBSABIAUgH3x8IQEgDSABhUIgiiENIAkgDXwhCSAFIAmFQhiKIQUgASAFIBt8fCEBIA0gAYVCEIohDSAJIA18IQkgBSAJhUI/iiEFIAIgBiAVfHwhAiAOIAKFQiCKIQ4gCiAOfCEKIAYgCoVCGIohBiACIAYgGXx8IQIgDiAChUIQiiEOIAogDnwhCiAGIAqFQj+KIQYgAyAHIBp8fCEDIA8gA4VCIIohDyALIA98IQsgByALhUIYiiEHIAMgByAgfHwhAyAPIAOFQhCKIQ8gCyAPfCELIAcgC4VCP4ohByAEIAggHnx8IQQgECAEhUIgiiEQIAwgEHwhDCAIIAyFQhiKIQggBCAIIBd8fCEEIBAgBIVCEIohECAMIBB8IQwgCCAMhUI/iiEIIAEgBiASfHwhASAQIAGFQiCKIRAgCyAQfCELIAYgC4VCGIohBiABIAYgHXx8IQEgECABhUIQiiEQIAsgEHwhCyAGIAuFQj+KIQYgAiAHIBF8fCECIA0gAoVCIIohDSAMIA18IQwgByAMhUIYiiEHIAIgByATfHwhAiANIAKFQhCKIQ0gDCANfCEMIAcgDIVCP4ohByADIAggHHx8IQMgDiADhUIgiiEOIAkgDnwhCSAIIAmFQhiKIQggAyAIIBh8fCEDIA4gA4VCEIohDiAJIA58IQkgCCAJhUI/iiEIIAQgBSAWfHwhBCAPIASFQiCKIQ8gCiAPfCEKIAUgCoVCGIohBSAEIAUgFHx8IQQgDyAEhUIQiiEPIAogD3whCiAFIAqFQj+KIQUgISAhKQMAIAEgCYWFNwMAICIgIikDACACIAqFhTcDACAjICMpAwAgAyALhYU3AwAgJCAkKQMAIAQgDIWFNwMAICUgJSkDACAFIA2FhTcDACAmICYpAwAgBiAOhYU3AwAgJyAnKQMAIAcgD4WFNwMAICggKCkDACAIIBCFhTcDAAs=")}}),o=n(),e=WebAssembly.compile(o);return qo=async l=>(await WebAssembly.instantiate(await e,l)).exports,qo}var Jt=bs,Ms=Zo.exports,hn=null,je=typeof WebAssembly<"u"&&Qs()().then(a=>{hn=a}),un=64,_o=[];pn.exports=$t;var Ye=pn.exports.BYTES_MIN=16,Ze=pn.exports.BYTES_MAX=64;pn.exports.BYTES=32;var We=pn.exports.KEYBYTES_MIN=16,Je=pn.exports.KEYBYTES_MAX=64;pn.exports.KEYBYTES=32;var Xe=pn.exports.SALTBYTES=16,ti=pn.exports.PERSONALBYTES=16;function $t(a,t,n,o,e){if(!(this instanceof $t))return new $t(a,t,n,o,e);if(!hn)throw new Error("WASM not loaded. Wait for Blake2b.ready(cb)");a||(a=32),e!==!0&&(Jt(a>=Ye,"digestLength must be at least "+Ye+", was given "+a),Jt(a<=Ze,"digestLength must be at most "+Ze+", was given "+a),t!=null&&(Jt(t instanceof Uint8Array,"key must be Uint8Array or Buffer"),Jt(t.length>=We,"key must be at least "+We+", was given "+t.length),Jt(t.length<=Je,"key must be at least "+Je+", was given "+t.length)),n!=null&&(Jt(n instanceof Uint8Array,"salt must be Uint8Array or Buffer"),Jt(n.length===Xe,"salt must be exactly "+Xe+", was given "+n.length)),o!=null&&(Jt(o instanceof Uint8Array,"personal must be Uint8Array or Buffer"),Jt(o.length===ti,"personal must be exactly "+ti+", was given "+o.length))),_o.length||(_o.push(un),un+=216),this.digestLength=a,this.finalized=!1,this.pointer=_o.pop(),this._memory=new Uint8Array(hn.memory.buffer),this._memory.fill(0,0,64),this._memory[0]=this.digestLength,this._memory[1]=t?t.length:0,this._memory[2]=1,this._memory[3]=1,n&&this._memory.set(n,32),o&&this._memory.set(o,48),this.pointer+216>this._memory.length&&this._realloc(this.pointer+216),hn.blake2b_init(this.pointer,this.digestLength),t&&(this.update(t),this._memory.fill(0,un,un+t.length),this._memory[this.pointer+200]=128)}$t.prototype._realloc=function(a){hn.memory.grow(Math.max(0,Math.ceil(Math.abs(a-this._memory.length)/65536))),this._memory=new Uint8Array(hn.memory.buffer)};$t.prototype.update=function(a){return Jt(this.finalized===!1,"Hash instance finalized"),Jt(a instanceof Uint8Array,"input must be Uint8Array or Buffer"),un+a.length>this._memory.length&&this._realloc(un+a.length),this._memory.set(a,un),hn.blake2b_update(this.pointer,un,un+a.length),this};$t.prototype.digest=function(a){if(Jt(this.finalized===!1,"Hash instance finalized"),this.finalized=!0,_o.push(this.pointer),hn.blake2b_final(this.pointer),!a||a==="binary")return this._memory.slice(this.pointer+128,this.pointer+128+this.digestLength);if(typeof a=="string")return Ms.toString(this._memory,a,this.pointer+128,this.pointer+128+this.digestLength);Jt(a instanceof Uint8Array&&a.length>=this.digestLength,"input must be Uint8Array or Buffer");for(var t=0;t<this.digestLength;t++)a[t]=this._memory[this.pointer+128+t];return a};$t.prototype.final=$t.prototype.digest;$t.WASM=hn;$t.SUPPORTED=typeof WebAssembly<"u";$t.ready=function(a){return a||(a=qs),je?je.then(()=>a(),a):a(new Error("WebAssembly not supported"))};$t.prototype.ready=$t.ready;$t.prototype.getPartialHash=function(){return this._memory.slice(this.pointer,this.pointer+216)};$t.prototype.setPartialHash=function(a){this._memory.set(a,this.pointer)};function qs(){}function Co(a){return(a&4294901760?(a&=4294901760,16):0)|(a&4278255360?(a&=4278255360,8):0)|(a&4042322160?(a&=4042322160,4):0)|(a&3435973836?(a&=3435973836,2):0)|(a&2863311530)!==0}const Us=1,zs=2,sa=10,Ts=2;async function nn(a,t,n){const o=await a.read(t.G1.F.n8*2),e=t.G1.fromRprLEM(o,0);return n?t.G1.toObject(e):e}async function Jn(a,t,n){const o=await a.read(t.G2.F.n8*2),e=t.G2.fromRprLEM(o,0);return n?t.G2.toObject(e):e}async function ks(a,t,n,o){await io(a,t,1);const e=await a.readULE32();if(await ao(a),e===Us)return await Ds(a,t,n,o);if(e===zs)return await Gs(a,t,n,o);if(e===sa)return await Rs(a,t,n,o);throw new Error("Protocol not supported: ")}async function Ds(a,t,n,o){const e={};e.protocol="groth16",await io(a,t,2);const l=await a.readULE32();e.n8q=l,e.q=await Pn(a,l);const h=await a.readULE32();return e.n8r=h,e.r=await Pn(a,h),e.curve=await _e(e.q,o),e.nVars=await a.readULE32(),e.nPublic=await a.readULE32(),e.domainSize=await a.readULE32(),e.power=Co(e.domainSize),e.vk_alpha_1=await nn(a,e.curve,n),e.vk_beta_1=await nn(a,e.curve,n),e.vk_beta_2=await Jn(a,e.curve,n),e.vk_gamma_2=await Jn(a,e.curve,n),e.vk_delta_1=await nn(a,e.curve,n),e.vk_delta_2=await Jn(a,e.curve,n),await ao(a),e}async function Gs(a,t,n,o){const e={};e.protocol="plonk",await io(a,t,2);const l=await a.readULE32();e.n8q=l,e.q=await Pn(a,l);const h=await a.readULE32();return e.n8r=h,e.r=await Pn(a,h),e.curve=await _e(e.q,o),e.nVars=await a.readULE32(),e.nPublic=await a.readULE32(),e.domainSize=await a.readULE32(),e.power=Co(e.domainSize),e.nAdditions=await a.readULE32(),e.nConstraints=await a.readULE32(),e.k1=await a.read(h),e.k2=await a.read(h),e.Qm=await nn(a,e.curve,n),e.Ql=await nn(a,e.curve,n),e.Qr=await nn(a,e.curve,n),e.Qo=await nn(a,e.curve,n),e.Qc=await nn(a,e.curve,n),e.S1=await nn(a,e.curve,n),e.S2=await nn(a,e.curve,n),e.S3=await nn(a,e.curve,n),e.X_2=await Jn(a,e.curve,n),await ao(a),e}async function Rs(a,t,n,o){const e={};e.protocol="fflonk",e.protocolId=sa,await io(a,t,Ts);const l=await a.readULE32();e.n8q=l,e.q=await Pn(a,l),e.curve=await _e(e.q,o);const h=await a.readULE32();return e.n8r=h,e.r=await Pn(a,h),e.nVars=await a.readULE32(),e.nPublic=await a.readULE32(),e.domainSize=await a.readULE32(),e.power=Co(e.domainSize),e.nAdditions=await a.readULE32(),e.nConstraints=await a.readULE32(),e.k1=await a.read(h),e.k2=await a.read(h),e.w3=await a.read(h),e.w4=await a.read(h),e.w8=await a.read(h),e.wr=await a.read(h),e.X_2=await Jn(a,e.curve,n),e.C0=await nn(a,e.curve,n),await ao(a),e}async function Ns(a,t,n){await Ke(a,1);const o=(Math.floor((Qt.bitLength(n)-1)/64)+1)*8;if(await a.writeULE32(o),await fs(a,n,o),t.byteLength%o!=0)throw new Error("Invalid witness length");await a.writeULE32(t.byteLength/o),await He(a),await Ke(a,2),await a.write(t),await He(a)}async function Ks(a,t){await io(a,t,1);const n=await a.readULE32(),o=await Pn(a,n),e=await a.readULE32();return await ao(a),{n8:n,q:o,nWitness:e}}const{stringifyBigInts:ni}=Nt;async function la(a,t,n,o){const{fd:e,sections:l}=await Ne(t,"wtns",2),h=await Ks(e,l),{fd:r,sections:A}=await Ne(a,"zkey",2),_=await ks(r,A,void 0,o);if(_.protocol!="groth16")throw new Error("zkey file is not groth16");if(!Qt.eq(_.r,h.q))throw new Error("Curve of the witness does not match the curve of the proving key");if(h.nWitness!=_.nVars)throw new Error(`Invalid witness length. Circuit: ${_.nVars}, witness: ${h.nWitness}`);const s=_.curve,w=s.Fr,B=s.G1,b=s.G2,k=Co(_.domainSize);n&&n.debug("Reading Wtns");const D=await En(e,l,2);n&&n.debug("Reading Coeffs");const F=await En(r,A,4);n&&n.debug("Building ABC");const[q,x,it]=await Hs(s,_,D,F,n),z=k==w.s?s.Fr.shift:s.Fr.w[k+1],lt=await w.ifft(q,"","",n,"IFFT_A"),E=await w.batchApplyKey(lt,w.e(1),z),u=await w.fft(E,"","",n,"FFT_A"),L=await w.ifft(x,"","",n,"IFFT_B"),V=await w.batchApplyKey(L,w.e(1),z),j=await w.fft(V,"","",n,"FFT_B"),X=await w.ifft(it,"","",n,"IFFT_C"),P=await w.batchApplyKey(X,w.e(1),z),I=await w.fft(P,"","",n,"FFT_C");n&&n.debug("Join ABC");const v=await Vs(s,_,u,j,I,n);let T={};n&&n.debug("Reading A Points");const ot=await En(r,A,5);T.pi_a=await s.G1.multiExpAffine(ot,D,n,"multiexp A"),n&&n.debug("Reading B1 Points");const tt=await En(r,A,6);let K=await s.G1.multiExpAffine(tt,D,n,"multiexp B1");n&&n.debug("Reading B2 Points");const at=await En(r,A,7);T.pi_b=await s.G2.multiExpAffine(at,D,n,"multiexp B2"),n&&n.debug("Reading C Points");const W=await En(r,A,8);T.pi_c=await s.G1.multiExpAffine(W,D.slice((_.nPublic+1)*s.Fr.n8),n,"multiexp C"),n&&n.debug("Reading H Points");const ct=await En(r,A,9),Lt=await s.G1.multiExpAffine(ct,v,n,"multiexp H"),wt=s.Fr.random(),ht=s.Fr.random();T.pi_a=B.add(T.pi_a,_.vk_alpha_1),T.pi_a=B.add(T.pi_a,B.timesFr(_.vk_delta_1,wt)),T.pi_b=b.add(T.pi_b,_.vk_beta_2),T.pi_b=b.add(T.pi_b,b.timesFr(_.vk_delta_2,ht)),K=B.add(K,_.vk_beta_1),K=B.add(K,B.timesFr(_.vk_delta_1,ht)),T.pi_c=B.add(T.pi_c,Lt),T.pi_c=B.add(T.pi_c,B.timesFr(T.pi_a,ht)),T.pi_c=B.add(T.pi_c,B.timesFr(K,wt)),T.pi_c=B.add(T.pi_c,B.timesFr(_.vk_delta_1,w.neg(w.mul(wt,ht))));let p=[];for(let i=1;i<=_.nPublic;i++){const C=D.slice(i*w.n8,i*w.n8+w.n8);p.push(Qt.fromRprLE(C))}return T.pi_a=B.toObject(B.toAffine(T.pi_a)),T.pi_b=b.toObject(b.toAffine(T.pi_b)),T.pi_c=B.toObject(B.toAffine(T.pi_c)),T.protocol="groth16",T.curve=s.name,await r.close(),await e.close(),T=ni(T),p=ni(p),{proof:T,publicSignals:p}}async function Hs(a,t,n,o,e){const l=a.Fr.n8,h=4*3+t.n8r,r=(o.byteLength-4)/h,A=new Pt(t.domainSize*l),_=new Pt(t.domainSize*l),s=new Pt(t.domainSize*l),w=[A,_];for(let B=0;B<r;B++){e&&B%1e6==0&&e.debug(`QAP AB: ${B}/${r}`);const b=o.slice(4+B*h,4+B*h+h),k=new DataView(b.buffer),D=k.getUint32(0,!0),F=k.getUint32(4,!0),q=k.getUint32(8,!0),x=b.slice(12,12+l);w[D].set(a.Fr.add(w[D].slice(F*l,F*l+l),a.Fr.mul(x,n.slice(q*l,q*l+l))),F*l)}for(let B=0;B<t.domainSize;B++)e&&B%1e6==0&&e.debug(`QAP C: ${B}/${t.domainSize}`),s.set(a.Fr.mul(A.slice(B*l,B*l+l),_.slice(B*l,B*l+l)),B*l);return[A,_,s]}async function Vs(a,t,n,o,e,l){const r=a.Fr.n8,A=Math.floor(n.byteLength/a.Fr.n8),_=[];for(let b=0;b<A;b+=4194304){l&&l.debug(`JoinABC: ${b}/${A}`);const k=Math.min(A-b,4194304),D=[],F=n.slice(b*r,(b+k)*r),q=o.slice(b*r,(b+k)*r),x=e.slice(b*r,(b+k)*r);D.push({cmd:"ALLOCSET",var:0,buff:F}),D.push({cmd:"ALLOCSET",var:1,buff:q}),D.push({cmd:"ALLOCSET",var:2,buff:x}),D.push({cmd:"ALLOC",var:3,len:k*r}),D.push({cmd:"CALL",fnName:"qap_joinABC",params:[{var:0},{var:1},{var:2},{val:k},{var:3}]}),D.push({cmd:"CALL",fnName:"frm_batchFromMontgomery",params:[{var:3},{val:k},{var:3}]}),D.push({cmd:"GET",out:0,var:3,len:k*r}),_.push(a.tm.queueAction(D))}const s=await Promise.all(_);let w;n instanceof Pt?w=new Pt(n.byteLength):w=new Uint8Array(n.byteLength);let B=0;for(let b=0;b<s.length;b++)w.set(s[b][0],B),B+=s[b][0].byteLength;return w}function ra(a){let t=[];return n(t,a),t;function n(o,e){if(Array.isArray(e))for(let l=0;l<e.length;l++)n(o,e[l]);else o.push(e)}}function $s(a,t){let n=BigInt(a)%t;return n<0&&(n+=t),n}function da(a){const t=BigInt(2)**BigInt(64);let n=BigInt("0xCBF29CE484222325");for(let l=0;l<a.length;l++)n^=BigInt(a[l].charCodeAt(0)),n*=BigInt(1099511628211),n%=t;let o=n.toString(16),e=16-o.length;return o="0".repeat(e).concat(o),o}function js(a,t){const n=[];let o=BigInt(a);const e=BigInt(4294967296);for(;o;)n.unshift(Number(o%e)),o=o/e;if(t){let l=t-n.length;for(;l>0;)n.unshift(0),l--}return n}async function Ys(a,t){let n,o,e;t=t||{};let l=1,h=0,r=0,A=!1;if(a instanceof WebAssembly.Instance)n=a,A=!0;else{let B=32767;if(t.memorySize&&(B=parseInt(t.memorySize),B<0))throw new Error("Invalid memory size");let b=!1;for(;!b;)try{e=new WebAssembly.Memory({initial:B}),b=!0}catch(q){if(B<=1)throw q;console.warn("Could not allocate "+B*1024*64+" bytes. This may cause severe instability. Trying with "+B*1024*64/2+" bytes"),B=Math.floor(B/2)}const k=await WebAssembly.compile(a);let D="",F="";n=await WebAssembly.instantiate(k,{env:{memory:e},runtime:{printDebug:function(q){console.log("printDebug:",q)},exceptionHandler:function(q){let x;throw q===1?x="Signal not found. ":q===2?x="Too many signals set. ":q===3?x="Signal already set. ":q===4?x="Assert Failed. ":q===5?x="Not enough memory. ":q===6?x="Input signal array access exceeds the size. ":x="Unknown error. ",console.error("ERROR: ",q,D),new Error(x+D)},printErrorMessage:function(){D+=s()+`
`},writeBufferMessage:function(){const q=s();q===`
`?(console.log(F),F=""):(F!==""&&(F+=" "),F+=q)},showSharedRWMemory:function(){const q=n.exports.getFieldNumLen32(),x=new Uint32Array(q);for(let it=0;it<q;it++)x[q-1-it]=n.exports.readSharedRWMemory(it);if(l>=2&&(h>=1||r>=7)){F!==""&&(F+=" ");const it=Qt.fromArray(x,4294967296).toString();F+=it}else console.log(Qt.fromArray(x,4294967296))},error:function(q,x,it,z,lt,E){let u;throw q===7?u=w(x)+" "+o.getFr(z).toString()+" != "+o.getFr(lt).toString()+" "+w(E):q===9?u=w(x)+" "+o.getFr(z).toString()+" "+w(lt):q===5&&t.sym?u=w(x)+" "+t.sym.labelIdx2Name[lt]:u=w(x)+" "+it+" "+z+" "+lt+" "+E,console.log("ERROR: ",q,u),new Error(u)},log:function(q){console.log(o.getFr(q).toString())},logGetSignal:function(q,x){t.logGetSignal&&t.logGetSignal(q,o.getFr(x))},logSetSignal:function(q,x){t.logSetSignal&&t.logSetSignal(q,o.getFr(x))},logStartComponent:function(q){t.logStartComponent&&t.logStartComponent(q)},logFinishComponent:function(q){t.logFinishComponent&&t.logFinishComponent(q)}}})}typeof n.exports.getVersion=="function"&&(l=n.exports.getVersion()),typeof n.exports.getMinorVersion=="function"&&(h=n.exports.getMinorVersion()),typeof n.exports.getPatchVersion=="function"&&(r=n.exports.getPatchVersion());const _=t&&(t.sanityCheck||t.logGetSignal||t.logSetSignal||t.logStartComponent||t.logFinishComponent);if(l===2)o=new Ws(n,_);else if(l===1){if(A)throw new Error("Loading code from WebAssembly instance is not supported for circom version 1");o=new Zs(e,n,_)}else throw new Error(`Unsupported circom version: ${l}`);return o;function s(){let B="",b=n.exports.getMessageChar();for(;b!==0;)B+=String.fromCharCode(b),b=n.exports.getMessageChar();return B}function w(B){const b=new Uint8Array(e.buffer),k=[];for(let D=0;b[B+D]>0;D++)k.push(b[B+D]);return String.fromCharCode.apply(null,k)}}class Zs{constructor(t,n,o){this.memory=t,this.i32=new Uint32Array(t.buffer),this.instance=n,this.n32=(this.instance.exports.getFrLen()>>2)-2;const e=this.instance.exports.getPRawPrime(),l=new Array(this.n32);for(let h=0;h<this.n32;h++)l[this.n32-1-h]=this.i32[(e>>2)+h];this.prime=Qt.fromArray(l,4294967296),this.Fr=new Za(this.prime),this.mask32=Qt.fromString("FFFFFFFF",16),this.NVars=this.instance.exports.getNVars(),this.n64=Math.floor((this.Fr.bitLength-1)/64)+1,this.R=this.Fr.e(Qt.shiftLeft(1,this.n64*64)),this.RInv=this.Fr.inv(this.R),this.sanityCheck=o}circom_version(){return 1}async _doCalculateWitness(t,n){this.instance.exports.init(this.sanityCheck||n?1:0);const o=this.allocInt(),e=this.allocFr();Object.keys(t).forEach(h=>{const r=da(h),A=parseInt(r.slice(0,8),16),_=parseInt(r.slice(8,16),16);try{this.instance.exports.getSignalOffset32(o,0,A,_)}catch{throw new Error(`Signal ${h} is not an input of the circuit.`)}const s=this.getInt(o),w=ra(t[h]);for(let B=0;B<w.length;B++)this.setFr(e,w[B]),this.instance.exports.setSignal(0,0,s+B,e)})}async calculateWitness(t,n){const o=this,e=o.i32[0],l=[];await o._doCalculateWitness(t,n);for(let h=0;h<o.NVars;h++){const r=o.instance.exports.getPWitness(h);l.push(o.getFr(r))}return o.i32[0]=e,l}async calculateBinWitness(t,n){const o=this,e=o.i32[0];await o._doCalculateWitness(t,n);const l=o.instance.exports.getWitnessBuffer();o.i32[0]=e;const h=o.memory.buffer.slice(l,l+o.NVars*o.n64*8);return new Uint8Array(h)}allocInt(){const t=this.i32[0];return this.i32[0]=t+8,t}allocFr(){const t=this.i32[0];return this.i32[0]=t+this.n32*4+8,t}getInt(t){return this.i32[t>>2]}setInt(t,n){this.i32[t>>2]=n}getFr(t){const n=this,o=t>>2;if(n.i32[o+1]&2147483648){const l=new Array(n.n32);for(let r=0;r<n.n32;r++)l[n.n32-1-r]=n.i32[o+2+r];const h=n.Fr.e(Qt.fromArray(l,4294967296));return n.i32[o+1]&1073741824?e(h):h}else return n.i32[o]&2147483648?n.Fr.e(n.i32[o]-4294967296):n.Fr.e(n.i32[o]);function e(l){return n.Fr.mul(n.RInv,l)}}setFr(t,n){const o=this;n=o.Fr.e(n);const e=o.Fr.neg(o.Fr.e("80000000",16)),l=o.Fr.e("7FFFFFFF",16);if(o.Fr.geq(n,e)&&o.Fr.leq(n,l)){let r;o.Fr.geq(n,o.Fr.zero)?r=Qt.toNumber(n):(r=Qt.toNumber(o.Fr.sub(n,e)),r=r-2147483648,r=4294967296+r),o.i32[t>>2]=r,o.i32[(t>>2)+1]=0;return}o.i32[t>>2]=0,o.i32[(t>>2)+1]=2147483648;const h=Qt.toArray(n,4294967296);for(let r=0;r<o.n32;r++){const A=h.length-1-r;A>=0?o.i32[(t>>2)+2+r]=h[A]:o.i32[(t>>2)+2+r]=0}}}class Ws{constructor(t,n){this.instance=t,this.version=this.instance.exports.getVersion(),this.n32=this.instance.exports.getFieldNumLen32(),this.instance.exports.getRawPrime();const o=new Uint32Array(this.n32);for(let e=0;e<this.n32;e++)o[this.n32-1-e]=this.instance.exports.readSharedRWMemory(e);this.prime=Qt.fromArray(o,4294967296),this.witnessSize=this.instance.exports.getWitnessSize(),this.sanityCheck=n}circom_version(){return this.instance.exports.getVersion()}async _doCalculateWitness(t,n){this.instance.exports.init(this.sanityCheck||n?1:0);const o=Object.keys(t);let e=0;if(o.forEach(l=>{const h=da(l),r=parseInt(h.slice(0,8),16),A=parseInt(h.slice(8,16),16),_=ra(t[l]);if(typeof this.instance.exports.getInputSignalSize=="function"){let s=this.instance.exports.getInputSignalSize(r,A);if(s<0)throw new Error(`Signal ${l} not found
`);if(_.length<s)throw new Error(`Not enough values for input signal ${l}
`);if(_.length>s)throw new Error(`Too many values for input signal ${l}
`)}for(let s=0;s<_.length;s++){const w=js($s(_[s],this.prime),this.n32);for(let B=0;B<this.n32;B++)this.instance.exports.writeSharedRWMemory(B,w[this.n32-1-B]);try{this.instance.exports.setInputSignal(r,A,s),e++}catch(B){throw new Error(B)}}}),e<this.instance.exports.getInputSize())throw new Error(`Not all inputs have been set. Only ${e} out of ${this.instance.exports.getInputSize()}`)}async calculateWitness(t,n){const o=[];await this._doCalculateWitness(t,n);for(let e=0;e<this.witnessSize;e++){this.instance.exports.getWitness(e);const l=new Uint32Array(this.n32);for(let h=0;h<this.n32;h++)l[this.n32-1-h]=this.instance.exports.readSharedRWMemory(h);o.push(Qt.fromArray(l,4294967296))}return o}async calculateWTNSBin(t,n){const o=new Uint32Array(this.witnessSize*this.n32+this.n32+11),e=new Uint8Array(o.buffer);await this._doCalculateWitness(t,n),e[0]=119,e[1]=116,e[2]=110,e[3]=115,o[1]=2,o[2]=2,o[3]=1;const l=this.n32*4,r=(8+l).toString(16);o[4]=parseInt(r.slice(0,8),16),o[5]=parseInt(r.slice(8,16),16),o[6]=l,this.instance.exports.getRawPrime();let A=7;for(let w=0;w<this.n32;w++)o[A+w]=this.instance.exports.readSharedRWMemory(w);A+=this.n32,o[A]=this.witnessSize,A++,o[A]=2,A++;const s=(l*this.witnessSize).toString(16);o[A]=parseInt(s.slice(0,8),16),o[A+1]=parseInt(s.slice(8,16),16),A+=2;for(let w=0;w<this.witnessSize;w++){this.instance.exports.getWitness(w);for(let B=0;B<this.n32;B++)o[A+B]=this.instance.exports.readSharedRWMemory(B);A+=this.n32}return e}}const{unstringifyBigInts:Js}=Nt;async function Xs(a,t,n,o){const e=Js(a),l=await ta(t),h=await l.read(l.totalSize);await l.close();const r=await Ys(h,o);if(r.circom_version()===1){const A=await r.calculateBinWitness(e),_=await us(n,"wtns",2,2);await Ns(_,A,r.prime),await _.close()}else{const A=await Xi(n),_=await r.calculateWTNSBin(e);await A.write(_),await A.close()}}const{unstringifyBigInts:tl}=Nt;async function nl(a,t,n,o,e,l){const h=tl(a),r={type:"mem"};return await Xs(h,t,r,e),await la(n,r,o,l)}const{unstringifyBigInts:Uo}=Nt;async function ol(a,t,n,o){const e=Uo(a),l=Uo(n),h=Uo(t),r=await Ls(e.curve),A=r.G1.fromObject(e.IC[0]),_=new Uint8Array(r.G1.F.n8*2*h.length),s=new Uint8Array(r.Fr.n8*h.length);if(!il(r,h))return o&&o.error("Public inputs are not valid."),!1;for(let z=0;z<h.length;z++){const lt=r.G1.fromObject(e.IC[z+1]);_.set(lt,z*r.G1.F.n8*2),Qt.toRprLE(s,r.Fr.n8*z,h[z],r.Fr.n8)}let w=await r.G1.multiExpAffine(_,s);w=r.G1.add(w,A);const B=r.G1.fromObject(l.pi_a),b=r.G2.fromObject(l.pi_b),k=r.G1.fromObject(l.pi_c);if(!el(r,{pi_a:B,pi_b:b,pi_c:k}))return o&&o.error("Proof commitments are not valid."),!1;const D=r.G2.fromObject(e.vk_gamma_2),F=r.G2.fromObject(e.vk_delta_2),q=r.G1.fromObject(e.vk_alpha_1),x=r.G2.fromObject(e.vk_beta_2);return await r.pairingEq(r.G1.neg(B),b,w,D,k,F,q,x)?(o&&o.info("OK!"),!0):(o&&o.error("Invalid proof"),!1)}function el(a,t){const n=a.G1,o=a.G2;return n.isValid(t.pi_a)&&o.isValid(t.pi_b)&&n.isValid(t.pi_c)}function il(a,t){for(let n=0;n<t.length;n++)if(!Qt.lt(t[n],a.r))return!1;return!0}const{unstringifyBigInts:oi}=Nt;function gn(a){let t=a.toString(16);for(;t.length<64;)t="0"+t;return t=`"0x${t}"`,t}async function al(a,t){const n=oi(a),o=oi(t);let e="";for(let h=0;h<o.length;h++)e!=""&&(e=e+","),e=e+gn(o[h]);let l;return l=`[${gn(n.pi_a[0])}, ${gn(n.pi_a[1])}],[[${gn(n.pi_b[0][1])}, ${gn(n.pi_b[0][0])}],[${gn(n.pi_b[1][1])}, ${gn(n.pi_b[1][0])}]],[${gn(n.pi_c[0])}, ${gn(n.pi_c[1])}],[${e}]`,l}var cl=Object.freeze({__proto__:null,fullProve:nl,prove:la,verify:ol,exportSolidityCallData:al});Qt.e("73eda753299d7d483339d80809a1d80553bda402fffe5bfeffffffff00000001",16);Qt.e("21888242871839275222246405745257275088548364400416034343698204186575808495617");const{unstringifyBigInts:Bl}=Nt,{stringifyBigInts:El}=Nt,{unstringifyBigInts:Fl,stringifyBigInts:xl}=Nt;var _a={exports:{}};/**
 * [js-sha3]{@link https://github.com/emn178/js-sha3}
 *
 * @version 0.8.0
 * @author Chen, Yi-Cyuan [emn178@gmail.com]
 * @copyright Chen, Yi-Cyuan 2015-2018
 * @license MIT
 */(function(a){(function(){var t="input is invalid type",n="finalize already called",o=typeof window=="object",e=o?window:{};e.JS_SHA3_NO_WINDOW&&(o=!1);var l=!o&&typeof self=="object",h=!e.JS_SHA3_NO_NODE_JS&&typeof process=="object"&&process.versions&&process.versions.node;h?e=As:l&&(e=self);var r=!e.JS_SHA3_NO_COMMON_JS&&!0&&a.exports,A=!e.JS_SHA3_NO_ARRAY_BUFFER&&typeof ArrayBuffer<"u",_="0123456789abcdef".split(""),s=[31,7936,2031616,520093696],w=[4,1024,262144,67108864],B=[1,256,65536,16777216],b=[6,1536,393216,100663296],k=[0,8,16,24],D=[1,0,32898,0,32906,2147483648,2147516416,2147483648,32907,0,2147483649,0,2147516545,2147483648,32777,2147483648,138,0,136,0,2147516425,0,2147483658,0,2147516555,0,139,2147483648,32905,2147483648,32771,2147483648,32770,2147483648,128,2147483648,32778,0,2147483658,2147483648,2147516545,2147483648,32896,2147483648,2147483649,0,2147516424,2147483648],F=[224,256,384,512],q=[128,256],x=["hex","buffer","arrayBuffer","array","digest"],it={128:168,256:136};(e.JS_SHA3_NO_NODE_JS||!Array.isArray)&&(Array.isArray=function(p){return Object.prototype.toString.call(p)==="[object Array]"}),A&&(e.JS_SHA3_NO_ARRAY_BUFFER_IS_VIEW||!ArrayBuffer.isView)&&(ArrayBuffer.isView=function(p){return typeof p=="object"&&p.buffer&&p.buffer.constructor===ArrayBuffer});for(var z=function(p,i,C){return function(c){return new Lt(p,i,p).update(c)[C]()}},lt=function(p,i,C){return function(c,m){return new Lt(p,i,m).update(c)[C]()}},E=function(p,i,C){return function(c,m,y,f){return v["cshake"+p].update(c,m,y,f)[C]()}},u=function(p,i,C){return function(c,m,y,f){return v["kmac"+p].update(c,m,y,f)[C]()}},L=function(p,i,C,c){for(var m=0;m<x.length;++m){var y=x[m];p[y]=i(C,c,y)}return p},V=function(p,i){var C=z(p,i,"hex");return C.create=function(){return new Lt(p,i,p)},C.update=function(c){return C.create().update(c)},L(C,z,p,i)},j=function(p,i){var C=lt(p,i,"hex");return C.create=function(c){return new Lt(p,i,c)},C.update=function(c,m){return C.create(m).update(c)},L(C,lt,p,i)},X=function(p,i){var C=it[p],c=E(p,i,"hex");return c.create=function(m,y,f){return!y&&!f?v["shake"+p].create(m):new Lt(p,i,m).bytepad([y,f],C)},c.update=function(m,y,f,S){return c.create(y,f,S).update(m)},L(c,E,p,i)},P=function(p,i){var C=it[p],c=u(p,i,"hex");return c.create=function(m,y,f){return new wt(p,i,y).bytepad(["KMAC",f],C).bytepad([m],C)},c.update=function(m,y,f,S){return c.create(m,f,S).update(y)},L(c,u,p,i)},I=[{name:"keccak",padding:B,bits:F,createMethod:V},{name:"sha3",padding:b,bits:F,createMethod:V},{name:"shake",padding:s,bits:q,createMethod:j},{name:"cshake",padding:w,bits:q,createMethod:X},{name:"kmac",padding:w,bits:q,createMethod:P}],v={},T=[],ot=0;ot<I.length;++ot)for(var tt=I[ot],K=tt.bits,at=0;at<K.length;++at){var W=tt.name+"_"+K[at];if(T.push(W),v[W]=tt.createMethod(K[at],tt.padding),tt.name!=="sha3"){var ct=tt.name+K[at];T.push(ct),v[ct]=v[W]}}function Lt(p,i,C){this.blocks=[],this.s=[],this.padding=i,this.outputBits=C,this.reset=!0,this.finalized=!1,this.block=0,this.start=0,this.blockCount=1600-(p<<1)>>5,this.byteCount=this.blockCount<<2,this.outputBlocks=C>>5,this.extraBytes=(C&31)>>3;for(var c=0;c<50;++c)this.s[c]=0}Lt.prototype.update=function(p){if(this.finalized)throw new Error(n);var i,C=typeof p;if(C!=="string"){if(C==="object"){if(p===null)throw new Error(t);if(A&&p.constructor===ArrayBuffer)p=new Uint8Array(p);else if(!Array.isArray(p)&&(!A||!ArrayBuffer.isView(p)))throw new Error(t)}else throw new Error(t);i=!0}for(var c=this.blocks,m=this.byteCount,y=p.length,f=this.blockCount,S=0,J=this.s,R,et;S<y;){if(this.reset)for(this.reset=!1,c[0]=this.block,R=1;R<f+1;++R)c[R]=0;if(i)for(R=this.start;S<y&&R<m;++S)c[R>>2]|=p[S]<<k[R++&3];else for(R=this.start;S<y&&R<m;++S)et=p.charCodeAt(S),et<128?c[R>>2]|=et<<k[R++&3]:et<2048?(c[R>>2]|=(192|et>>6)<<k[R++&3],c[R>>2]|=(128|et&63)<<k[R++&3]):et<55296||et>=57344?(c[R>>2]|=(224|et>>12)<<k[R++&3],c[R>>2]|=(128|et>>6&63)<<k[R++&3],c[R>>2]|=(128|et&63)<<k[R++&3]):(et=65536+((et&1023)<<10|p.charCodeAt(++S)&1023),c[R>>2]|=(240|et>>18)<<k[R++&3],c[R>>2]|=(128|et>>12&63)<<k[R++&3],c[R>>2]|=(128|et>>6&63)<<k[R++&3],c[R>>2]|=(128|et&63)<<k[R++&3]);if(this.lastByteIndex=R,R>=m){for(this.start=R-m,this.block=c[f],R=0;R<f;++R)J[R]^=c[R];ht(J),this.reset=!0}else this.start=R}return this},Lt.prototype.encode=function(p,i){var C=p&255,c=1,m=[C];for(p=p>>8,C=p&255;C>0;)m.unshift(C),p=p>>8,C=p&255,++c;return i?m.push(c):m.unshift(c),this.update(m),m.length},Lt.prototype.encodeString=function(p){var i,C=typeof p;if(C!=="string"){if(C==="object"){if(p===null)throw new Error(t);if(A&&p.constructor===ArrayBuffer)p=new Uint8Array(p);else if(!Array.isArray(p)&&(!A||!ArrayBuffer.isView(p)))throw new Error(t)}else throw new Error(t);i=!0}var c=0,m=p.length;if(i)c=m;else for(var y=0;y<p.length;++y){var f=p.charCodeAt(y);f<128?c+=1:f<2048?c+=2:f<55296||f>=57344?c+=3:(f=65536+((f&1023)<<10|p.charCodeAt(++y)&1023),c+=4)}return c+=this.encode(c*8),this.update(p),c},Lt.prototype.bytepad=function(p,i){for(var C=this.encode(i),c=0;c<p.length;++c)C+=this.encodeString(p[c]);var m=i-C%i,y=[];return y.length=m,this.update(y),this},Lt.prototype.finalize=function(){if(!this.finalized){this.finalized=!0;var p=this.blocks,i=this.lastByteIndex,C=this.blockCount,c=this.s;if(p[i>>2]|=this.padding[i&3],this.lastByteIndex===this.byteCount)for(p[0]=p[C],i=1;i<C+1;++i)p[i]=0;for(p[C-1]|=2147483648,i=0;i<C;++i)c[i]^=p[i];ht(c)}},Lt.prototype.toString=Lt.prototype.hex=function(){this.finalize();for(var p=this.blockCount,i=this.s,C=this.outputBlocks,c=this.extraBytes,m=0,y=0,f="",S;y<C;){for(m=0;m<p&&y<C;++m,++y)S=i[m],f+=_[S>>4&15]+_[S&15]+_[S>>12&15]+_[S>>8&15]+_[S>>20&15]+_[S>>16&15]+_[S>>28&15]+_[S>>24&15];y%p===0&&(ht(i),m=0)}return c&&(S=i[m],f+=_[S>>4&15]+_[S&15],c>1&&(f+=_[S>>12&15]+_[S>>8&15]),c>2&&(f+=_[S>>20&15]+_[S>>16&15])),f},Lt.prototype.arrayBuffer=function(){this.finalize();var p=this.blockCount,i=this.s,C=this.outputBlocks,c=this.extraBytes,m=0,y=0,f=this.outputBits>>3,S;c?S=new ArrayBuffer(C+1<<2):S=new ArrayBuffer(f);for(var J=new Uint32Array(S);y<C;){for(m=0;m<p&&y<C;++m,++y)J[y]=i[m];y%p===0&&ht(i)}return c&&(J[m]=i[m],S=S.slice(0,f)),S},Lt.prototype.buffer=Lt.prototype.arrayBuffer,Lt.prototype.digest=Lt.prototype.array=function(){this.finalize();for(var p=this.blockCount,i=this.s,C=this.outputBlocks,c=this.extraBytes,m=0,y=0,f=[],S,J;y<C;){for(m=0;m<p&&y<C;++m,++y)S=y<<2,J=i[m],f[S]=J&255,f[S+1]=J>>8&255,f[S+2]=J>>16&255,f[S+3]=J>>24&255;y%p===0&&ht(i)}return c&&(S=y<<2,J=i[m],f[S]=J&255,c>1&&(f[S+1]=J>>8&255),c>2&&(f[S+2]=J>>16&255)),f};function wt(p,i,C){Lt.call(this,p,i,C)}wt.prototype=new Lt,wt.prototype.finalize=function(){return this.encode(this.outputBits,!0),Lt.prototype.finalize.call(this)};var ht=function(p){var i,C,c,m,y,f,S,J,R,et,It,dt,pt,xt,gt,rt,bt,vt,Mt,Kt,zt,Ht,qt,kt,Gt,an,Yt,N,d,g,Q,U,O,G,M,$,Y,Z,H,nt,ut,_t,st,At,Ct,St,yt,mt,ft,Ot,Rt,Wt,Qn,Ln,An,Mn,bn,In,qn,dn,cn,Bn,co;for(c=0;c<48;c+=2)m=p[0]^p[10]^p[20]^p[30]^p[40],y=p[1]^p[11]^p[21]^p[31]^p[41],f=p[2]^p[12]^p[22]^p[32]^p[42],S=p[3]^p[13]^p[23]^p[33]^p[43],J=p[4]^p[14]^p[24]^p[34]^p[44],R=p[5]^p[15]^p[25]^p[35]^p[45],et=p[6]^p[16]^p[26]^p[36]^p[46],It=p[7]^p[17]^p[27]^p[37]^p[47],dt=p[8]^p[18]^p[28]^p[38]^p[48],pt=p[9]^p[19]^p[29]^p[39]^p[49],i=dt^(f<<1|S>>>31),C=pt^(S<<1|f>>>31),p[0]^=i,p[1]^=C,p[10]^=i,p[11]^=C,p[20]^=i,p[21]^=C,p[30]^=i,p[31]^=C,p[40]^=i,p[41]^=C,i=m^(J<<1|R>>>31),C=y^(R<<1|J>>>31),p[2]^=i,p[3]^=C,p[12]^=i,p[13]^=C,p[22]^=i,p[23]^=C,p[32]^=i,p[33]^=C,p[42]^=i,p[43]^=C,i=f^(et<<1|It>>>31),C=S^(It<<1|et>>>31),p[4]^=i,p[5]^=C,p[14]^=i,p[15]^=C,p[24]^=i,p[25]^=C,p[34]^=i,p[35]^=C,p[44]^=i,p[45]^=C,i=J^(dt<<1|pt>>>31),C=R^(pt<<1|dt>>>31),p[6]^=i,p[7]^=C,p[16]^=i,p[17]^=C,p[26]^=i,p[27]^=C,p[36]^=i,p[37]^=C,p[46]^=i,p[47]^=C,i=et^(m<<1|y>>>31),C=It^(y<<1|m>>>31),p[8]^=i,p[9]^=C,p[18]^=i,p[19]^=C,p[28]^=i,p[29]^=C,p[38]^=i,p[39]^=C,p[48]^=i,p[49]^=C,xt=p[0],gt=p[1],St=p[11]<<4|p[10]>>>28,yt=p[10]<<4|p[11]>>>28,N=p[20]<<3|p[21]>>>29,d=p[21]<<3|p[20]>>>29,dn=p[31]<<9|p[30]>>>23,cn=p[30]<<9|p[31]>>>23,_t=p[40]<<18|p[41]>>>14,st=p[41]<<18|p[40]>>>14,G=p[2]<<1|p[3]>>>31,M=p[3]<<1|p[2]>>>31,rt=p[13]<<12|p[12]>>>20,bt=p[12]<<12|p[13]>>>20,mt=p[22]<<10|p[23]>>>22,ft=p[23]<<10|p[22]>>>22,g=p[33]<<13|p[32]>>>19,Q=p[32]<<13|p[33]>>>19,Bn=p[42]<<2|p[43]>>>30,co=p[43]<<2|p[42]>>>30,Ln=p[5]<<30|p[4]>>>2,An=p[4]<<30|p[5]>>>2,$=p[14]<<6|p[15]>>>26,Y=p[15]<<6|p[14]>>>26,vt=p[25]<<11|p[24]>>>21,Mt=p[24]<<11|p[25]>>>21,Ot=p[34]<<15|p[35]>>>17,Rt=p[35]<<15|p[34]>>>17,U=p[45]<<29|p[44]>>>3,O=p[44]<<29|p[45]>>>3,kt=p[6]<<28|p[7]>>>4,Gt=p[7]<<28|p[6]>>>4,Mn=p[17]<<23|p[16]>>>9,bn=p[16]<<23|p[17]>>>9,Z=p[26]<<25|p[27]>>>7,H=p[27]<<25|p[26]>>>7,Kt=p[36]<<21|p[37]>>>11,zt=p[37]<<21|p[36]>>>11,Wt=p[47]<<24|p[46]>>>8,Qn=p[46]<<24|p[47]>>>8,At=p[8]<<27|p[9]>>>5,Ct=p[9]<<27|p[8]>>>5,an=p[18]<<20|p[19]>>>12,Yt=p[19]<<20|p[18]>>>12,In=p[29]<<7|p[28]>>>25,qn=p[28]<<7|p[29]>>>25,nt=p[38]<<8|p[39]>>>24,ut=p[39]<<8|p[38]>>>24,Ht=p[48]<<14|p[49]>>>18,qt=p[49]<<14|p[48]>>>18,p[0]=xt^~rt&vt,p[1]=gt^~bt&Mt,p[10]=kt^~an&N,p[11]=Gt^~Yt&d,p[20]=G^~$&Z,p[21]=M^~Y&H,p[30]=At^~St&mt,p[31]=Ct^~yt&ft,p[40]=Ln^~Mn&In,p[41]=An^~bn&qn,p[2]=rt^~vt&Kt,p[3]=bt^~Mt&zt,p[12]=an^~N&g,p[13]=Yt^~d&Q,p[22]=$^~Z&nt,p[23]=Y^~H&ut,p[32]=St^~mt&Ot,p[33]=yt^~ft&Rt,p[42]=Mn^~In&dn,p[43]=bn^~qn&cn,p[4]=vt^~Kt&Ht,p[5]=Mt^~zt&qt,p[14]=N^~g&U,p[15]=d^~Q&O,p[24]=Z^~nt&_t,p[25]=H^~ut&st,p[34]=mt^~Ot&Wt,p[35]=ft^~Rt&Qn,p[44]=In^~dn&Bn,p[45]=qn^~cn&co,p[6]=Kt^~Ht&xt,p[7]=zt^~qt&gt,p[16]=g^~U&kt,p[17]=Q^~O&Gt,p[26]=nt^~_t&G,p[27]=ut^~st&M,p[36]=Ot^~Wt&At,p[37]=Rt^~Qn&Ct,p[46]=dn^~Bn&Ln,p[47]=cn^~co&An,p[8]=Ht^~xt&rt,p[9]=qt^~gt&bt,p[18]=U^~kt&an,p[19]=O^~Gt&Yt,p[28]=_t^~G&$,p[29]=st^~M&Y,p[38]=Wt^~At&St,p[39]=Qn^~Ct&yt,p[48]=Bn^~Ln&Mn,p[49]=co^~An&bn,p[0]^=D[c],p[1]^=D[c+1]};if(r)a.exports=v;else for(ot=0;ot<T.length;++ot)e[T[ot]]=v[T[ot]]})()})(_a);var sl=_a.exports;const{keccak256:Sl}=sl,{stringifyBigInts:vl}=Nt,{unstringifyBigInts:Ol}=Nt,{unstringifyBigInts:Pl}=Nt,{unstringifyBigInts:Ql}=Nt,{stringifyBigInts:Ml}=Nt,{unstringifyBigInts:ql}=Nt,{unstringifyBigInts:Ul}=Nt,{unstringifyBigInts:zl}=Nt;function zo(a,t=256){const n=a.startsWith("0x")?a.slice(2):a,o=Math.ceil(t/4),e=n.padStart(o,"0");let l="";for(let h=0;h<e.length;h++){const r=e[h],A=parseInt(r,16);if(isNaN(A))throw new Error(`Invalid hex character: ${r}`);l+=A.toString(2).padStart(4,"0")}return l.length>t?l=l.slice(-t):l.length<t&&(l=l.padStart(t,"0")),Array.from(l).map(h=>parseInt(h,10))}async function ll(a,t,n,o){const e="/circuits/auth_js/auth.wasm",l="/keys/circuit_final.zkey";try{if(console.log("Preparing ZKP inputs..."),!Array.isArray(n)||n.length===0)throw new Error(`Invalid pathElements: ${JSON.stringify(n)}`);if(!Array.isArray(o)||o.length===0)throw new Error(`Invalid pathIndices: ${JSON.stringify(o)}`);if(n.length!==o.length)throw new Error(`Path elements (${n.length}) and indices (${o.length}) must have same length`);const h=zo(a,256),r=zo(t,256),A=n.map(B=>zo(B,256)),_={leaf:h,root:r,path:A,direction:o};console.log("Generating ZKP proof with formatted inputs...");const{proof:s,publicSignals:w}=await cl.fullProve(_,e,l);return console.log("ZKP proof generated successfully"),{proof:s,publicSignals:w}}catch(h){throw console.error("Error generating ZKP proof:",h),new Error(`ZKP proof generation failed: ${h.message}`)}}async function rl(a={},t=null){const n=new URL("https://79a9-2404-c0-2120-00-1343-4b8.ap.ngrok.io/api/posts");Object.entries(a).forEach(([l,h])=>{Array.isArray(h)?n.searchParams.append(l,h.join(",")):n.searchParams.append(l,h)});const o={method:"GET",headers:{}};t&&t.proof&&(o.headers["X-ZKP-Proof"]=JSON.stringify(t.proof),o.headers["X-ZKP-PublicSignals"]=JSON.stringify(t.publicSignals));const e=await fetch(n.toString(),o);if(!e.ok)throw new Error(`API error: ${e.status} ${e.statusText}`);return e.json()}const To=document.getElementById("feed");document.getElementById("loader");let rn=0,on=[];const dl=10;let en=[],mn=null,kn=null;const go=document.createElement("div"),uo=document.createElement("div");let Yn={topics:[],hashtags:[]},ko=null;const _l=1e4;let ro=null;const gl=250;function ei(){ul(),fl(),bo(rn)}function ul(){go.id="interactions-history",go.style="position:fixed;right:0;top:0;width:340px;height:100vh;overflow:auto;background:#fff;border-left:1px solid #ccc;padding:10px;font-size:0.95em;z-index:1;box-shadow:-2px 0 8px #0001;",document.body.appendChild(go),uo.id="model-status",uo.style="position:fixed;left:0;top:0;width:340px;max-width:100vw;height:100vh;overflow:auto;background:#fff;border-right:1px solid #ccc;padding:10px;font-size:0.95em;z-index:1;box-shadow:2px 0 8px #0001;",document.body.appendChild(uo)}function fl(){window.addEventListener("keydown",bl),window.addEventListener("wheel",()=>{},{passive:!0}),document.addEventListener("visibilitychange",Il)}function hl(a){const t=new Set(Vt),n=new Set(zn);for(const o of a)(o.topics||[]).forEach(e=>t.add(e)),(o.hashtags||[]).forEach(e=>n.add(e));Vt.splice(0,Vt.length,...Array.from(t)),zn.splice(0,zn.length,...Array.from(n))}async function Wn(a,t){if(!t||!t.id)return;let n=en.find(e=>e.postId===t.id);n||(n={postId:t.id,topics:t.topics||[],hashtags:t.hashtags||[],liked:!1,interested:!1,not_interested:!1,commented:!1,timeSpentMs:0,timestamp:Date.now()},en.push(n),en.length>100&&(en=en.slice(-100)));const o={liked:n.liked,interested:n.interested,not_interested:n.not_interested};a==="interested"?(n.interested=!0,n.not_interested=!1):a==="not_interested"?(n.not_interested=!0,n.interested=!1):a==="like"?n.liked=!n.liked:a==="comment"&&(n.commented=!0),console.log(`Interaction updated for post ${t.id}:`,{type:a,prevState:o,newState:{liked:n.liked,interested:n.interested,not_interested:n.not_interested}}),kn===t.id&&mn&&(mo(),mn=Date.now()),n.timestamp=Date.now(),pl(),ha()}function mo(){var a,t;if(!(!kn||!mn))try{const n=Date.now(),o=n-mn;if(o>0&&o<3e5){let e=en.find(l=>l.postId===kn);e||(e={postId:kn,topics:((a=on[rn])==null?void 0:a.topics)||[],hashtags:((t=on[rn])==null?void 0:t.hashtags)||[],liked:!1,interested:!1,not_interested:!1,commented:!1,timeSpentMs:0,timestamp:n},en.push(e)),e.timeSpentMs+=o}}catch(n){console.warn("Error recording time spent:",n)}}function pl(){ko&&clearTimeout(ko),ko=setTimeout(async()=>{console.log("Idle timeout reached, training model..."),On||await te(en)},_l)}let Do=!1;async function ga(){if(!Do)try{Do=!0,mo(),On||(console.log("Training model with interactions..."),await te(en)),Yn=await di(en);const a={};Yn.topics.length&&(a.topics=Yn.topics.map(t=>t.name||t)),Yn.hashtags.length&&(a.hashtags=Yn.hashtags.map(t=>t.name||t)),a.limit=dl;try{const t=await ll("ab2f20d2e957149afeda6cfa09efedcf0986809fcd6bfd4cd83fca58033f311f","4b197fc392cd047e0a1b4467778294600329e08f7bcd41d13cdf46779a2c494f",["e3c58b672d729be3cf3f6dca66bc9bedf0bedcae1fdb356d6c3760f5e65d4fb5","ca0637690eb8669c2e89d6655ae5825a4f6b2c645be5f582f8e57166674519c3","0b68be77c15ed75d63846072b00497c8d5351f884590e9a98bc65220ed53823b"],[1,1,1]);console.log("ZKP proof generated successfully:",t),on=(await rl(a,t)).posts||[],rn=0,hl(on),console.log("Loaded batch:",on)}catch(t){console.error("Error fetching posts:",t),on=[],rn=0}}catch(a){console.error("Error in loadBatch:",a)}finally{Do=!1}}function Ll(a){if(!a)return document.createElement("div");const t=document.createElement("div");t.className="post";const n=document.createElement("div");n.className="content",n.innerHTML=`
    <strong>${a.title||""}</strong>
    <p>${a.body||""}</p>
    <div><b>Topics:</b> ${a.topics&&a.topics.length?a.topics.join(", "):"None"}</div>
    <div><b>Hashtags:</b> ${a.hashtags&&a.hashtags.length?a.hashtags.join(", "):"None"}</div>
    <div style="color:#888;font-size:0.9em;margin-top:8px;">${a.id||""}</div>
  `,t.appendChild(n);const o=Al(a);return t.appendChild(o),t}function Al(a){if(!a||!a.id)return document.createElement("div");const t=document.createElement("div");t.className="interaction-btns";const n=en.find(l=>l.postId===a.id)||{},o=n.liked?"background:#cfc;":"",e=n.commented?"disabled":"";return t.innerHTML=`
    <button id="like-btn-${a.id}" style="${o}">👍 Like</button>
    <button id="interested-btn-${a.id}">Interested</button>
    <button id="not-interested-btn-${a.id}">Not Interested</button>
    <button id="comment-btn-${a.id}" ${e}>💬 Comment</button>
  `,t.querySelector(`#like-btn-${a.id}`).addEventListener("click",()=>{Wn("like",a),t.querySelector(`#like-btn-${a.id}`).style.background=n.liked?"":"#cfc"}),t.querySelector(`#interested-btn-${a.id}`).addEventListener("click",()=>{Wn("interested",a)}),t.querySelector(`#not-interested-btn-${a.id}`).addEventListener("click",()=>{Wn("not_interested",a)}),t.querySelector(`#comment-btn-${a.id}`).addEventListener("click",()=>{n.commented||(Wn("comment",a),t.querySelector(`#comment-btn-${a.id}`).disabled=!0)}),t}async function bo(a){try{if(mo(),(on.length===0||a<0||a>=on.length-2)&&(await ga(),a=0),To.innerHTML="",on.length>0)To.appendChild(Ll(on[a])),mn=Date.now(),kn=on[a].id;else{const t=document.createElement("div");t.textContent="No posts available.",To.appendChild(t),mn=null,kn=null}rn=a,ha()}catch(t){console.error("Error showing post:",t)}}function ua(){rn<on.length-1?bo(rn+1):ga().then(()=>bo(0))}function fa(){rn>0&&bo(rn-1)}function bl(a){a.key==="ArrowDown"||a.key===" "?(ua(),a.preventDefault()):a.key==="ArrowUp"&&(fa(),a.preventDefault())}function Il(){document.hidden?(mo(),mn=null):mn=Date.now()}function yl(){try{const a=en.slice().sort((n,o)=>o.timestamp-n.timestamp);let t="<b>User Interactions</b><br>";t+='<ul style="margin:0 0 10px 0;padding-left:18px;overflow:auto;">';for(const n of a){let o=[];n.liked&&o.push("👍"),n.interested&&o.push("Interested"),n.not_interested&&o.push("Not Interested"),n.commented&&o.push("💬"),n.engagement&&o.push("Engaged");let e=`<div style='color:#0a7;font-size:0.95em;margin:2px 0 2px 0;'>
        <b>Time spent:</b> ${Math.round((n.timeSpentMs||0)/1e3)}s
      </div>`;t+=`<li>
        <b>${o.join(", ")||"None"}</b> 
        <span style='color:#888'>[${n.postId}]</span>${e}
        <br>
        <span style='color:#555'>${(n.topics||[]).join(", ")}</span>
        <span style='color:#888'>${(n.hashtags||[]).join(", ")}</span>
      </li>`}t+="</ul>",go.innerHTML=t}catch(a){console.warn("Error rendering interaction history:",a)}}async function Cl(){try{let t=`<b>Model Status:</b> ${On?'<span style="color:orange">Training</span>':vn?'<span style="color:green">Trained</span>':'<span style="color:red">Untrained</span>'}<br>`;const n=Xt.at(-1)||[],o=ln.at(-1)||[];t+=`<b>Next API Topics</b><br>
      <div style='word-break:break-all;color:#14a'>
        [${n.map(e=>{var l;return`{ name: '${e.name}', weight: ${((l=e.weight)==null?void 0:l.toFixed(3))??"?"} }`}).join(", ")}]
      </div>
      <b>Next API Hashtags</b><br>
      <div style='word-break:break-all;color:#14a'>
        [${o.map(e=>{var l;return`{ name: '${e.name}', weight: ${((l=e.weight)==null?void 0:l.toFixed(3))??"?"} }`}).join(", ")}]
      </div>`,uo.innerHTML=t}catch(a){console.warn("Error rendering model status:",a)}}function ha(){ro&&clearTimeout(ro),ro=setTimeout(async()=>{yl(),await Cl(),ro=null},gl)}typeof window<"u"&&typeof document<"u"&&(document.readyState==="loading"?document.addEventListener("DOMContentLoaded",ei):ei());typeof fo<"u"&&fo.exports&&(fo.exports={recordInteraction:Wn,analyzeInteractions:di,trainModel:te,nextPost:ua,prevPost:fa})});export default ml();
